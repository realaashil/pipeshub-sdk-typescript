openapi: 3.0.0
info:
  title: PipesHub API
  description: |
    Unified API documentation for PipesHub services.

    PipesHub is an enterprise-grade platform providing:
    - User authentication and management
    - Document storage and version control
    - Knowledge base management
    - Enterprise search and conversational AI
    - Third-party integrations via connectors
    - System configuration management
    - Crawling job scheduling
    - Email services

    ## Authentication
    Most endpoints require JWT Bearer token authentication. Some internal endpoints use scoped tokens for service-to-service communication.

    ## Base URLs
    All endpoints use the `/api/v1` prefix unless otherwise noted.
  version: 1.0.0
  contact:
    name: API Support
    email: support@pipeshub.com
servers:
  - url: /api/v1
    description: Base API URL
tags:
  # Authentication
  - name: User Account
    description: User authentication including multi-step MFA, password reset, OTP login, and token management
  - name: Organization Auth Config
    description: Admin configuration of authentication methods including MFA steps and allowed providers
  - name: SAML
    description: SAML 2.0 Single Sign-On integration with enterprise Identity Providers
  - name: OAuth
    description: OAuth 2.0 token exchange for third-party authentication providers
  - name: OAuth Provider
    description: |
      PipesHub OAuth 2.0 Authorization Server implementing RFC 6749, RFC 7636 (PKCE), and OpenID Connect.

      **Supported Grant Types:**
      - `authorization_code` - Standard OAuth flow with PKCE support
      - `client_credentials` - Machine-to-machine authentication
      - `refresh_token` - Token refresh for long-lived access

      **Security Features:**
      - PKCE (Proof Key for Code Exchange) for public clients
      - State parameter for CSRF protection
      - Configurable token lifetimes
      - Token revocation and introspection

      **OpenID Connect:**
      - ID tokens with standard claims
      - UserInfo endpoint for profile data
      - Discovery endpoint for automatic configuration
  - name: OAuth Apps
    description: |
      Manage OAuth 2.0 client applications registered with PipesHub.

      OAuth apps allow third-party applications to access PipesHub APIs on behalf of users
      or organizations. Each app receives a client ID and secret for authentication.

      **App Types:**
      - **Confidential clients**: Server-side apps that can securely store secrets
      - **Public clients**: Browser/mobile apps that cannot securely store secrets (use PKCE)

      **App Lifecycle:**
      - Create apps with name, redirect URIs, and allowed scopes
      - Regenerate secrets if compromised
      - Suspend/activate apps to control access
      - Revoke all tokens for emergency access removal
  - name: OpenID Connect
    description: |
      OpenID Connect 1.0 endpoints for identity federation and discovery.

      **Discovery:**
      - `/.well-known/openid-configuration` - Authorization server metadata
      - `/.well-known/jwks.json` - Public keys for token verification

      **UserInfo:**
      - `/oauth/userinfo` - Get authenticated user's profile information

      **Supported Claims:**
      - `sub` - User identifier
      - `email`, `email_verified` - Email information
      - `name`, `given_name`, `family_name` - Name information
  # User Management
  - name: Users
    description: User management operations
  - name: Teams
    description: Team management operations
  - name: Organizations
    description: Organization management operations
  - name: User Groups
    description: User group management operations
  # Storage
  - name: Document Upload
    description: Document upload operations
  - name: Document Management
    description: Document CRUD and retrieval operations
  - name: Document Buffer
    description: Document buffer read/write operations
  - name: Version Control
    description: Document versioning and rollback operations
  - name: Storage Internal
    description: Internal service-to-service storage endpoints
  # Knowledge Base
  - name: Knowledge Bases
    description: Knowledge base management operations
  - name: Folders
    description: Folder organization and management
  - name: Records
    description: Record management and operations
  - name: Permissions
    description: Permission management for knowledge bases
  - name: Upload
    description: File upload operations
  - name: Connector
    description: Connector-related operations
  # Enterprise Search
  - name: Conversations
    description: AI-powered conversational chat management with citations and follow-up questions
  - name: Semantic Search
    description: Enterprise semantic search across all indexed knowledge with relevance scoring
  - name: Agents
    description: Custom AI agents with specialized capabilities and tool integrations
  - name: Agent Templates
    description: Reusable templates for creating AI agents with predefined configurations
  - name: Agent Conversations
    description: Conversations with custom AI agents including streaming and feedback
  # Connector Manager
  - name: Connector Registry
    description: Browse available connector types and their configuration schemas
  - name: Connector Instances
    description: Create, manage, and delete connector instances for your organization
  - name: Connector Configuration
    description: Configure authentication, sync settings, and filters for connectors
  - name: Connector Control
    description: Enable/disable connectors for sync or agent functionality
  - name: Connector OAuth
    description: OAuth 2.0 authorization flow for connectors requiring user consent
  - name: Connector Filters
    description: Dynamic filter options for selecting which data to sync
  - name: OAuth Configuration
    description: Admin management of OAuth credentials for connector types
  - name: Connector Records
    description: Record management operations (list, get, delete, reindex)
  - name: Connector Statistics
    description: Connector statistics and monitoring
  - name: Connector Streaming
    description: File streaming and download operations
  - name: Connector Utilities
    description: Utility operations (file conversion, etc.)
  - name: Webhooks
    description: Webhook handlers for real-time updates
  # Configuration Manager
  - name: Storage Configuration
    description: Configure storage backend for file uploads and documents. Supports AWS S3, Azure Blob Storage, or local filesystem.
  - name: SMTP Configuration
    description: Configure SMTP email server for sending notifications and invitations.
  - name: Authentication Configuration
    description: Configure authentication providers including Azure AD, Microsoft, Google OAuth, SAML SSO, and custom OAuth 2.0.
  - name: Platform Settings
    description: Platform-wide settings including file upload limits, feature flags, and custom system prompts.
  - name: AI Models Configuration
    description: Configure AI model providers for LLM, embedding, OCR, SLM, reasoning, and multimodal capabilities.
  - name: AI Models Providers
    description: Manage individual AI model providers - add, update, delete, and set defaults.
  - name: Connector OAuth Configuration
    description: Configure OAuth credentials for data source connectors (Google Workspace, Atlassian, OneDrive, SharePoint).
  - name: Public URLs
    description: Configure public URLs for frontend application and connector callbacks.
  - name: Metrics Collection
    description: |
      Configure telemetry and metrics collection for application monitoring and analytics.

      PipesHub collects anonymized usage metrics to help improve the product. Metrics are pushed
      to a configurable remote server at regular intervals.

      **Collected Metrics:**
      - API request counts and response times
      - User activity patterns (anonymized)
      - Feature usage statistics
      - Error rates and types

      **Configuration Options:**
      - Enable/disable metrics collection entirely
      - Configure push interval (minimum 1 second, default 60 seconds)
      - Set custom metrics server URL for self-hosted analytics

      **Privacy:**
      - All metrics are anonymized before collection
      - No personally identifiable information (PII) is collected
      - Organization can disable collection at any time
  - name: Configuration Internal
    description: Service-to-service internal configuration endpoints
  # Crawling Manager
  - name: Crawling Jobs
    description: |
      Endpoints for scheduling, managing, and monitoring data crawling jobs for enterprise connectors.

      The Crawling Manager uses BullMQ (Redis-based queue) to schedule and execute crawling jobs that
      sync data from external connectors (Google Drive, OneDrive, Slack, Jira, etc.) into PipesHub's
      search index.

      **Key Features:**
      - Schedule recurring crawls (hourly, daily, weekly, monthly) or one-time crawls
      - Pause and resume crawling jobs without losing configuration
      - Priority-based job execution (1-10 scale)
      - Automatic retry with exponential backoff on failures
      - Per-connector job isolation and tracking

      **Access Control:**
      - Team-scoped connectors require admin privileges
      - Personal-scoped connectors can only be managed by the creator
      - All operations require valid JWT authentication

      **Schedule Types:**
      - `hourly`: Run every X hours at specified minute
      - `daily`: Run once per day at specified time
      - `weekly`: Run on specified days of the week
      - `monthly`: Run on specified day of the month
      - `custom`: Use cron expression for complex schedules
      - `once`: Run once at a specific future time
  - name: Queue Management
    description: |
      Endpoints for monitoring the crawling job queue and system health.

      Provides real-time statistics about the BullMQ queue including job counts by state,
      paused jobs, and repeatable job configurations. Useful for monitoring system health
      and debugging crawling issues.
  # Mail Service
  - name: Email Operations
    description: |
      Internal service endpoints for sending transactional emails using pre-defined templates.

      These endpoints are designed for service-to-service communication and require scoped tokens
      (not regular user authentication). They are used internally by other PipesHub services to send
      emails such as OTP codes, password resets, user invitations, and security alerts.

      **Prerequisites:**
      - SMTP must be configured via `/configurationManager/smtpConfig`
      - Valid scoped token with `mail:send` scope required

      **Available Templates:**
      - `loginWithOTP` - Send OTP for user authentication
      - `resetPassword` - Password reset link
      - `accountCreation` - Welcome email for new organizations
      - `appuserInvite` - User invitation to join organization
      - `suspiciousLoginAttempt` - Security alert for suspicious activity
  - name: Mail Configuration
    description: |
      Internal endpoints for managing mail service configuration at runtime.

      These endpoints allow dynamic reloading of SMTP configuration without service restart.
      Requires scoped token with `fetch:config` scope.
  # ==================== INTERNAL PIPESHUB MICROSERVICES ====================
  # IMPORTANT: These are INTERNAL services used for service-to-service communication
  # within PipesHub. They are NOT meant for direct external access.
  #
  # Authentication: All internal endpoints require a SCOPED SERVICE TOKEN
  # obtained through the PipesHub token service.
  - name: Query Service
    description: |
      ## Query Service (Internal)

      **⚠️ INTERNAL SERVICE - NOT for direct external API access**

      **Port:** 8000 | **Base URL:** `http://localhost:8000`

      Handles AI-powered search and retrieval:
      - Semantic/vector search across indexed documents
      - RAG (Retrieval-Augmented Generation) for conversational AI
      - LLM integration via LiteLLM for multiple providers
      - AI Agent execution

      **Authentication:** Requires scoped service token (except health checks)

      **Key Endpoints:**
      - `GET /health` - Health check (no auth)
      - `POST /api/v1/search` - Semantic search
      - `POST /api/v1/chat` - Chat with knowledge base
      - `POST /api/v1/chat/stream` - Streaming chat
      - `POST /api/v1/agent-chat` - Agent-based chat
      - `POST /api/v1/llm-health-check` - LLM model validation
      - `POST /api/v1/embedding-health-check` - Embedding model validation
      - `POST /api/v1/health-check/{model_type}` - Generic model health check
  - name: Indexing Service
    description: |
      ## Indexing Service (Internal)

      **⚠️ INTERNAL SERVICE - NOT for direct external API access**

      **Port:** 8091 | **Base URL:** `http://localhost:8091`

      Handles document processing and embedding generation:
      - Document parsing (PDF, DOCX, images, etc.)
      - Text chunking and embedding generation
      - Vector storage in Qdrant
      - Graph indexing in ArangoDB

      **Authentication:** Internal only (Kafka consumer)

      **Key Endpoints:**
      - `GET /health` - Health check (no auth)

      **Note:** This service primarily consumes Kafka messages for indexing tasks.
      It listens to the `record-events` topic for new, update, delete, and reindex events.
  - name: Connector Service
    description: |
      ## Connector Service (Internal)

      **⚠️ INTERNAL SERVICE - NOT for direct external API access**

      **Port:** 8088 | **Base URL:** `http://localhost:8088`

      Manages all data source integrations and OAuth flows:
      - OAuth token management and refresh
      - Data sync from 30+ enterprise connectors
      - Webhook handlers for real-time updates
      - File streaming and signed URLs

      **Authentication:** Requires scoped service token (except health checks and webhooks)

      **Key Endpoints:**
      - `GET /health` - Health check (no auth)
      - `GET /api/v1/connectors/` - List all connectors
      - `GET /api/v1/records` - List records
      - `GET /api/v1/stats` - Get connector statistics
      - `POST /api/v1/records/reindex-failed` - Reindex failed records
      - `GET /api/v1/stream/record/{record_id}` - Stream file content
      - `GET /api/v1/internal/stream/record/{record_id}` - Internal streaming

      **Webhook Endpoints (no auth - verified by provider signatures):**
      - `POST /drive/webhook` - Google Drive push notifications
      - `POST /gmail/webhook` - Gmail Pub/Sub notifications
  - name: Docling Service
    description: |
      ## Docling Service (Internal)

      **⚠️ INTERNAL SERVICE - NOT for direct external API access**

      **Port:** 8081 | **Base URL:** `http://localhost:8081`

      Provides advanced document parsing capabilities:
      - PDF parsing with layout analysis
      - OCR for scanned documents
      - Table extraction
      - Image analysis

      **Authentication:** Internal only (called by Indexing Service)

      **Key Endpoints:**
      - `GET /health` - Health check (no auth)
      - `POST /process-pdf` - Full PDF processing
      - `POST /parse-pdf` - Parse PDF without block creation (Phase 1)
      - `POST /create-blocks` - Create blocks from parse result (Phase 2)
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT Bearer token for authenticated requests
    scopedToken:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: |
        Scoped JWT token for service-to-service authentication.
        Format: "Bearer {scoped_token}"
        Required scopes vary by endpoint.
  schemas:
    # ==================== COMMON SCHEMAS ====================

    # ==================== AUTH SCHEMAS ====================
    AuthMethod:
      type: object
      description: Authentication method configuration
      properties:
        type:
          type: string
          enum: [samlSso, otp, password, google, microsoft, azureAd, oauth]
          description: |
            Type of authentication method:
            - `password`: Email/password authentication
            - `otp`: One-time password via email (6-digit, expires in 10 minutes)
            - `google`: Google OAuth 2.0
            - `microsoft`: Microsoft OAuth 2.0
            - `azureAd`: Azure Active Directory
            - `samlSso`: SAML 2.0 Single Sign-On
            - `oauth`: Generic OAuth 2.0 provider
      required:
        - type
    AuthStep:
      type: object
      description: A single step in multi-factor authentication flow
      properties:
        order:
          type: integer
          description: Order of the authentication step (1-3, must be unique across steps)
          minimum: 1
          maximum: 3
        allowedMethods:
          type: array
          items:
            $ref: '#/components/schemas/AuthMethod'
          description: List of allowed authentication methods for this step. User can choose any one method from this list.
          minItems: 1
      required:
        - order
        - allowedMethods
    AuthConfig:
      type: object
      description: |
        Organization authentication configuration. Supports 1-3 authentication steps for multi-factor authentication.
        **Validation Rules:**
        - Minimum 1 step, maximum 3 steps
        - Each step must have unique order
        - No duplicate methods within the same step
        - No method can appear in multiple steps
      properties:
        authMethods:
          type: array
          items:
            $ref: '#/components/schemas/AuthStep'
          description: List of authentication steps in order
          minItems: 1
          maxItems: 3
      required:
        - authMethods
    InitAuthRequest:
      type: object
      description: Request to initialize authentication session
      properties:
        email:
          type: string
          format: email
          description: User email address (RFC 5321 compliant)
          example: user@example.com
      required:
        - email
    InitAuthResponse:
      type: object
      description: Response containing available authentication methods and session info
      properties:
        currentStep:
          type: integer
          description: Current authentication step (0-indexed). Always 0 for initial response.
          example: 0
        allowedMethods:
          type: array
          items:
            type: string
            enum: [samlSso, otp, password, google, microsoft, azureAd, oauth]
          description: List of allowed authentication methods for the current step
          example: ["password", "google", "otp"]
        message:
          type: string
          description: Response message
          example: "Authentication initialized"
        authProviders:
          $ref: '#/components/schemas/AuthProviders'
    AuthProviders:
      type: object
      description: Configuration for external authentication providers (returned when those methods are allowed)
      properties:
        google:
          type: object
          properties:
            clientId:
              type: string
              description: Google OAuth client ID
        microsoft:
          type: object
          properties:
            tenantId:
              type: string
              description: Microsoft tenant ID
            clientId:
              type: string
              description: Microsoft OAuth client ID
        azuread:
          type: object
          properties:
            tenantId:
              type: string
              description: Azure AD tenant ID
            clientId:
              type: string
              description: Azure AD client ID
        oauth:
          type: object
          properties:
            providerName:
              type: string
              description: Custom OAuth provider name
            clientId:
              type: string
              description: OAuth client ID
            authorizationUrl:
              type: string
              description: OAuth authorization URL
    AuthenticateRequest:
      type: object
      description: |
        Request to authenticate using specified method.
        **Credential format varies by method:**
        - `password`: `{ password: "string" }`
        - `otp`: `{ otp: "123456" }` (6-digit code)
        - `google`: `"google-id-token-string"`
        - `microsoft`: `{ accessToken: "...", idToken: "..." }`
        - `azureAd`: `{ accessToken: "...", idToken: "..." }`
        - `oauth`: `{ accessToken: "...", idToken: "..." }`
        - `samlSso`: handled via redirect flow
      properties:
        method:
          type: string
          enum: [samlSso, otp, password, google, microsoft, azureAd, oauth]
          description: Authentication method to use
        credentials:
          oneOf:
            - $ref: '#/components/schemas/PasswordCredentials'
            - $ref: '#/components/schemas/OtpCredentials'
            - $ref: '#/components/schemas/OAuthCredentials'
            - type: string
              description: Google ID token (for google method)
          description: Credentials based on the authentication method
        email:
          type: string
          format: email
          description: Optional email for verification (used with some OAuth methods)
        cf-turnstile-response:
          type: string
          description: Cloudflare Turnstile CAPTCHA token (optional, if CAPTCHA is enabled)
      required:
        - method
        - credentials
    PasswordCredentials:
      type: object
      description: Credentials for password authentication
      properties:
        password:
          type: string
          description: User password
          format: password
      required:
        - password
    OtpCredentials:
      type: object
      description: Credentials for OTP authentication
      properties:
        otp:
          type: string
          description: 6-digit one-time password
          pattern: '^\d{6}$'
          example: "123456"
      required:
        - otp
    OAuthCredentials:
      type: object
      description: Credentials for OAuth authentication (Microsoft, Azure AD, generic OAuth)
      properties:
        accessToken:
          type: string
          description: OAuth access token
        idToken:
          type: string
          description: OAuth ID token (JWT)
      required:
        - accessToken
    AuthenticateResponse:
      type: object
      description: |
        Authentication response. Two possible outcomes:
        1. **Multi-step in progress**: Returns `status: "success"` with `nextStep` and `allowedMethods`
        2. **Fully authenticated**: Returns `message: "Fully authenticated"` with `accessToken` and `refreshToken`
      properties:
        status:
          type: string
          enum: [success]
          description: Authentication step status (for multi-step auth)
        message:
          type: string
          description: Response message (e.g., "Fully authenticated")
          example: "Fully authenticated"
        nextStep:
          type: integer
          description: Next authentication step number (if multi-step auth continues)
        allowedMethods:
          type: array
          items:
            type: string
            enum: [samlSso, otp, password, google, microsoft, azureAd, oauth]
          description: Allowed methods for next step (if multi-step auth continues)
        authProviders:
          $ref: '#/components/schemas/AuthProviders'
        accessToken:
          type: string
          description: JWT access token (1 hour expiry). Only returned when fully authenticated.
        refreshToken:
          type: string
          description: JWT refresh token (7 days expiry). Only returned when fully authenticated.
    OtpGenerateRequest:
      type: object
      description: Request to generate and send OTP
      properties:
        email:
          type: string
          format: email
          description: Email address to send OTP to
        cf-turnstile-response:
          type: string
          description: Cloudflare Turnstile CAPTCHA token (optional)
      required:
        - email
    PasswordResetRequest:
      type: object
      description: Request to reset password for authenticated user
      properties:
        currentPassword:
          type: string
          format: password
          description: Current password for verification
        newPassword:
          type: string
          format: password
          description: |
            New password. Must meet the following requirements:
            - Minimum 8 characters
            - At least 1 uppercase letter
            - At least 1 lowercase letter
            - At least 1 number
            - At least 1 special character (#?!@$%^&*-)
          minLength: 8
          pattern: '^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[#?!@$%^&*-]).{8,}$'
        cf-turnstile-response:
          type: string
          description: Cloudflare Turnstile CAPTCHA token (optional)
      required:
        - currentPassword
        - newPassword
    PasswordResetResponse:
      type: object
      description: Response after successful password reset
      properties:
        data:
          type: string
          example: "password reset"
        accessToken:
          type: string
          description: New JWT access token (since password change invalidates old tokens)
    ForgotPasswordRequest:
      type: object
      description: Request to send password reset email
      properties:
        email:
          type: string
          format: email
          description: Email address to send reset link to
        cf-turnstile-response:
          type: string
          description: Cloudflare Turnstile CAPTCHA token (optional)
      required:
        - email
    TokenPasswordResetRequest:
      type: object
      description: Request to reset password using email token
      properties:
        password:
          type: string
          format: password
          description: |
            New password (must meet password requirements)
          minLength: 8
      required:
        - password
    RefreshTokenResponse:
      type: object
      description: Response with new access token
      properties:
        user:
          $ref: '#/components/schemas/UserBasic'
        accessToken:
          type: string
          description: New JWT access token (1 hour expiry)
    UserBasic:
      type: object
      description: Basic user information
      properties:
        _id:
          type: string
          description: User ID
        email:
          type: string
          format: email
        fullName:
          type: string
        orgId:
          type: string
          description: Organization ID
        accountType:
          type: string
          enum: [individual, business]
    OAuthExchangeRequest:
      type: object
      description: Request to exchange OAuth authorization code for tokens
      properties:
        code:
          type: string
          description: OAuth authorization code
        email:
          type: string
          format: email
          description: User email
        provider:
          type: string
          description: OAuth provider name
        redirectUri:
          type: string
          format: uri
          description: Redirect URI used in authorization request
      required:
        - code
        - email
        - provider
        - redirectUri
    OAuthExchangeResponse:
      type: object
      description: OAuth token response
      properties:
        access_token:
          type: string
          description: OAuth access token
        id_token:
          type: string
          description: OAuth ID token (JWT)
        token_type:
          type: string
          example: "Bearer"
        expires_in:
          type: integer
          description: Token expiry in seconds
    OrgAuthConfigCreateRequest:
      type: object
      description: Request to create initial organization auth configuration
      properties:
        contactEmail:
          type: string
          format: email
          description: Organization contact email
        registeredName:
          type: string
          description: Organization registered name
        adminFullName:
          type: string
          description: Admin user full name
        sendEmail:
          type: boolean
          description: Whether to send welcome email
          default: false
      required:
        - contactEmail
        - registeredName
        - adminFullName
    AuthError:
      type: object
      description: |
        Authentication error response with details for debugging and user feedback.<br><br>
        <b>Common Error Codes:</b><br>
        <ul>
        <li><code>INVALID_CREDENTIALS</code> - Wrong password or OTP</li>
        <li><code>ACCOUNT_BLOCKED</code> - Account locked after 5 failed attempts</li>
        <li><code>SESSION_EXPIRED</code> - Session token has expired</li>
        <li><code>OTP_EXPIRED</code> - OTP code has expired (10 min validity)</li>
        <li><code>USER_NOT_FOUND</code> - Email not registered</li>
        <li><code>INVALID_TOKEN</code> - JWT token is invalid or malformed</li>
        <li><code>METHOD_NOT_ALLOWED</code> - Auth method not enabled for org</li>
        </ul>
      properties:
        error:
          type: string
          description: Error type identifier
          example: "INVALID_CREDENTIALS"
        message:
          type: string
          description: Human-readable error message
          example: "The password you entered is incorrect"
        code:
          type: string
          description: Error code for programmatic handling
          example: "AUTH_001"
        statusCode:
          type: integer
          description: HTTP status code
          example: 401
    # ==================== OAUTH PROVIDER SCHEMAS ====================
    OAuthConsentRequest:
      type: object
      description: Request to submit user consent for OAuth authorization
      properties:
        client_id:
          type: string
          description: The OAuth app's client ID
        redirect_uri:
          type: string
          format: uri
          description: Redirect URI (must match authorization request)
        scope:
          type: string
          description: Requested scopes
        state:
          type: string
          description: State parameter from authorization request
        consent:
          type: string
          enum: [granted, denied]
          description: User's consent decision
        code_challenge:
          type: string
          description: PKCE code challenge (if used in authorization request)
        code_challenge_method:
          type: string
          enum: [S256, plain]
          description: PKCE challenge method
      required:
        - client_id
        - redirect_uri
        - scope
        - state
        - consent
    OAuthTokenRequest:
      type: object
      description: |
        OAuth 2.0 Token Request (RFC 6749 Section 4.1.3).
        Request body for exchanging authorization code or credentials for tokens.
      properties:
        grant_type:
          type: string
          enum: [authorization_code, client_credentials, refresh_token]
          description: |
            OAuth grant type:
            - `authorization_code`: Exchange auth code for tokens
            - `client_credentials`: Machine-to-machine auth
            - `refresh_token`: Get new access token using refresh token
        code:
          type: string
          description: Authorization code (required for authorization_code grant)
        redirect_uri:
          type: string
          format: uri
          description: Redirect URI (required for authorization_code grant)
        client_id:
          type: string
          description: Client ID (can also be sent via Basic auth header)
        client_secret:
          type: string
          description: Client secret (can also be sent via Basic auth header)
        refresh_token:
          type: string
          description: Refresh token (required for refresh_token grant)
        scope:
          type: string
          description: Requested scopes (optional, defaults to original grant scopes)
        code_verifier:
          type: string
          description: |
            PKCE code verifier (RFC 7636). Required if code_challenge was used.
            Must be 43-128 characters from [A-Za-z0-9-._~]
          pattern: '^[A-Za-z0-9\-._~]{43,128}$'
      required:
        - grant_type
    OAuthTokenResponse:
      type: object
      description: |
        OAuth 2.0 Token Response (RFC 6749 Section 5.1).
        Contains the access token and optional refresh/ID tokens.
      properties:
        access_token:
          type: string
          description: The access token for API requests
        token_type:
          type: string
          example: "Bearer"
          description: Token type (always "Bearer")
        expires_in:
          type: integer
          description: Access token lifetime in seconds
          example: 3600
        refresh_token:
          type: string
          description: Refresh token for obtaining new access tokens
        scope:
          type: string
          description: Granted scopes (may differ from requested)
        id_token:
          type: string
          description: OpenID Connect ID token (JWT) if openid scope was requested
    OAuthRevokeRequest:
      type: object
      description: |
        OAuth 2.0 Token Revocation Request (RFC 7009).
        Revokes an access or refresh token.
      properties:
        token:
          type: string
          description: The token to revoke
        token_type_hint:
          type: string
          enum: [access_token, refresh_token]
          description: Hint about token type (optional, improves performance)
        client_id:
          type: string
          description: Client ID
        client_secret:
          type: string
          description: Client secret
      required:
        - token
        - client_id
    OAuthIntrospectRequest:
      type: object
      description: |
        OAuth 2.0 Token Introspection Request (RFC 7662).
        Check if a token is active and get its metadata.
      properties:
        token:
          type: string
          description: The token to introspect
        token_type_hint:
          type: string
          enum: [access_token, refresh_token]
          description: Hint about token type
        client_id:
          type: string
          description: Client ID
        client_secret:
          type: string
          description: Client secret
      required:
        - token
        - client_id
    OAuthIntrospectResponse:
      type: object
      description: |
        OAuth 2.0 Token Introspection Response (RFC 7662).
        Contains token metadata if active, or just `active: false` if not.
      properties:
        active:
          type: boolean
          description: Whether the token is currently active
        scope:
          type: string
          description: Scopes granted to the token
        client_id:
          type: string
          description: Client ID the token was issued to
        username:
          type: string
          description: User identifier (if user-based token)
        token_type:
          type: string
          description: Token type
        exp:
          type: integer
          description: Token expiration timestamp (Unix epoch)
        iat:
          type: integer
          description: Token issuance timestamp (Unix epoch)
        nbf:
          type: integer
          description: Token not-before timestamp (Unix epoch)
        sub:
          type: string
          description: Subject (user ID)
        aud:
          type: string
          description: Audience (client ID)
        iss:
          type: string
          description: Issuer URL
        jti:
          type: string
          description: Unique token identifier
      required:
        - active
    OAuthErrorResponse:
      type: object
      description: |
        OAuth 2.0 Error Response (RFC 6749 Section 5.2).
        Standard error format for OAuth endpoints.
      properties:
        error:
          type: string
          description: |
            Error code. Common values:
            - `invalid_request` - Missing or invalid parameter
            - `invalid_client` - Client authentication failed
            - `invalid_grant` - Invalid authorization code or refresh token
            - `unauthorized_client` - Client not authorized for this grant type
            - `unsupported_grant_type` - Grant type not supported
            - `invalid_scope` - Requested scope is invalid or exceeds allowed
            - `access_denied` - User denied authorization
          enum:
            - invalid_request
            - invalid_client
            - invalid_grant
            - unauthorized_client
            - unsupported_grant_type
            - invalid_scope
            - access_denied
            - server_error
        error_description:
          type: string
          description: Human-readable error description
        error_uri:
          type: string
          format: uri
          description: URI with more information about the error
        state:
          type: string
          description: State parameter from the authorization request
      required:
        - error
    OAuthUserInfoResponse:
      type: object
      description: |
        OpenID Connect UserInfo Response.
        Contains claims about the authenticated user.
      properties:
        sub:
          type: string
          description: Subject identifier (user ID)
        name:
          type: string
          description: Full name
        given_name:
          type: string
          description: First name
        family_name:
          type: string
          description: Last name
        email:
          type: string
          format: email
          description: Email address
        email_verified:
          type: boolean
          description: Whether email has been verified
        picture:
          type: string
          format: uri
          description: Profile picture URL
        updated_at:
          type: integer
          description: Last profile update timestamp (Unix epoch)
      required:
        - sub
    OpenIDConfiguration:
      type: object
      description: |
        OpenID Connect Discovery Response (RFC 8414).
        Contains authorization server metadata.
      properties:
        issuer:
          type: string
          format: uri
          description: Authorization server issuer URL
        authorization_endpoint:
          type: string
          format: uri
          description: OAuth authorization endpoint
        token_endpoint:
          type: string
          format: uri
          description: OAuth token endpoint
        userinfo_endpoint:
          type: string
          format: uri
          description: OpenID Connect UserInfo endpoint
        revocation_endpoint:
          type: string
          format: uri
          description: Token revocation endpoint
        introspection_endpoint:
          type: string
          format: uri
          description: Token introspection endpoint
        jwks_uri:
          type: string
          format: uri
          description: JSON Web Key Set endpoint
        scopes_supported:
          type: array
          items:
            type: string
          description: Supported OAuth scopes
          example: ["openid", "profile", "email", "read:records", "write:records"]
        response_types_supported:
          type: array
          items:
            type: string
          description: Supported OAuth response types
          example: ["code"]
        grant_types_supported:
          type: array
          items:
            type: string
          description: Supported grant types
          example: ["authorization_code", "client_credentials", "refresh_token"]
        token_endpoint_auth_methods_supported:
          type: array
          items:
            type: string
          description: Supported client authentication methods
          example: ["client_secret_basic", "client_secret_post"]
        subject_types_supported:
          type: array
          items:
            type: string
          description: Supported subject identifier types
          example: ["public"]
        id_token_signing_alg_values_supported:
          type: array
          items:
            type: string
          description: Supported ID token signing algorithms
          example: ["HS256", "RS256"]
        claims_supported:
          type: array
          items:
            type: string
          description: Supported claims in ID tokens/UserInfo
          example: ["sub", "iss", "aud", "exp", "iat", "email", "name"]
        code_challenge_methods_supported:
          type: array
          items:
            type: string
          description: Supported PKCE code challenge methods
          example: ["S256", "plain"]
    JWKS:
      type: object
      description: |
        JSON Web Key Set (RFC 7517).
        Contains public keys for verifying token signatures.
      properties:
        keys:
          type: array
          items:
            $ref: '#/components/schemas/JWK'
          description: Array of JSON Web Keys
    JWK:
      type: object
      description: |
        JSON Web Key (RFC 7517).
        Public key for verifying JWT signatures.
      properties:
        kty:
          type: string
          description: Key type
          example: "RSA"
        use:
          type: string
          description: Key use (sig = signature)
          example: "sig"
        alg:
          type: string
          description: Algorithm
          example: "RS256"
        kid:
          type: string
          description: Key ID
        n:
          type: string
          description: RSA modulus (base64url encoded)
        e:
          type: string
          description: RSA exponent (base64url encoded)
          example: "AQAB"
    # ==================== OAUTH APP MANAGEMENT SCHEMAS ====================
    CreateOAuthAppRequest:
      type: object
      description: Request to create a new OAuth app
      properties:
        name:
          type: string
          description: App name (displayed to users during authorization)
          minLength: 1
          maxLength: 100
          example: "My Integration App"
        description:
          type: string
          description: App description
          maxLength: 500
          example: "Integrates PipesHub with our internal tools"
        redirectUris:
          type: array
          items:
            type: string
            format: uri
          description: Allowed redirect URIs (1-10 URIs)
          minItems: 1
          maxItems: 10
          example: ["https://myapp.com/callback", "http://localhost:3000/callback"]
        allowedGrantTypes:
          type: array
          items:
            type: string
            enum: [authorization_code, client_credentials, refresh_token]
          description: |
            Allowed grant types. Defaults to all if not specified.
          example: ["authorization_code", "refresh_token"]
        allowedScopes:
          type: array
          items:
            type: string
          description: Scopes the app can request
          minItems: 1
          example: ["openid", "profile", "read:records"]
        homepageUrl:
          type: string
          format: uri
          description: App homepage URL (shown during authorization)
        privacyPolicyUrl:
          type: string
          format: uri
          description: Privacy policy URL
        termsOfServiceUrl:
          type: string
          format: uri
          description: Terms of service URL
        isConfidential:
          type: boolean
          description: |
            Whether the app can securely store secrets.
            - `true`: Server-side app (secret required for token requests)
            - `false`: Browser/mobile app (must use PKCE)
          default: true
        accessTokenLifetime:
          type: integer
          description: Access token lifetime in seconds (300-86400)
          minimum: 300
          maximum: 86400
          default: 3600
          example: 3600
        refreshTokenLifetime:
          type: integer
          description: Refresh token lifetime in seconds (3600-31536000)
          minimum: 3600
          maximum: 31536000
          default: 604800
          example: 604800
      required:
        - name
        - redirectUris
        - allowedScopes
    UpdateOAuthAppRequest:
      type: object
      description: Request to update an OAuth app
      properties:
        name:
          type: string
          description: App name
          minLength: 1
          maxLength: 100
        description:
          type: string
          description: App description
          maxLength: 500
        redirectUris:
          type: array
          items:
            type: string
            format: uri
          description: Allowed redirect URIs
          minItems: 1
          maxItems: 10
        allowedGrantTypes:
          type: array
          items:
            type: string
            enum: [authorization_code, client_credentials, refresh_token]
        allowedScopes:
          type: array
          items:
            type: string
          minItems: 1
        homepageUrl:
          type: string
          format: uri
          nullable: true
        privacyPolicyUrl:
          type: string
          format: uri
          nullable: true
        termsOfServiceUrl:
          type: string
          format: uri
          nullable: true
        accessTokenLifetime:
          type: integer
          minimum: 300
          maximum: 86400
        refreshTokenLifetime:
          type: integer
          minimum: 3600
          maximum: 31536000
    OAuthAppResponse:
      type: object
      description: OAuth app details (without secret)
      properties:
        id:
          type: string
          description: App ID
        slug:
          type: string
          description: URL-friendly app slug
        clientId:
          type: string
          description: OAuth client ID
        name:
          type: string
          description: App name
        description:
          type: string
          description: App description
        redirectUris:
          type: array
          items:
            type: string
          description: Allowed redirect URIs
        allowedGrantTypes:
          type: array
          items:
            type: string
          description: Allowed grant types
        allowedScopes:
          type: array
          items:
            type: string
          description: Allowed scopes
        status:
          type: string
          enum: [active, suspended, revoked]
          description: App status
        logoUrl:
          type: string
          format: uri
          description: App logo URL
        homepageUrl:
          type: string
          format: uri
          description: App homepage
        privacyPolicyUrl:
          type: string
          format: uri
          description: Privacy policy URL
        termsOfServiceUrl:
          type: string
          format: uri
          description: Terms of service URL
        isConfidential:
          type: boolean
          description: Whether app is a confidential client
        accessTokenLifetime:
          type: integer
          description: Access token lifetime in seconds
        refreshTokenLifetime:
          type: integer
          description: Refresh token lifetime in seconds
        createdAt:
          type: string
          format: date-time
          description: Creation timestamp
        updatedAt:
          type: string
          format: date-time
          description: Last update timestamp
    OAuthAppWithSecret:
      allOf:
        - $ref: '#/components/schemas/OAuthAppResponse'
        - type: object
          properties:
            clientSecret:
              type: string
              description: |
                Client secret (only shown on creation and secret regeneration).
                Store this securely - it cannot be retrieved later.
          required:
            - clientSecret
    OAuthAppListResponse:
      type: object
      description: Paginated list of OAuth apps
      properties:
        data:
          type: array
          items:
            $ref: '#/components/schemas/OAuthAppResponse'
          description: List of OAuth apps
        pagination:
          type: object
          properties:
            page:
              type: integer
              description: Current page number
            limit:
              type: integer
              description: Items per page
            total:
              type: integer
              description: Total number of items
            totalPages:
              type: integer
              description: Total number of pages
    OAuthScopeInfo:
      type: object
      description: Information about an OAuth scope
      properties:
        name:
          type: string
          description: Scope identifier
          example: "read:records"
        description:
          type: string
          description: Human-readable scope description
          example: "Read access to records"
        category:
          type: string
          description: Scope category for grouping
          example: "Records"
    OAuthTokenListItem:
      type: object
      description: Information about an issued token
      properties:
        id:
          type: string
          description: Token ID
        tokenType:
          type: string
          enum: [access, refresh]
          description: Type of token
        userId:
          type: string
          description: User ID (if user-based token)
        scopes:
          type: array
          items:
            type: string
          description: Granted scopes
        createdAt:
          type: string
          format: date-time
          description: Token creation time
        expiresAt:
          type: string
          format: date-time
          description: Token expiration time
        isRevoked:
          type: boolean
          description: Whether token has been revoked
    # ==================== USER MANAGEMENT SCHEMAS ====================
    User:
      type: object
      description: User account in an organization
      properties:
        _id:
          type: string
          format: ObjectId
          description: Unique user identifier (MongoDB ObjectId)
        slug:
          type: string
          description: Unique slug for the user
        orgId:
          type: string
          format: ObjectId
          description: Organization ID the user belongs to
        fullName:
          type: string
          description: Full name of the user
          minLength: 1
        firstName:
          type: string
          description: First name
        lastName:
          type: string
          description: Last name
        middleName:
          type: string
          description: Middle name
        email:
          type: string
          format: email
          description: Email address (unique, lowercase)
        mobile:
          type: string
          description: Mobile number (10-15 digits with optional +)
          pattern: '^\+?[0-9]{10,15}$'
        hasLoggedIn:
          type: boolean
          description: Whether user has logged in at least once
          default: false
        designation:
          type: string
          description: Job title/designation
        address:
          $ref: '#/components/schemas/Address'
        dataCollectionConsent:
          type: boolean
          description: Whether user has consented to data collection
        isDeleted:
          type: boolean
          description: Soft delete flag
          default: false
        deletedBy:
          type: string
          description: ID of user who deleted this user
        createdAt:
          type: integer
          format: int64
          description: Creation timestamp (milliseconds since epoch)
        updatedAt:
          type: integer
          format: int64
          description: Last update timestamp (milliseconds since epoch)
      required:
        - email
        - orgId
    Address:
      type: object
      properties:
        addressLine1:
          type: string
          description: Address line 1
        city:
          type: string
          description: City
        state:
          type: string
          description: State/Province
        postCode:
          type: string
          description: Postal/ZIP code
        country:
          type: string
          description: Country
    Organization:
      type: object
      properties:
        _id:
          type: string
          format: ObjectId
          description: Unique organization identifier
        slug:
          type: string
          description: Unique slug for the organization
        registeredName:
          type: string
          description: Registered name
        shortName:
          type: string
          description: Short name or display name
        domain:
          type: string
          description: Organization domain
        contactEmail:
          type: string
          format: email
          description: Contact email address
        accountType:
          type: string
          enum: [individual, business]
          description: Type of account
        onBoardingStatus:
          type: string
          enum: [configured, notConfigured, skipped]
          description: Onboarding status
        isDeleted:
          type: boolean
          description: Soft delete flag
          default: false
        createdAt:
          type: integer
          format: int64
          description: Creation timestamp
        updatedAt:
          type: integer
          format: int64
          description: Last update timestamp
      required:
        - domain
        - contactEmail
        - accountType
    Team:
      type: object
      properties:
        _id:
          type: string
          format: ObjectId
          description: Unique team identifier
        name:
          type: string
          description: Team name
        description:
          type: string
          description: Team description
        orgId:
          type: string
          format: ObjectId
          description: Organization ID
        userRoles:
          type: array
          items:
            $ref: '#/components/schemas/UserRole'
          description: Users and their roles in the team
        createdAt:
          type: integer
          format: int64
          description: Creation timestamp
        updatedAt:
          type: integer
          format: int64
          description: Last update timestamp
      required:
        - name
    UserRole:
      type: object
      properties:
        userId:
          type: string
          description: User's database key
        role:
          type: string
          enum: [OWNER, READER]
          description: User's role in the team
      required:
        - userId
        - role
    UserGroup:
      type: object
      description: User group for organizing users within an organization
      properties:
        _id:
          type: string
          format: ObjectId
          description: Unique group identifier
        slug:
          type: string
          description: Unique slug for the group
        type:
          type: string
          enum: [admin, standard, everyone, custom]
          description: |
            Group type:
            - admin: System admin group (cannot be modified)
            - standard: Default user group
            - everyone: All users group (cannot be modified)
            - custom: User-created custom group
        name:
          type: string
          description: Group name (unique within organization)
          minLength: 1
        orgId:
          type: string
          format: ObjectId
          description: Organization ID
        users:
          type: array
          items:
            type: string
            format: ObjectId
          description: Array of user IDs in this group
        isDeleted:
          type: boolean
          description: Soft delete flag
          default: false
        deletedBy:
          type: string
          format: ObjectId
          description: ID of user who deleted this group
        createdAt:
          type: integer
          format: int64
          description: Creation timestamp
        updatedAt:
          type: integer
          format: int64
          description: Last update timestamp
      required:
        - type
        - name
        - orgId
    # ==================== STORAGE SCHEMAS ====================
    Document:
      type: object
      description: |
        Represents a document stored in PipesHub storage system. Documents can be versioned to maintain complete history of changes. Supports multiple storage backends (S3, Azure Blob, Local).
      required:
        - _id
        - documentName
        - isVersionedFile
        - orgId
        - storageVendor
      properties:
        _id:
          type: string
          pattern: '^[a-fA-F0-9]{24}$'
          description: Document unique identifier (MongoDB ObjectId)
          example: "507f1f77bcf86cd799439011"
        documentName:
          type: string
          description: Display name of the document
          example: "Q4 Financial Report.pdf"
        alternateDocumentName:
          type: string
          description: Alternative name for search/display purposes
          example: "2024-Q4-Finance"
        documentPath:
          type: string
          description: Virtual folder path for organization
          example: "/reports/finance/2024"
        isVersionedFile:
          type: boolean
          description: Whether version control is enabled for this document
          example: true
        orgId:
          type: string
          pattern: '^[a-fA-F0-9]{24}$'
          description: Organization ID the document belongs to
          example: "507f1f77bcf86cd799439012"
        permissions:
          type: string
          enum: [owner, editor, commentator, readonly]
          description: Default permission level for shared access
          example: "owner"
        initiatorUserId:
          type: string
          pattern: '^[a-fA-F0-9]{24}$'
          description: User ID who created/uploaded the document
          example: "507f1f77bcf86cd799439013"
        sizeInBytes:
          type: integer
          description: File size in bytes
          example: 1048576
        mimeType:
          type: string
          description: MIME type of the document
          example: "application/pdf"
        extension:
          type: string
          description: File extension (with leading dot)
          example: ".pdf"
        mutationCount:
          type: integer
          description: Number of times the document has been updated
          example: 5
        versionHistory:
          type: array
          description: Complete version history (for versioned documents)
          items:
            $ref: '#/components/schemas/DocumentVersion'
        customMetadata:
          type: array
          description: Custom key-value metadata pairs
          items:
            type: object
            properties:
              key:
                type: string
              value:
                type: string
        tags:
          type: array
          description: Tags for categorization and search
          items:
            type: string
          example: ["finance", "quarterly", "report"]
        storageVendor:
          type: string
          enum: [s3, azureBlob, local]
          description: Storage backend where the file is stored
          example: "s3"
        s3:
          type: object
          description: S3-specific storage information (if storageVendor is s3)
          properties:
            url:
              type: string
              description: S3 object URL
              example: "s3://bucket-name/path/to/file.pdf"
        azureBlob:
          type: object
          description: Azure Blob-specific storage information (if storageVendor is azureBlob)
          properties:
            url:
              type: string
              description: Azure Blob URL
              example: "https://account.blob.core.windows.net/container/path/file.pdf"
        local:
          type: object
          description: Local storage-specific information (if storageVendor is local)
          properties:
            url:
              type: string
              description: Local file path
            localPath:
              type: string
              description: Absolute path on filesystem
        createdAt:
          type: integer
          format: int64
          description: Creation timestamp in milliseconds since epoch
          example: 1704067200000
        updatedAt:
          type: integer
          format: int64
          description: Last update timestamp in milliseconds since epoch
          example: 1704153600000
        isDeleted:
          type: boolean
          description: Whether the document is soft-deleted
          default: false
        deletedByUserId:
          type: string
          pattern: '^[a-fA-F0-9]{24}$'
          description: User ID who deleted the document
    DocumentVersion:
      type: object
      description: Represents a single version entry in a document's version history
      properties:
        version:
          type: integer
          description: Version number (0-indexed, auto-incremented)
          example: 2
        userAssignedVersionLabel:
          type: string
          description: User-assigned version label (e.g., "v1.0", "Final")
          example: "v1.2"
        note:
          type: string
          description: Note describing this version's changes
          example: "Added executive summary section"
        extension:
          type: string
          description: File extension for this version
          example: ".pdf"
        size:
          type: integer
          description: File size in bytes for this version
          example: 1048576
        mutationCount:
          type: integer
          description: Mutation count at time of version creation
          example: 3
        s3:
          type: object
          description: S3 storage URL for this version
          properties:
            url:
              type: string
        azureBlob:
          type: object
          description: Azure Blob storage URL for this version
          properties:
            url:
              type: string
        local:
          type: object
          description: Local storage path for this version
          properties:
            url:
              type: string
            localPath:
              type: string
        createdAt:
          type: integer
          format: int64
          description: Version creation timestamp in milliseconds
          example: 1704153600000
        initiatedByUserId:
          type: string
          pattern: '^[a-fA-F0-9]{24}$'
          description: User ID who created this version
          example: "507f1f77bcf86cd799439013"
    # ==================== KNOWLEDGE BASE SCHEMAS ====================
    KnowledgeBase:
      type: object
      properties:
        _key:
          type: string
          description: Unique knowledge base identifier
        name:
          type: string
          description: Name of the knowledge base
        orgId:
          type: string
          description: Organization ID
        createdAtTimestamp:
          type: integer
          format: int64
          description: Creation timestamp
        updatedAtTimestamp:
          type: integer
          format: int64
          description: Last update timestamp
        userRole:
          type: string
          enum: [OWNER, ORGANIZER, FILEORGANIZER, WRITER, COMMENTER, READER]
          description: User's role in this knowledge base
        isDeleted:
          type: boolean
          description: Whether the knowledge base is deleted
          default: false
      required:
        - name
        - orgId
    Folder:
      type: object
      properties:
        _key:
          type: string
          description: Unique folder identifier
        name:
          type: string
          description: Name of the folder
        parentId:
          type: string
          description: Parent folder or KB ID
        kbId:
          type: string
          description: Knowledge base ID
        orgId:
          type: string
          description: Organization ID
        createdAtTimestamp:
          type: integer
          format: int64
          description: Creation timestamp
        updatedAtTimestamp:
          type: integer
          format: int64
          description: Last update timestamp
        isDeleted:
          type: boolean
          description: Whether the folder is deleted
          default: false
      required:
        - name
        - kbId
        - orgId
    Record:
      type: object
      description: |
        A record represents a single document, file, or content item within a knowledge base.
        Records can originate from file uploads or external connectors (Google Drive, OneDrive, etc.).
      properties:
        _key:
          type: string
          description: Unique record identifier (UUID format)
          example: "550e8400-e29b-41d4-a716-446655440000"
        recordName:
          type: string
          description: Display name of the record
          example: "Q4 Financial Report.pdf"
        externalRecordId:
          type: string
          description: External storage document ID (links to Storage module)
          example: "507f1f77bcf86cd799439011"
        recordType:
          type: string
          enum: [FILE, WEBPAGE, COMMENT, MESSAGE, EMAIL, TICKET, OTHERS]
          description: |
            Type of content:
            - FILE: Uploaded documents (PDF, DOCX, etc.)
            - WEBPAGE: Web pages crawled or bookmarked
            - COMMENT: Comments from collaboration tools
            - MESSAGE: Chat/messaging content (Slack, Teams)
            - EMAIL: Email messages (Gmail, Outlook)
            - TICKET: Support tickets (Jira, ServiceNow)
            - OTHERS: Miscellaneous content types
          example: "FILE"
        origin:
          type: string
          enum: [UPLOAD, CONNECTOR]
          description: |
            Source of the record:
            - UPLOAD: Manually uploaded via API/UI
            - CONNECTOR: Synced from external connector
          example: "UPLOAD"
        connectorId:
          type: string
          description: ID of the connector that synced this record (null for uploads)
          example: "conn_123456"
        connectorName:
          type: string
          enum: [ONEDRIVE, GOOGLE_DRIVE, CONFLUENCE, JIRA, SLACK, SHAREPOINT_ONLINE, GMAIL, DROPBOX, OUTLOOK, SERVICENOW, BOOKSTACK, WEB]
          description: Name of the source connector
          example: "GOOGLE_DRIVE"
        orgId:
          type: string
          description: Organization ID that owns this record
          example: "org_abc123"
        kbId:
          type: string
          description: Knowledge base ID containing this record
          example: "kb_xyz789"
        folderId:
          type: string
          description: Parent folder ID (null if at KB root)
          example: "folder_456"
        version:
          type: integer
          description: Current version number (increments on updates)
          default: 0
          example: 3
        createdAtTimestamp:
          type: integer
          format: int64
          description: Creation timestamp in milliseconds
          example: 1704153600000
        updatedAtTimestamp:
          type: integer
          format: int64
          description: Last update timestamp in milliseconds
          example: 1704240000000
        indexingStatus:
          type: string
          enum: [NOT_STARTED, PAUSED, IN_PROGRESS, COMPLETED, FAILED, FILE_TYPE_NOT_SUPPORTED, AUTO_INDEX_OFF, EMPTY, ENABLE_MULTIMODAL_MODELS, QUEUED]
          description: |
            Current indexing/processing status:
            - NOT_STARTED: Awaiting indexing
            - QUEUED: In indexing queue
            - IN_PROGRESS: Currently being indexed
            - COMPLETED: Successfully indexed and searchable
            - FAILED: Indexing failed (check error details)
            - PAUSED: Indexing paused by user
            - FILE_TYPE_NOT_SUPPORTED: Unsupported file format
            - AUTO_INDEX_OFF: Auto-indexing disabled for this record
            - EMPTY: File has no extractable content
            - ENABLE_MULTIMODAL_MODELS: Requires multimodal AI models
          example: "COMPLETED"
        isDeleted:
          type: boolean
          description: Soft delete flag
          default: false
        isArchived:
          type: boolean
          description: Archive flag for inactive records
          default: false
        webUrl:
          type: string
          format: uri
          description: Direct URL to access the original content
          example: "https://drive.google.com/file/d/abc123"
        mimeType:
          type: string
          description: MIME type of the file content
          example: "application/pdf"
        sizeInBytes:
          type: integer
          format: int64
          description: File size in bytes
          example: 1048576
        extension:
          type: string
          description: File extension (without dot)
          example: "pdf"
        sha256Hash:
          type: string
          description: SHA-256 hash for content deduplication
          example: "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
      required:
        - recordName
        - recordType
        - origin
        - orgId
    RecordsResponse:
      type: object
      description: Paginated response for records listing
      properties:
        records:
          type: array
          items:
            $ref: '#/components/schemas/Record'
        pagination:
          $ref: '#/components/schemas/PaginationInfo'
        filters:
          type: object
          properties:
            applied:
              type: object
              description: Currently applied filters
            available:
              type: object
              description: Available filter options with counts
    UploadResult:
      type: object
      description: Result of a file upload operation
      properties:
        message:
          type: string
          example: "Files uploaded successfully"
        uploadResults:
          type: array
          items:
            type: object
            properties:
              recordId:
                type: string
              recordName:
                type: string
              status:
                type: string
                enum: [success, failed]
              error:
                type: string
    ConnectorStats:
      type: object
      description: Statistics for a connector's records
      properties:
        connectorId:
          type: string
        totalRecords:
          type: integer
        indexedRecords:
          type: integer
        failedRecords:
          type: integer
        pendingRecords:
          type: integer
        lastSyncTime:
          type: integer
          format: int64
        statusBreakdown:
          type: object
          additionalProperties:
            type: integer
    KnowledgeHubNode:
      type: object
      description: A node in the knowledge hub tree structure
      properties:
        id:
          type: string
        name:
          type: string
        type:
          type: string
          enum: [KB, FOLDER, RECORD, CONNECTOR, APP]
        parentId:
          type: string
        hasChildren:
          type: boolean
        childCount:
          type: integer
        metadata:
          type: object
    KBPermission:
      type: object
      properties:
        userId:
          type: string
          description: User ID
        teamId:
          type: string
          description: Team ID
        role:
          type: string
          enum: [OWNER, ORGANIZER, FILEORGANIZER, WRITER, COMMENTER, READER]
          description: Permission role
        kbId:
          type: string
          description: Knowledge base ID
        grantedBy:
          type: string
          description: User ID who granted the permission
        grantedAt:
          type: integer
          format: int64
          description: Timestamp when permission was granted
    # ==================== ENTERPRISE SEARCH SCHEMAS ====================
    AppType:
      type: string
      enum: [drive, gmail, onedrive, sharepointOnline, bookstack, confluence, jira, slack, dropbox, outlook, servicenow, web, local]
      description: Supported application/connector types
    Filters:
      type: object
      properties:
        apps:
          type: array
          items:
            $ref: '#/components/schemas/AppType'
          description: Filter by application types
        kb:
          type: array
          items:
            type: string
            format: uuid
          description: Filter by knowledge base IDs
    # ==================== ENTERPRISE SEARCH SCHEMAS ====================
    CreateConversationRequest:
      type: object
      description: |
        Request body for creating a new AI conversation.<br><br>
        <b>Query Processing:</b><br>
        The query is processed through PipesHub's AI pipeline which:
        <ul>
        <li>Performs semantic search across indexed knowledge bases</li>
        <li>Retrieves relevant context from matching documents</li>
        <li>Generates a response with citations to source materials</li>
        <li>Suggests follow-up questions based on the conversation</li>
        </ul>
      required:
        - query
      properties:
        query:
          type: string
          minLength: 1
          maxLength: 100000
          description: |
            The user's question or prompt to start the conversation.
            Supports natural language queries of any complexity.
          example: "What are the key findings from our Q4 financial report?"
        recordIds:
          type: array
          items:
            type: string
            format: objectId
          description: |
            Limit the AI's knowledge scope to specific records/documents.
            When provided, only these records will be searched for context.
          example: ["507f1f77bcf86cd799439011", "507f1f77bcf86cd799439012"]
        departments:
          type: array
          items:
            type: string
            format: objectId
          description: Filter by department IDs to scope the search
        filters:
          $ref: '#/components/schemas/Filters'
        modelKey:
          type: string
          description: |
            Identifier for the AI model configuration to use.
            Available models depend on organization settings.
          example: "gpt-4-turbo"
        modelName:
          type: string
          description: Display name of the AI model
          example: "GPT-4 Turbo"
        chatMode:
          type: string
          description: |
            Chat mode affecting response behavior.
            Different modes optimize for different use cases.
          example: "balanced"
    AddMessageRequest:
      type: object
      description: Request body for adding a message to an existing conversation
      required:
        - query
      properties:
        query:
          type: string
          minLength: 1
          description: The follow-up question or message content
          example: "Can you elaborate on the revenue trends?"
        filters:
          $ref: '#/components/schemas/Filters'
        modelKey:
          type: string
          description: Override the model for this specific message
        modelName:
          type: string
          description: Display name of the model
        chatMode:
          type: string
          description: Chat mode for this message
    Message:
      type: object
      description: |
        A single message within a conversation. Messages can be user queries,
        AI responses, system messages, or error notifications.
      properties:
        _id:
          type: string
          format: objectId
          description: Unique message identifier
        messageType:
          type: string
          enum: [user_query, bot_response, error, feedback, system]
          description: |
            Type of message:
            <ul>
            <li><code>user_query</code> - User's question or input</li>
            <li><code>bot_response</code> - AI-generated response</li>
            <li><code>error</code> - Error message from the system</li>
            <li><code>feedback</code> - User feedback on a response</li>
            <li><code>system</code> - System notification or status</li>
            </ul>
        content:
          type: string
          description: The message text content
        contentFormat:
          type: string
          enum: [MARKDOWN, JSON, HTML]
          description: Format of the content for rendering
          default: MARKDOWN
        citations:
          type: array
          items:
            $ref: '#/components/schemas/CitationReference'
          description: References to source documents used in the response
        confidence:
          type: string
          description: AI's confidence level in the response
        followUpQuestions:
          type: array
          items:
            $ref: '#/components/schemas/FollowUpQuestion'
          description: Suggested follow-up questions
        feedback:
          type: array
          items:
            $ref: '#/components/schemas/MessageFeedback'
          description: User feedback on this message
        metadata:
          type: object
          properties:
            processingTimeMs:
              type: number
              description: Time taken to generate response in milliseconds
            modelVersion:
              type: string
              description: Version of the AI model used
            aiTransactionId:
              type: string
              description: Transaction ID for tracking in AI backend
            reason:
              type: string
              description: Additional context or reasoning
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
    CitationReference:
      type: object
      description: Reference to a source document cited in a response
      properties:
        citationId:
          type: string
          format: objectId
          description: ID of the citation record
        relevanceScore:
          type: number
          minimum: 0
          maximum: 1
          description: How relevant this citation is to the query (0-1)
        excerpt:
          type: string
          description: Relevant excerpt from the source document
        context:
          type: string
          description: Additional context around the citation
    FollowUpQuestion:
      type: object
      description: AI-suggested follow-up question
      properties:
        question:
          type: string
          description: The suggested question text
        confidence:
          type: string
          description: Confidence level for this suggestion
        reasoning:
          type: string
          description: Why this question might be relevant
    MessageFeedback:
      type: object
      description: |
        Comprehensive feedback on an AI response. Feedback helps improve
        the AI's performance and response quality over time.
      properties:
        isHelpful:
          type: boolean
          description: Overall helpfulness rating
        ratings:
          type: object
          properties:
            accuracy:
              type: integer
              minimum: 1
              maximum: 5
              description: How accurate was the information (1-5)
            relevance:
              type: integer
              minimum: 1
              maximum: 5
              description: How relevant was the response (1-5)
            completeness:
              type: integer
              minimum: 1
              maximum: 5
              description: How complete was the answer (1-5)
            clarity:
              type: integer
              minimum: 1
              maximum: 5
              description: How clear was the explanation (1-5)
        categories:
          type: array
          items:
            type: string
            enum:
              - incorrect_information
              - missing_information
              - outdated_information
              - irrelevant_response
              - too_verbose
              - too_brief
              - formatting_issues
              - citation_issues
          description: Categories of issues identified
        comments:
          type: object
          properties:
            positive:
              type: string
              description: What was good about the response
            negative:
              type: string
              description: What could be improved
            suggestions:
              type: string
              description: Specific suggestions for improvement
        citationFeedback:
          type: array
          items:
            type: object
            properties:
              citationId:
                type: string
                format: objectId
              isRelevant:
                type: boolean
              relevanceScore:
                type: integer
                minimum: 1
                maximum: 5
              comment:
                type: string
          description: Feedback on individual citations
        followUpQuestionsHelpful:
          type: boolean
          description: Were the suggested follow-up questions helpful
    Conversation:
      type: object
      description: |
        A conversation represents a chat session between a user and the AI.
        Conversations maintain context across multiple messages and can be
        shared, archived, and organized.
      properties:
        _id:
          type: string
          format: objectId
          description: Unique conversation identifier
        userId:
          type: string
          format: objectId
          description: ID of the user who owns this conversation
        orgId:
          type: string
          format: objectId
          description: Organization this conversation belongs to
        title:
          type: string
          description: |
            Conversation title, auto-generated from first query
            or manually updated
          example: "Q4 Financial Report Discussion"
        initiator:
          type: string
          format: objectId
          description: User who started the conversation
        messages:
          type: array
          items:
            $ref: '#/components/schemas/Message'
          description: All messages in this conversation
        status:
          type: string
          enum: [INPROGRESS, COMPLETED, FAILED]
          description: |
            Current status of the conversation:
            <ul>
            <li><code>INPROGRESS</code> - AI is processing</li>
            <li><code>COMPLETED</code> - Response ready</li>
            <li><code>FAILED</code> - Error occurred</li>
            </ul>
        failReason:
          type: string
          description: Error description if status is FAILED
        modelInfo:
          type: object
          properties:
            modelKey:
              type: string
            modelName:
              type: string
            modelProvider:
              type: string
            chatMode:
              type: string
          description: AI model configuration used
        isShared:
          type: boolean
          default: false
          description: Whether this conversation is shared with others
        shareLink:
          type: string
          description: Shareable link if conversation is shared
        sharedWith:
          type: array
          items:
            type: object
            properties:
              userId:
                type: string
                format: objectId
              accessLevel:
                type: string
                enum: [read, write]
          description: Users this conversation is shared with
        isArchived:
          type: boolean
          default: false
          description: Whether this conversation is archived
        archivedBy:
          type: string
          format: objectId
          description: User who archived this conversation
        lastActivityAt:
          type: integer
          description: Unix timestamp of last activity
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
    ShareRequest:
      type: object
      description: Request to share a conversation or search with other users
      required:
        - userIds
      properties:
        userIds:
          type: array
          items:
            type: string
            format: objectId
          minItems: 1
          description: IDs of users to share with
          example: ["507f1f77bcf86cd799439011"]
        accessLevel:
          type: string
          enum: [read, write]
          default: read
          description: |
            Permission level for shared users:
            <ul>
            <li><code>read</code> - Can view only</li>
            <li><code>write</code> - Can add messages</li>
            </ul>
    SemanticSearchRequest:
      type: object
      description: |
        Request body for performing semantic search across the enterprise knowledge base.<br><br>
        <b>How Semantic Search Works:</b><br>
        <ol>
        <li>Query is converted to vector embeddings</li>
        <li>Similar content is found using vector similarity</li>
        <li>Results are ranked by relevance score</li>
        <li>Matching chunks with metadata are returned</li>
        </ol>
        <b>Filtering:</b><br>
        Use filters to narrow search scope to specific apps or knowledge bases.
      required:
        - query
      properties:
        query:
          type: string
          minLength: 1
          description: |
            Natural language search query. The system understands
            semantic meaning, not just keywords.
          example: "employee onboarding procedures"
        filters:
          $ref: '#/components/schemas/Filters'
        limit:
          type: integer
          minimum: 1
          maximum: 100
          default: 10
          description: Maximum number of results to return
        modelKey:
          type: string
          description: AI model to use for embeddings
        modelName:
          type: string
          description: Display name of the model
        chatMode:
          type: string
          description: Processing mode configuration
    SearchResult:
      type: object
      description: |
        Result of a semantic search operation, containing matching
        document chunks with relevance scores.
      properties:
        _id:
          type: string
          format: objectId
          description: Unique search record identifier
        searchId:
          type: string
          format: objectId
          description: Alias for _id
        query:
          type: string
          description: The original search query
        results:
          type: array
          items:
            $ref: '#/components/schemas/SearchResultItem'
          description: Matching content chunks
        records:
          type: object
          additionalProperties:
            type: string
          description: Map of record IDs to record names
        userId:
          type: string
          format: objectId
        orgId:
          type: string
          format: objectId
        isShared:
          type: boolean
          default: false
        sharedWith:
          type: array
          items:
            type: object
            properties:
              userId:
                type: string
                format: objectId
              accessLevel:
                type: string
                enum: [read, write]
        isArchived:
          type: boolean
          default: false
        createdAt:
          type: string
          format: date-time
    SearchResultItem:
      type: object
      description: A single matching chunk from semantic search
      properties:
        content:
          type: string
          description: The matching text content
        chunkIndex:
          type: integer
          description: Index of this chunk within the source document
        citationType:
          type: string
          description: Type of citation/source
        metadata:
          type: object
          description: Additional metadata about the source
          properties:
            recordId:
              type: string
            recordName:
              type: string
            connectorName:
              type: string
            webUrl:
              type: string
            mimeType:
              type: string
        score:
          type: number
          description: Relevance score (higher is more relevant)
    # ==================== AGENT SCHEMAS ====================
    Agent:
      type: object
      description: |
        A custom AI agent with specialized capabilities, tools, and knowledge scope.
        Agents can be configured for specific use cases like customer support,
        code review, or domain-specific Q&A.
      properties:
        agentKey:
          type: string
          description: Unique identifier key for the agent
          example: "customer-support-agent"
        name:
          type: string
          description: Display name of the agent
          example: "Customer Support Assistant"
        description:
          type: string
          description: What this agent is designed to do
        systemPrompt:
          type: string
          description: System instructions that define agent behavior
        tools:
          type: array
          items:
            type: string
          description: List of tool keys the agent can use
        knowledgeBases:
          type: array
          items:
            type: string
            format: uuid
          description: Knowledge bases the agent has access to
        llmConfig:
          type: object
          properties:
            modelKey:
              type: string
            temperature:
              type: number
            maxTokens:
              type: integer
          description: AI model configuration
        isPublic:
          type: boolean
          description: Whether agent is available to all org users
        createdBy:
          type: string
          format: objectId
        orgId:
          type: string
          format: objectId
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
    AgentTemplate:
      type: object
      description: |
        Reusable template for creating agents. Templates define the base
        configuration that can be customized when creating an agent instance.
      properties:
        templateId:
          type: string
          description: Unique template identifier
        name:
          type: string
          description: Template name
          example: "Technical Support Template"
        description:
          type: string
          description: What agents from this template are designed for
        category:
          type: string
          description: Template category for organization
          example: "Customer Service"
        defaultSystemPrompt:
          type: string
          description: Default system prompt for agents
        recommendedTools:
          type: array
          items:
            type: string
          description: Suggested tools for this template
        configSchema:
          type: object
          description: JSON Schema for template customization options
        isPublic:
          type: boolean
          description: Whether template is available organization-wide
        createdBy:
          type: string
          format: objectId
        createdAt:
          type: string
          format: date-time
    AgentTool:
      type: object
      description: A tool that agents can use to perform actions
      properties:
        key:
          type: string
          description: Unique tool identifier
          example: "web-search"
        name:
          type: string
          description: Display name
          example: "Web Search"
        description:
          type: string
          description: What the tool does
        inputSchema:
          type: object
          description: JSON Schema for tool inputs
        isEnabled:
          type: boolean
          description: Whether tool is currently available
    AgentConversation:
      type: object
      description: |
        A conversation with a specific AI agent. Similar to regular conversations
        but tied to an agent's configuration and capabilities.
      properties:
        _id:
          type: string
          format: objectId
        agentKey:
          type: string
          description: The agent this conversation is with
        userId:
          type: string
          format: objectId
        orgId:
          type: string
          format: objectId
        title:
          type: string
        messages:
          type: array
          items:
            $ref: '#/components/schemas/Message'
        status:
          type: string
          enum: [INPROGRESS, COMPLETED, FAILED]
        isShared:
          type: boolean
        sharedWith:
          type: array
          items:
            type: object
            properties:
              userId:
                type: string
              accessLevel:
                type: string
                enum: [read, write]
        lastActivityAt:
          type: integer
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
    SSEEvent:
      type: object
      description: |
        Server-Sent Event structure for streaming responses.<br><br>
        <b>Event Types:</b>
        <ul>
        <li><code>connected</code> - Initial connection established</li>
        <li><code>chunk</code> - Partial response content</li>
        <li><code>citation</code> - Citation reference</li>
        <li><code>complete</code> - Final response with all data</li>
        <li><code>error</code> - Error occurred during streaming</li>
        </ul>
      properties:
        event:
          type: string
          enum: [connected, chunk, citation, complete, error]
        data:
          type: string
          description: JSON-encoded event payload
    # ==================== CONNECTOR SCHEMAS ====================
    ConnectorScope:
      type: string
      description: |
        Scope determines visibility and access control for connectors:<br>
        <ul>
        <li><code>team</code> - Available to all users in the organization (admin-only creation)</li>
        <li><code>personal</code> - Private to the creating user only</li>
        </ul>
      enum: [team, personal]
      example: "team"
    ConnectorAuthType:
      type: string
      description: |
        Authentication method required by the connector:<br>
        <ul>
        <li><code>OAUTH</code> - User OAuth consent flow</li>
        <li><code>OAUTH_ADMIN_CONSENT</code> - Admin OAuth with org-wide consent</li>
        <li><code>API_TOKEN</code> - API key or token authentication</li>
        <li><code>USERNAME_PASSWORD</code> - Username/password credentials</li>
        <li><code>NONE</code> - No authentication required</li>
        </ul>
      enum: [OAUTH, OAUTH_ADMIN_CONSENT, API_TOKEN, USERNAME_PASSWORD, NONE]
    ConnectorType:
      type: object
      description: |
        A connector type from the registry. Represents an available integration
        that can be configured as a connector instance.
      properties:
        connectorType:
          type: string
          description: Unique identifier for this connector type
          example: "google-drive"
        displayName:
          type: string
          description: Human-readable name
          example: "Google Drive"
        description:
          type: string
          description: What this connector does
        appGroupId:
          type: string
          description: Application group identifier
        appGroup:
          type: string
          description: Application group name (e.g., "Google Workspace")
        authTypes:
          type: array
          items:
            $ref: '#/components/schemas/ConnectorAuthType'
          description: Supported authentication methods
        supportedScopes:
          type: array
          items:
            $ref: '#/components/schemas/ConnectorScope'
          description: Supported scope types
        supportsSync:
          type: boolean
          description: Whether connector supports data synchronization
        supportsAgent:
          type: boolean
          description: Whether connector supports AI agent integration
        supportsRealtime:
          type: boolean
          description: Whether connector supports real-time updates
        iconPath:
          type: string
          description: Path to connector icon
        categories:
          type: array
          items:
            type: string
          description: Categories (e.g., "Storage", "Communication")
        isBeta:
          type: boolean
          description: Whether this is a beta connector
    ConnectorInstance:
      type: object
      description: |
        A configured connector instance. Represents an active or configured
        connection to an external service.
      properties:
        connectorId:
          type: string
          description: Unique instance identifier
          example: "conn_abc123"
        connectorType:
          type: string
          description: Type of connector (from registry)
          example: "google-drive"
        instanceName:
          type: string
          description: User-defined name for this instance
          example: "Company Google Drive"
        scope:
          $ref: '#/components/schemas/ConnectorScope'
        authType:
          $ref: '#/components/schemas/ConnectorAuthType'
        createdBy:
          type: string
          description: User ID who created this instance
        orgId:
          type: string
          description: Organization ID
        isActive:
          type: boolean
          description: Whether connector is enabled for syncing/agent
        isConfigured:
          type: boolean
          description: Whether all required configuration is complete
        isAuthenticated:
          type: boolean
          description: Whether authentication is complete and valid
        syncEnabled:
          type: boolean
          description: Whether sync is enabled
        agentEnabled:
          type: boolean
          description: Whether agent integration is enabled
        lastSyncAt:
          type: string
          format: date-time
          description: Timestamp of last successful sync
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
    ConnectorConfig:
      type: object
      description: Configuration for a connector instance including auth, sync, and filter settings
      properties:
        connectorId:
          type: string
          description: Connector instance ID
        connectorType:
          type: string
          description: Connector type
        instanceName:
          type: string
          description: Instance name
        authType:
          $ref: '#/components/schemas/ConnectorAuthType'
        scope:
          $ref: '#/components/schemas/ConnectorScope'
        config:
          type: object
          description: Configuration sections
          properties:
            auth:
              type: object
              description: Authentication configuration (sensitive data redacted)
            sync:
              type: object
              description: Sync configuration (schedule, options)
            filters:
              type: object
              description: Filter selections for data scope
        baseUrl:
          type: string
          description: Base URL for self-hosted instances
        isActive:
          type: boolean
        isConfigured:
          type: boolean
        isAuthenticated:
          type: boolean
    ConnectorSchema:
      type: object
      description: Schema definition for configuring a connector type
      properties:
        connectorType:
          type: string
        authSchema:
          type: object
          description: JSON Schema for authentication fields
        syncSchema:
          type: object
          description: JSON Schema for sync configuration
        filterSchema:
          type: object
          description: JSON Schema for filter options
        requiredFields:
          type: array
          items:
            type: string
          description: Required field names
    # Sub-schemas for connector configuration
    ConnectorAuthConfig:
      type: object
      description: Authentication configuration for a connector instance
      properties:
        values:
          type: object
          description: Authentication values (keys depend on connector's auth schema)
          additionalProperties: true
          example:
            apiKey: "sk-xxxxx"
            baseUrl: "https://api.example.com"
        oauthConfigId:
          type: string
          description: ID of admin-created OAuth configuration to use
          example: "oauth_config_123"
        customValues:
          type: object
          description: Custom authentication values specific to the connector
          additionalProperties: true
    ConnectorSyncConfig:
      type: object
      description: Synchronization configuration for a connector instance
      properties:
        selectedStrategy:
          type: string
          enum: [MANUAL, SCHEDULED, WEBHOOK, REALTIME]
          description: "Sync strategy: MANUAL (user-triggered), SCHEDULED (interval/cron), WEBHOOK (event-driven), REALTIME (WebSocket)"
          default: MANUAL
        scheduledConfig:
          type: object
          description: Configuration for scheduled sync strategy
          properties:
            intervalMinutes:
              type: integer
              description: Sync interval in minutes
              minimum: 5
              default: 60
              example: 60
            cronExpression:
              type: string
              description: Cron expression for advanced scheduling
              example: "0 */6 * * *"
            timezone:
              type: string
              description: Timezone for scheduled sync
              default: UTC
              example: "America/New_York"
        webhookConfig:
          type: object
          description: Configuration for webhook-based sync
          properties:
            webhookUrl:
              type: string
              description: URL to receive webhook events (auto-generated)
            events:
              type: array
              items:
                type: string
              description: Subscribed event types
              example: ["file.created", "file.modified", "file.deleted"]
        values:
          type: object
          description: Sync setting values specific to the connector
          additionalProperties: true
        customValues:
          type: object
          description: Custom sync values
          additionalProperties: true
    ConnectorFiltersConfig:
      type: object
      description: "Filter configuration to control what data is synced (sync filters and indexing filters)"
      properties:
        sync:
          type: object
          description: Sync filter selections
          properties:
            values:
              type: object
              description: Selected filter values (keys are filter field names)
              additionalProperties: true
              example:
                folders: ["folder_id_1", "folder_id_2"]
                fileTypes: ["pdf", "docx", "xlsx"]
                includeShared: true
        indexing:
          type: object
          description: Indexing filter selections
          properties:
            values:
              type: object
              additionalProperties: true
    CreateConnectorRequest:
      type: object
      description: Request to create a new connector instance
      required:
        - connectorType
        - instanceName
        - scope
      properties:
        connectorType:
          type: string
          description: "Connector type from registry (e.g., google-drive, confluence, slack)"
          example: "google-drive"
        instanceName:
          type: string
          description: Display name for this connector instance
          minLength: 1
          maxLength: 100
          example: "Marketing Team Drive"
        scope:
          $ref: '#/components/schemas/ConnectorScope'
        authType:
          type: string
          description: "Authentication type (required if connector supports multiple auth methods)"
          enum: [OAUTH, OAUTH_ADMIN_CONSENT, API_TOKEN, USERNAME_PASSWORD, SERVICE_ACCOUNT]
          example: "OAUTH"
        config:
          type: object
          description: Initial configuration (can also be set after creation)
          properties:
            auth:
              $ref: '#/components/schemas/ConnectorAuthConfig'
            sync:
              $ref: '#/components/schemas/ConnectorSyncConfig'
            filters:
              $ref: '#/components/schemas/ConnectorFiltersConfig'
        baseUrl:
          type: string
          description: "Base URL for self-hosted instances (e.g., Confluence Server, GitLab Self-Managed)"
          format: uri
          example: "https://confluence.mycompany.com"
    UpdateConnectorConfigRequest:
      type: object
      description: "Request to update connector configuration (partial updates supported)"
      properties:
        auth:
          $ref: '#/components/schemas/ConnectorAuthConfig'
        sync:
          $ref: '#/components/schemas/ConnectorSyncConfig'
        filters:
          $ref: '#/components/schemas/ConnectorFiltersConfig'
        baseUrl:
          type: string
          description: Base URL for self-hosted instances
          format: uri
          example: "https://confluence.mycompany.com"
    UpdateConnectorAuthRequest:
      type: object
      description: "Request to update authentication config (clears OAuth tokens, requires re-auth)"
      required:
        - auth
      properties:
        auth:
          $ref: '#/components/schemas/ConnectorAuthConfig'
        baseUrl:
          type: string
          description: Base URL (if changed with auth update)
          format: uri
    UpdateConnectorFiltersSyncRequest:
      type: object
      description: "Request to update filters and sync config (connector must be authenticated and inactive)"
      properties:
        sync:
          $ref: '#/components/schemas/ConnectorSyncConfig'
        filters:
          $ref: '#/components/schemas/ConnectorFiltersConfig'
        baseUrl:
          type: string
          format: uri
    SaveConnectorFiltersRequest:
      type: object
      description: Request to save filter selections for a connector
      required:
        - filters
      properties:
        filters:
          type: object
          description: "Filter values to save (structure depends on connector's filter schema)"
          additionalProperties: true
          example:
            folders:
              - id: "folder_123"
                name: "Documents"
              - id: "folder_456"
                name: "Reports"
            fileTypes: ["pdf", "docx"]
            modifiedAfter: "2024-01-01"
    UpdateConnectorNameRequest:
      type: object
      description: Request to update connector instance name
      required:
        - instanceName
      properties:
        instanceName:
          type: string
          description: New display name for the connector instance
          minLength: 1
          maxLength: 100
          example: "Sales Team Drive (Updated)"
    ConnectorToggleRequest:
      type: object
      description: Request to toggle connector active status
      required:
        - type
      properties:
        type:
          type: string
          enum: [sync, agent]
          description: "Toggle type: 'sync' for data synchronization, 'agent' for AI agent integration"
    FilterOptions:
      type: object
      description: Available filter options for a connector
      properties:
        filters:
          type: array
          items:
            type: object
            properties:
              key:
                type: string
                description: Filter field key
              label:
                type: string
                description: Display label
              type:
                type: string
                enum: [select, multiselect, text, boolean]
                description: Filter input type
              options:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: string
                    value:
                      type: string
                    label:
                      type: string
              dynamic:
                type: boolean
                description: Whether options are loaded dynamically
    OAuthConfig:
      type: object
      description: |
        OAuth configuration for a connector type. Created by admins to enable
        OAuth authentication for connectors.
      properties:
        configId:
          type: string
          description: Unique configuration ID
        connectorType:
          type: string
          description: Connector type this config applies to
        oauthInstanceName:
          type: string
          description: Name for this OAuth configuration
          example: "Production Google OAuth"
        orgId:
          type: string
        createdBy:
          type: string
        config:
          type: object
          description: OAuth credentials (admin-only view)
          properties:
            clientId:
              type: string
            clientSecret:
              type: string
              description: Redacted for non-admin users
            tenantId:
              type: string
              description: For Microsoft/Azure connectors
        baseUrl:
          type: string
          description: Base URL for self-hosted instances
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
    CreateOAuthConfigRequest:
      type: object
      description: "Request to create OAuth configuration (admin only). Stores credentials that users select when setting up connectors."
      required:
        - oauthInstanceName
        - config
      properties:
        oauthInstanceName:
          type: string
          description: "Display name for this OAuth configuration (e.g., 'Production Google OAuth')"
          minLength: 1
          maxLength: 100
          example: "Production Google OAuth Credentials"
        config:
          type: object
          description: OAuth application credentials
          required:
            - clientId
            - clientSecret
          properties:
            clientId:
              type: string
              description: OAuth client ID from your OAuth application
              example: "123456789-abc.apps.googleusercontent.com"
            clientSecret:
              type: string
              description: OAuth client secret (stored encrypted, never returned in responses)
              example: "GOCSPX-xxxxxxxxxxxxx"
            tenantId:
              type: string
              description: "Azure tenant ID (required only for Microsoft connectors)"
              example: "12345678-1234-1234-1234-123456789abc"
        baseUrl:
          type: string
          description: "Base URL for self-hosted instances (e.g., GitLab Self-Managed)"
          format: uri
          example: "https://gitlab.mycompany.com"
    ConnectorPagination:
      type: object
      description: Pagination information for connector lists
      properties:
        page:
          type: integer
          description: Current page number
        limit:
          type: integer
          description: Items per page
        total:
          type: integer
          description: Total number of items
        hasMore:
          type: boolean
          description: Whether more pages exist
    # ==================== CONFIGURATION MANAGER SCHEMAS ====================
    SMTPConfig:
      type: object
      description: SMTP email server configuration for sending system emails (invitations, notifications, password resets)
      required:
        - host
        - port
        - fromEmail
      properties:
        host:
          type: string
          description: SMTP server hostname or IP address
          example: smtp.gmail.com
        port:
          type: integer
          minimum: 1
          maximum: 65535
          description: SMTP server port. Common ports are 25 (unencrypted), 465 (SSL), 587 (TLS/STARTTLS)
          example: 587
        username:
          type: string
          description: SMTP authentication username. Usually an email address for services like Gmail, SendGrid, etc.
          example: notifications@yourcompany.com
        password:
          type: string
          description: SMTP authentication password or app-specific password. For Gmail, use an App Password instead of your account password.
          example: your-app-password
        fromEmail:
          type: string
          format: email
          description: Default sender email address that appears in the "From" field of outgoing emails
          example: noreply@yourcompany.com
    PlatformSettings:
      type: object
      description: Platform-wide configuration settings for file uploads and feature toggles
      required:
        - fileUploadMaxSizeBytes
        - featureFlags
      properties:
        fileUploadMaxSizeBytes:
          type: integer
          minimum: 1
          maximum: 1073741824
          description: Maximum file upload size in bytes. Default is 30MB (31457280 bytes). Maximum allowed is 1GB.
          example: 31457280
        featureFlags:
          type: object
          additionalProperties:
            type: boolean
          description: |
            Key-value map of feature flags to enable/disable platform features.
            Available flags:
            - ENABLE_BETA_CONNECTORS: Allow usage of beta connector integrations that may be unstable
          example:
            ENABLE_BETA_CONNECTORS: false
        updatedAt:
          type: string
          format: date-time
          description: Timestamp of last settings update (read-only, set automatically)
          readOnly: true
          example: "2024-01-15T10:30:00Z"
    ModelType:
      type: string
      enum: [llm, embedding, ocr, slm, reasoning, multiModal]
      description: Type of AI model
    AIModelProviderConfig:
      type: object
      required:
        - provider
        - configuration
      properties:
        provider:
          type: string
          description: AI provider name
        configuration:
          type: object
          properties:
            model:
              type: string
              description: Model name(s)
            apiKey:
              type: string
              description: API key for the model
            endpoint:
              type: string
              format: uri
              description: Endpoint URL for the model
        isMultimodal:
          type: boolean
          default: false
          description: Whether the model supports multimodal input
        isReasoning:
          type: boolean
          default: false
          description: Whether the model supports reasoning
        isDefault:
          type: boolean
          default: false
          description: Whether this should be the default model
        contextLength:
          type: integer
          nullable: true
          description: Context length for the model
        modelKey:
          type: string
          description: Unique identifier for this model configuration
          readOnly: true
    AIModelsConfig:
      type: object
      properties:
        ocr:
          type: array
          items:
            $ref: '#/components/schemas/AIModelProviderConfig'
        embedding:
          type: array
          items:
            $ref: '#/components/schemas/AIModelProviderConfig'
        slm:
          type: array
          items:
            $ref: '#/components/schemas/AIModelProviderConfig'
        llm:
          type: array
          items:
            $ref: '#/components/schemas/AIModelProviderConfig'
        reasoning:
          type: array
          items:
            $ref: '#/components/schemas/AIModelProviderConfig'
        multiModal:
          type: array
          items:
            $ref: '#/components/schemas/AIModelProviderConfig'
      description: Must have at least one model type configured
    # Authentication Configuration Schemas
    AzureAdAuthConfig:
      type: object
      description: Azure Active Directory authentication configuration
      required:
        - clientId
      properties:
        clientId:
          type: string
          description: Azure AD application client ID
          example: "12345678-1234-1234-1234-123456789abc"
        tenantId:
          type: string
          description: Azure AD tenant ID (use 'common' for multi-tenant)
          default: "common"
          example: "common"
    MicrosoftAuthConfig:
      type: object
      description: Microsoft authentication configuration
      required:
        - clientId
      properties:
        clientId:
          type: string
          description: Microsoft application client ID
          example: "12345678-1234-1234-1234-123456789abc"
        tenantId:
          type: string
          description: Microsoft tenant ID
          default: "common"
    GoogleAuthConfig:
      type: object
      description: Google authentication configuration
      required:
        - clientId
      properties:
        clientId:
          type: string
          description: Google OAuth client ID
          example: "123456789-abc.apps.googleusercontent.com"
    SSOAuthConfig:
      type: object
      description: SAML SSO authentication configuration
      required:
        - entryPoint
        - certificate
        - emailKey
      properties:
        entryPoint:
          type: string
          format: uri
          description: Identity provider SSO URL
          example: "https://idp.example.com/sso/saml"
        certificate:
          type: string
          description: X.509 certificate for signature validation (PEM format)
        emailKey:
          type: string
          description: SAML attribute name for user email
          example: "email"
    GenericOAuthConfig:
      type: object
      description: Generic OAuth 2.0 provider configuration
      required:
        - providerName
        - clientId
      properties:
        providerName:
          type: string
          description: Display name for the OAuth provider
          example: "Custom OAuth Provider"
        clientId:
          type: string
          description: OAuth client ID
        clientSecret:
          type: string
          description: OAuth client secret
        authorizationUrl:
          type: string
          format: uri
          description: Authorization endpoint URL
        tokenEndpoint:
          type: string
          format: uri
          description: Token endpoint URL
        userInfoEndpoint:
          type: string
          format: uri
          description: User info endpoint URL
        scope:
          type: string
          description: OAuth scopes to request
          example: "openid profile email"
        redirectUri:
          type: string
          format: uri
          description: OAuth redirect URI
    # Connector Configuration Schemas
    GoogleWorkspaceCredentials:
      type: object
      description: Google Workspace service account or OAuth credentials
      properties:
        userType:
          type: string
          enum: [individual, business]
          description: "Type of credentials: 'individual' for OAuth, 'business' for service account"
        credentials:
          type: object
          description: Credential data (structure depends on userType)
    GoogleWorkspaceOAuthConfig:
      type: object
      description: Google Workspace OAuth configuration for connectors
      required:
        - clientId
        - clientSecret
      properties:
        clientId:
          type: string
          description: Google OAuth client ID
        clientSecret:
          type: string
          description: Google OAuth client secret
        enableRealTimeUpdates:
          type: boolean
          description: Enable Google Pub/Sub for real-time updates
          default: false
        topicName:
          type: string
          description: Google Pub/Sub topic name (required if enableRealTimeUpdates is true)
    AtlassianConfig:
      type: object
      description: Atlassian (Confluence/Jira) OAuth configuration
      required:
        - clientId
        - clientSecret
      properties:
        clientId:
          type: string
          description: Atlassian OAuth client ID
        clientSecret:
          type: string
          description: Atlassian OAuth client secret
    OneDriveConfig:
      type: object
      description: OneDrive/Microsoft 365 connector configuration
      required:
        - clientId
        - clientSecret
        - tenantId
      properties:
        clientId:
          type: string
          description: Microsoft application client ID
        clientSecret:
          type: string
          description: Microsoft application client secret
        tenantId:
          type: string
          description: Microsoft/Azure tenant ID
        hasAdminConsent:
          type: boolean
          description: Whether admin consent has been granted
          default: false
    SharePointConfig:
      type: object
      description: SharePoint connector configuration
      required:
        - clientId
        - clientSecret
        - tenantId
        - sharepointDomain
      properties:
        clientId:
          type: string
          description: Microsoft application client ID
        clientSecret:
          type: string
          description: Microsoft application client secret
        tenantId:
          type: string
          description: Microsoft/Azure tenant ID
        sharepointDomain:
          type: string
          description: SharePoint domain (e.g., 'mycompany.sharepoint.com')
        hasAdminConsent:
          type: boolean
          description: Whether admin consent has been granted
          default: false
    # URL Configuration Schemas
    URLConfig:
      type: object
      description: URL configuration for frontend or connector
      required:
        - url
      properties:
        url:
          type: string
          format: uri
          description: Public URL
          example: "https://app.example.com"
    # Metrics Collection Schemas
    MetricsCollectionConfig:
      type: object
      description: |
        Configuration for application telemetry and metrics collection.
        Metrics are collected anonymously and pushed to a remote server for analytics.
      properties:
        enableMetricCollection:
          type: boolean
          description: |
            Master switch for metrics collection. When disabled, no metrics are collected or pushed.
            Default: true
          example: true
        pushIntervalMs:
          type: integer
          description: |
            Interval in milliseconds between metrics pushes to the remote server.
            Minimum: 1000ms (1 second), Default: 60000ms (1 minute)
          minimum: 1000
          default: 60000
          example: 60000
        serverUrl:
          type: string
          format: uri
          description: |
            URL of the metrics collection server. For self-hosted analytics, point this
            to your own Prometheus-compatible endpoint.
          example: "https://metrics-collector.example.com/collect-metrics"
        apiKey:
          type: string
          description: |
            API key for authenticating with the metrics server. Auto-generated if not provided.
          example: "54523f794e23d96e"
        instanceId:
          type: string
          description: |
            Unique identifier for this PipesHub instance. Auto-generated based on hostname.
          example: "638bc1b45c03e03d"
        appVersion:
          type: string
          description: Current application version for metrics tagging.
          example: "1.0.0"
      example:
        enableMetricCollection: true
        pushIntervalMs: 60000
        serverUrl: "https://metrics-collector.example.com/collect-metrics"
        apiKey: "54523f794e23d96e"
        instanceId: "638bc1b45c03e03d"
        appVersion: "1.0.0"
    # Feature Flags Schema
    FeatureFlag:
      type: object
      description: Platform feature flag definition
      properties:
        key:
          type: string
          description: Unique feature flag key
          example: "ENABLE_BETA_CONNECTORS"
        label:
          type: string
          description: Display label
          example: "Enable Beta Connectors"
        description:
          type: string
          description: Feature flag description
        defaultEnabled:
          type: boolean
          description: Default enabled state
    # Custom System Prompt Schema
    CustomSystemPrompt:
      type: object
      description: Custom system prompt configuration
      properties:
        customSystemPrompt:
          type: string
          description: Custom system prompt text for AI models
    # AI Model Provider Management Schemas
    AddAIModelProviderRequest:
      type: object
      description: Request to add a new AI model provider
      required:
        - modelType
        - provider
        - configuration
      properties:
        modelType:
          $ref: '#/components/schemas/ModelType'
        provider:
          type: string
          description: Provider name (e.g., openai, anthropic, azure-openai, aws-bedrock)
          example: "openai"
        configuration:
          type: object
          description: Provider-specific configuration
          properties:
            model:
              type: string
              description: Model name/identifier
              example: "gpt-4"
            apiKey:
              type: string
              description: API key for the provider
            endpoint:
              type: string
              format: uri
              description: Custom endpoint URL (for Azure, self-hosted)
            organizationId:
              type: string
              description: Organization ID (OpenAI)
            deploymentName:
              type: string
              description: Deployment name (Azure OpenAI)
            awsAccessKeyId:
              type: string
              description: AWS access key (Bedrock)
            awsAccessSecretKey:
              type: string
              description: AWS secret key (Bedrock)
            region:
              type: string
              description: AWS region (Bedrock)
        isMultimodal:
          type: boolean
          description: Whether the model supports multimodal inputs
          default: false
        isReasoning:
          type: boolean
          description: Whether this is a reasoning model
          default: false
        isDefault:
          type: boolean
          description: Set as default model for this type
          default: false
        contextLength:
          type: integer
          description: Maximum context length (tokens)
          nullable: true
    UpdateAIModelProviderRequest:
      type: object
      description: Request to update an existing AI model provider
      required:
        - provider
        - configuration
      properties:
        provider:
          type: string
          description: Provider name
        configuration:
          type: object
          description: Updated provider configuration
        isMultimodal:
          type: boolean
        isReasoning:
          type: boolean
        isDefault:
          type: boolean
        contextLength:
          type: integer
          nullable: true
    AIModelProviderResponse:
      type: object
      description: Response containing AI model provider details
      properties:
        status:
          type: string
          enum: [success, error]
        message:
          type: string
        data:
          $ref: '#/components/schemas/AIModelProviderConfig'
    # ==================== CRAWLING MANAGER SCHEMAS ====================
    CrawlingScheduleType:
      type: string
      enum: [hourly, daily, weekly, monthly, custom, once]
      description: |
        Type of crawling schedule that determines how often the connector data is synced.<br>
        <ul>
        <li><b>hourly</b>: Run at specified minute every X hours</li>
        <li><b>daily</b>: Run once per day at specified hour and minute</li>
        <li><b>weekly</b>: Run on specified days of the week at specified time</li>
        <li><b>monthly</b>: Run on specified day of month at specified time</li>
        <li><b>custom</b>: Use cron expression for complex schedules</li>
        <li><b>once</b>: Run once at a specific future datetime</li>
        </ul>
    # Base schedule configuration (common fields)
    BaseScheduleConfig:
      type: object
      description: Base configuration fields common to all schedule types
      properties:
        scheduleType:
          $ref: '#/components/schemas/CrawlingScheduleType'
        isEnabled:
          type: boolean
          default: true
          description: Whether the schedule is active. Disabled schedules won't create new jobs.
        timezone:
          type: string
          default: "UTC"
          description: IANA timezone identifier (e.g., "America/New_York", "Europe/London", "Asia/Tokyo")
          example: "UTC"
      required:
        - scheduleType
    # Hourly schedule configuration
    HourlyScheduleConfig:
      allOf:
        - $ref: '#/components/schemas/BaseScheduleConfig'
        - type: object
          description: Run crawling job every X hours at a specified minute
          properties:
            scheduleType:
              type: string
              enum: [hourly]
            minute:
              type: integer
              minimum: 0
              maximum: 59
              description: Minute of the hour to run (0-59)
              example: 30
            interval:
              type: integer
              minimum: 1
              maximum: 24
              default: 1
              description: Run every X hours (1 = every hour, 2 = every 2 hours, etc.)
              example: 1
          required:
            - minute
    # Daily schedule configuration
    DailyScheduleConfig:
      allOf:
        - $ref: '#/components/schemas/BaseScheduleConfig'
        - type: object
          description: Run crawling job once per day at a specified time
          properties:
            scheduleType:
              type: string
              enum: [daily]
            hour:
              type: integer
              minimum: 0
              maximum: 23
              description: Hour of the day to run (0-23, 24-hour format)
              example: 2
            minute:
              type: integer
              minimum: 0
              maximum: 59
              description: Minute of the hour to run (0-59)
              example: 0
          required:
            - hour
            - minute
    # Weekly schedule configuration
    WeeklyScheduleConfig:
      allOf:
        - $ref: '#/components/schemas/BaseScheduleConfig'
        - type: object
          description: Run crawling job on specified days of the week
          properties:
            scheduleType:
              type: string
              enum: [weekly]
            daysOfWeek:
              type: array
              items:
                type: integer
                minimum: 0
                maximum: 6
              minItems: 1
              description: |
                Days of the week to run (0=Sunday, 1=Monday, ..., 6=Saturday).<br>
                Example: [1, 3, 5] runs on Monday, Wednesday, Friday
              example: [1, 3, 5]
            hour:
              type: integer
              minimum: 0
              maximum: 23
              description: Hour of the day to run (0-23)
              example: 3
            minute:
              type: integer
              minimum: 0
              maximum: 59
              description: Minute of the hour to run (0-59)
              example: 0
          required:
            - daysOfWeek
            - hour
            - minute
    # Monthly schedule configuration
    MonthlyScheduleConfig:
      allOf:
        - $ref: '#/components/schemas/BaseScheduleConfig'
        - type: object
          description: Run crawling job on a specified day of each month
          properties:
            scheduleType:
              type: string
              enum: [monthly]
            dayOfMonth:
              type: integer
              minimum: 1
              maximum: 31
              description: Day of the month to run (1-31). If day doesn't exist in month, job runs on last day.
              example: 1
            hour:
              type: integer
              minimum: 0
              maximum: 23
              description: Hour of the day to run (0-23)
              example: 4
            minute:
              type: integer
              minimum: 0
              maximum: 59
              description: Minute of the hour to run (0-59)
              example: 0
          required:
            - dayOfMonth
            - hour
            - minute
    # Custom (cron) schedule configuration
    CustomScheduleConfig:
      allOf:
        - $ref: '#/components/schemas/BaseScheduleConfig'
        - type: object
          description: Run crawling job using a custom cron expression for complex schedules
          properties:
            scheduleType:
              type: string
              enum: [custom]
            cronExpression:
              type: string
              pattern: "^(\\S+\\s+){4}\\S+$"
              description: |
                Standard 5-field cron expression: minute hour day-of-month month day-of-week.<br>
                Examples:<br>
                <ul>
                <li><code>0 2 * * *</code> - Every day at 2:00 AM</li>
                <li><code>30 */4 * * *</code> - Every 4 hours at minute 30</li>
                <li><code>0 9 * * 1-5</code> - Weekdays at 9:00 AM</li>
                <li><code>0 0 1,15 * *</code> - 1st and 15th of each month at midnight</li>
                </ul>
              example: "0 2 * * *"
            description:
              type: string
              description: Human-readable description of the cron schedule
              example: "Run daily at 2:00 AM"
          required:
            - cronExpression
    # One-time schedule configuration
    OnceScheduleConfig:
      allOf:
        - $ref: '#/components/schemas/BaseScheduleConfig'
        - type: object
          description: Run crawling job once at a specific future datetime
          properties:
            scheduleType:
              type: string
              enum: [once]
            scheduledTime:
              type: string
              format: date-time
              description: ISO 8601 datetime when the job should run. Must be in the future.
              example: "2024-12-25T10:00:00Z"
          required:
            - scheduledTime
    # Unified ScheduleConfig using oneOf for discriminated union
    ScheduleConfig:
      description: |
        Schedule configuration for crawling jobs. The structure varies based on <code>scheduleType</code>.<br><br>
        <b>Schedule Type Configurations:</b><br>
        <ul>
        <li><b>hourly:</b> <code>minute</code>, <code>interval</code> (optional)</li>
        <li><b>daily:</b> <code>hour</code>, <code>minute</code></li>
        <li><b>weekly:</b> <code>daysOfWeek</code>, <code>hour</code>, <code>minute</code></li>
        <li><b>monthly:</b> <code>dayOfMonth</code>, <code>hour</code>, <code>minute</code></li>
        <li><b>custom:</b> <code>cronExpression</code>, <code>description</code> (optional)</li>
        <li><b>once:</b> <code>scheduledTime</code></li>
        </ul>
      oneOf:
        - $ref: '#/components/schemas/HourlyScheduleConfig'
        - $ref: '#/components/schemas/DailyScheduleConfig'
        - $ref: '#/components/schemas/WeeklyScheduleConfig'
        - $ref: '#/components/schemas/MonthlyScheduleConfig'
        - $ref: '#/components/schemas/CustomScheduleConfig'
        - $ref: '#/components/schemas/OnceScheduleConfig'
      discriminator:
        propertyName: scheduleType
        mapping:
          hourly: '#/components/schemas/HourlyScheduleConfig'
          daily: '#/components/schemas/DailyScheduleConfig'
          weekly: '#/components/schemas/WeeklyScheduleConfig'
          monthly: '#/components/schemas/MonthlyScheduleConfig'
          custom: '#/components/schemas/CustomScheduleConfig'
          once: '#/components/schemas/OnceScheduleConfig'
    # Crawling Job Data (stored with each job)
    CrawlingJobData:
      type: object
      description: Data payload stored with each crawling job in the queue
      properties:
        connector:
          type: string
          description: Connector type identifier (e.g., "drive", "onedrive", "slack")
          example: "drive"
        connectorId:
          type: string
          description: Unique identifier of the connector instance
          example: "507f1f77bcf86cd799439011"
        scheduleConfig:
          $ref: '#/components/schemas/ScheduleConfig'
        orgId:
          type: string
          description: Organization ID that owns this crawling job
          example: "507f1f77bcf86cd799439012"
        userId:
          type: string
          description: User ID who created/scheduled this job
          example: "507f1f77bcf86cd799439013"
        timestamp:
          type: string
          format: date-time
          description: When the job was created/scheduled
        metadata:
          type: object
          additionalProperties: true
          description: Optional additional metadata for the job
      required:
        - connector
        - connectorId
        - scheduleConfig
        - orgId
        - userId
        - timestamp
    # Job Status (returned by status endpoints)
    JobStatus:
      type: object
      description: Complete status information for a crawling job
      properties:
        id:
          type: string
          nullable: true
          description: Unique job ID assigned by BullMQ
          example: "crawl-drive-507f1f77bcf86cd799439011-507f1f77bcf86cd799439012"
        name:
          type: string
          description: Job name (format crawl-{connector}-{connectorId})
          example: "crawl-drive-507f1f77bcf86cd799439011"
        data:
          $ref: '#/components/schemas/CrawlingJobData'
        progress:
          description: Job progress information (can be number 0-100 or object with percentage/current/total)
          oneOf:
            - type: number
              minimum: 0
              maximum: 100
              description: Progress percentage (0-100)
            - type: object
              description: Detailed progress object
              properties:
                percentage:
                  type: number
                  minimum: 0
                  maximum: 100
                current:
                  type: integer
                  description: Current items processed
                total:
                  type: integer
                  description: Total items to process
        delay:
          type: integer
          nullable: true
          description: Delay in milliseconds before job starts (for delayed/scheduled jobs)
          example: 3600000
        timestamp:
          type: integer
          description: Unix timestamp when job was created (milliseconds)
          example: 1703520000000
        attemptsMade:
          type: integer
          description: Number of execution attempts made (increments on retry)
          example: 0
        finishedOn:
          type: integer
          nullable: true
          description: Unix timestamp when job completed (null if not finished)
        processedOn:
          type: integer
          nullable: true
          description: Unix timestamp when job started processing (null if not started)
        failedReason:
          type: string
          nullable: true
          description: Error message if job failed
          example: null
        state:
          type: string
          enum: [waiting, active, completed, failed, delayed, paused, stuck]
          description: |
            Current state of the job in the queue:<br>
            <ul>
            <li><b>waiting</b>: Queued and waiting to be processed</li>
            <li><b>active</b>: Currently being processed by a worker</li>
            <li><b>completed</b>: Successfully finished</li>
            <li><b>failed</b>: Failed after all retry attempts</li>
            <li><b>delayed</b>: Scheduled to run at a future time</li>
            <li><b>paused</b>: Manually paused by user</li>
            <li><b>stuck</b>: Job is stuck (worker crashed mid-processing)</li>
            </ul>
          example: "waiting"
      required:
        - name
        - data
        - timestamp
        - attemptsMade
        - state
    # Queue Statistics
    QueueStats:
      type: object
      description: Aggregate statistics for the crawling job queue
      properties:
        waiting:
          type: integer
          description: Number of jobs waiting to be processed
          example: 5
        active:
          type: integer
          description: Number of jobs currently being processed
          example: 2
        completed:
          type: integer
          description: Number of successfully completed jobs (limited to recent)
          example: 150
        failed:
          type: integer
          description: Number of failed jobs (limited to recent)
          example: 3
        delayed:
          type: integer
          description: Number of jobs scheduled for future execution
          example: 10
        paused:
          type: integer
          description: Number of manually paused jobs
          example: 1
        repeatable:
          type: integer
          description: Number of repeatable job configurations (recurring schedules)
          example: 8
        total:
          type: integer
          description: Total count of all jobs across all states
          example: 171
      required:
        - waiting
        - active
        - completed
        - failed
        - delayed
        - paused
        - repeatable
        - total
    # ==================== MAIL SERVICE SCHEMAS ====================
    MailBody:
      type: object
      description: |
        Request body for sending transactional emails via pre-defined templates.

        **Template-specific templateData requirements:**

        | Template | Required Fields | Description |
        |----------|----------------|-------------|
        | `loginWithOTP` | `name`, `otp` | User's name and 6-digit OTP code |
        | `resetPassword` | `name`, `link` | User's name and password reset URL |
        | `accountCreation` | `orgName`, `link` | Organization name and login URL |
        | `appuserInvite` | `invitee`, `orgName`, `link` | Inviter name, org name, and invitation URL |
        | `suspiciousLoginAttempt` | `link` | Support contact URL |

        **Note:** The actual "From" address is taken from the SMTP configuration, not from `fromEmailDomain`.
        The `fromEmailDomain` field is stored for audit purposes only.
      properties:
        productName:
          type: string
          description: Name of the product sending the email (used in templates for branding)
          example: "PipesHub"
        emailTemplateType:
          type: string
          enum: [loginWithOTP, resetPassword, accountCreation, appuserInvite, suspiciousLoginAttempt]
          description: |
            Type of email template to use. Each template has specific `templateData` requirements:
            - `loginWithOTP`: OTP authentication email
            - `resetPassword`: Password reset link email
            - `accountCreation`: Welcome email for new organizations
            - `appuserInvite`: Invitation email to join an organization
            - `suspiciousLoginAttempt`: Security alert for multiple failed OTP attempts
          example: "loginWithOTP"
        isAutoEmail:
          type: boolean
          description: Flag indicating if this is an automated system email (for tracking/filtering purposes)
          default: false
        fromEmailDomain:
          type: string
          format: email
          description: |
            Sender email address for audit logging. **Note:** The actual "From" address used
            in the email is taken from the SMTP server configuration (`smtpConfig.fromEmail`),
            not this field. This field is stored in the database for record-keeping.
          example: "noreply@company.com"
        sendEmailTo:
          type: array
          items:
            type: string
            format: email
          minItems: 1
          description: List of recipient email addresses (at least one required)
          example: ["user@example.com"]
        subject:
          type: string
          description: Email subject line
          example: "Your OTP Code for PipesHub"
        templateData:
          description: |
            Dynamic data to populate the email template. Required fields depend on <code>emailTemplateType</code>.<br><br>
            <b>Template Data Requirements:</b><br>
            <ul>
            <li><b>loginWithOTP:</b> See <code>LoginWithOTPTemplateData</code> - requires <code>name</code>, <code>otp</code></li>
            <li><b>resetPassword:</b> See <code>ResetPasswordTemplateData</code> - requires <code>name</code>, <code>link</code></li>
            <li><b>accountCreation:</b> See <code>AccountCreationTemplateData</code> - requires <code>orgName</code>, <code>link</code></li>
            <li><b>appuserInvite:</b> See <code>AppUserInviteTemplateData</code> - requires <code>invitee</code>, <code>orgName</code>, <code>link</code></li>
            <li><b>suspiciousLoginAttempt:</b> See <code>SuspiciousLoginTemplateData</code> - requires <code>link</code></li>
            </ul>
          oneOf:
            - $ref: '#/components/schemas/LoginWithOTPTemplateData'
            - $ref: '#/components/schemas/ResetPasswordTemplateData'
            - $ref: '#/components/schemas/AccountCreationTemplateData'
            - $ref: '#/components/schemas/AppUserInviteTemplateData'
            - $ref: '#/components/schemas/SuspiciousLoginTemplateData'
        sendCcTo:
          type: array
          items:
            type: string
            format: email
          description: Optional list of CC recipient email addresses
          example: ["manager@example.com"]
        attachments:
          type: array
          items:
            type: object
            properties:
              filename:
                type: string
                description: Name of the attachment file
                example: "report.pdf"
              content:
                type: string
                description: Base64-encoded file content or raw string content
              contentType:
                type: string
                description: MIME type of the attachment
                example: "application/pdf"
          description: Optional email attachments (uses nodemailer attachment format)
      required:
        - emailTemplateType
        - sendEmailTo
    # Template Data Schemas for each email template type
    LoginWithOTPTemplateData:
      type: object
      description: Template data for OTP login email
      additionalProperties: false
      properties:
        name:
          type: string
          description: User's display name shown in the email greeting
          example: "John Doe"
        otp:
          type: string
          description: 6-digit one-time password code
          pattern: "^[0-9]{6}$"
          example: "123456"
      required:
        - name
        - otp
    ResetPasswordTemplateData:
      type: object
      description: Template data for password reset email
      additionalProperties: false
      properties:
        name:
          type: string
          description: User's display name shown in the email greeting
          example: "John Doe"
        link:
          type: string
          format: uri
          description: Password reset URL with secure token
          example: "https://app.pipeshub.com/reset-password?token=abc123xyz"
      required:
        - name
        - link
    AccountCreationTemplateData:
      type: object
      description: Template data for organization account creation welcome email
      additionalProperties: false
      properties:
        orgName:
          type: string
          description: Name of the newly created organization
          example: "Acme Corporation"
        link:
          type: string
          format: uri
          description: Login URL for the platform
          example: "https://app.pipeshub.com/login"
      required:
        - orgName
        - link
    AppUserInviteTemplateData:
      type: object
      description: Template data for user invitation email
      additionalProperties: false
      properties:
        invitee:
          type: string
          description: Name of the person who sent the invitation
          example: "Admin User"
        orgName:
          type: string
          description: Name of the organization the user is being invited to
          example: "Acme Corporation"
        link:
          type: string
          format: uri
          description: Invitation acceptance URL with secure token
          example: "https://app.pipeshub.com/invite?token=invite123abc"
      required:
        - invitee
        - orgName
        - link
    SuspiciousLoginTemplateData:
      type: object
      description: Template data for suspicious login attempt security alert email
      additionalProperties: false
      properties:
        link:
          type: string
          format: uri
          description: Support contact URL for reporting unauthorized access
          example: "https://app.pipeshub.com/support"
      required:
        - link
    # ==================== PAGINATION ====================
    PaginationInfo:
      type: object
      properties:
        page:
          type: integer
          description: Current page number
        limit:
          type: integer
          description: Items per page
        totalCount:
          type: integer
          description: Total number of items
        totalPages:
          type: integer
          description: Total number of pages
security:
  - bearerAuth: []
paths:
  # ==================== AUTHENTICATION ENDPOINTS ====================
  /userAccount/initAuth:
    post:
      tags:
        - User Account
      summary: Initialize authentication session
      description: |
        Initialize an authentication session for a user by email address.
        This is the first step in the multi-step authentication flow.
        <br><br>
        <b>Flow:</b><br>
        1. Call this endpoint with the user's email<br>
        2. Receive a session token in the <code>x-session-token</code> response header<br>
        3. Use the session token in subsequent <code>/authenticate</code> calls<br>
        4. The response includes <code>allowedMethods</code> for the first authentication step
        <br><br>
        <b>Session Token:</b><br>
        - Stored in response header <code>x-session-token</code><br>
        - Required for all subsequent authentication requests<br>
        - Expires after a configured timeout period
        <br><br>
        <b>Multi-Factor Authentication:</b><br>
        If the organization has MFA configured, you'll need to complete multiple
        authentication steps. Each step completion returns the next step's allowed methods.
      operationId: initAuth
      security: []
      requestBody:
        description: "Request payload"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/InitAuthRequest'
        required: true
      responses:
        '200':
          description: Authentication session initialized successfully
          headers:
            x-session-token:
              schema:
                type: string
              description: Session token for subsequent authentication requests. Store this securely.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InitAuthResponse'
        '400':
          description: Invalid request (malformed email or missing fields)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthError'
        '403':
          description: Account is blocked due to too many failed login attempts
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthError'
        '404':
          description: User or organization configuration not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthError'
      x-speakeasy-group: userAccount
      x-speakeasy-name-override: initializeAuth
  /userAccount/authenticate:
    post:
      tags:
        - User Account
      summary: Authenticate user with credentials
      description: |
        Authenticate a user using the specified method and credentials.
        Requires a valid session token from <code>/initAuth</code>.
        <br><br>
        <b>Credential Formats by Method:</b><br>
        - <code>password</code>: <code>{ "credentials": { "password": "your-password" } }</code><br>
        - <code>otp</code>: <code>{ "credentials": { "otp": "123456" } }</code> (6-digit code, valid for 10 minutes)<br>
        - <code>google</code>: <code>{ "credentials": "google-id-token-string" }</code><br>
        - <code>microsoft</code>: <code>{ "credentials": { "accessToken": "...", "idToken": "..." } }</code><br>
        - <code>azureAd</code>: <code>{ "credentials": { "accessToken": "...", "idToken": "..." } }</code><br>
        - <code>oauth</code>: <code>{ "credentials": { "accessToken": "...", "idToken": "..." } }</code><br>
        - <code>samlSso</code>: Handled via redirect flow (use <code>/saml/signIn</code> instead)
        <br><br>
        <b>Multi-Step Response:</b><br>
        If organization uses MFA, successful authentication returns:<br>
        - <code>status: "success"</code> with <code>nextStep</code> and <code>allowedMethods</code> for next step
        <br><br>
        <b>Fully Authenticated Response:</b><br>
        After completing all steps:<br>
        - <code>message: "Fully authenticated"</code> with <code>accessToken</code> (1hr) and <code>refreshToken</code> (7d)
        <br><br>
        <b>Security:</b><br>
        - Account locks after 5 consecutive failed attempts<br>
        - CAPTCHA may be required if enabled (pass <code>cf-turnstile-response</code>)
      operationId: authenticate
      security: []
      parameters:
        - name: x-session-token
          in: header
          required: true
          description: Session token received from `/initAuth` endpoint
          schema:
            type: string
      requestBody:
        description: "Request payload"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthenticateRequest'
        required: true
      responses:
        '200':
          description: Authentication step successful or fully authenticated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthenticateResponse'
        '400':
          description: Invalid request, method not allowed, or invalid credential format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthError'
        '401':
          description: Invalid credentials (wrong password, expired OTP, etc.)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthError'
        '403':
          description: Account blocked due to too many failed attempts (5 attempts max)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthError'
        '404':
          description: Session expired or user not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthError'
        '410':
          description: OTP has expired (valid for 10 minutes)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthError'
      x-speakeasy-group: userAccount
  /userAccount/login/otp/generate:
    post:
      tags:
        - User Account
      summary: Generate and send OTP for login
      description: |
        Generate and send a 6-digit one-time password (OTP) to the user's email.
        Use this endpoint before authenticating with the <code>otp</code> method.
        <br><br>
        <b>OTP Details:</b><br>
        - 6 digits numeric code<br>
        - Valid for <b>10 minutes</b> after generation<br>
        - Sent to user's registered email address
        <br><br>
        <b>Rate Limiting:</b><br>
        - Multiple OTP requests may be rate-limited<br>
        - Wait for the current OTP to expire before requesting a new one
        <br><br>
        <b>CAPTCHA:</b><br>
        If Cloudflare Turnstile is enabled, include <code>cf-turnstile-response</code> in the request body.
      operationId: generateLoginOtp
      security: []
      requestBody:
        description: "Request payload"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OtpGenerateRequest'
        required: true
      responses:
        '200':
          description: OTP generated and sent successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "OTP sent to your email"
        '400':
          description: Invalid request or malformed email
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthError'
        '403':
          description: Account is blocked due to too many failed attempts
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthError'
        '404':
          description: User not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthError'
        '429':
          description: Too many OTP requests - please wait before requesting again
      x-speakeasy-group: userAccount
  /userAccount/password/reset:
    post:
      tags:
        - User Account
      summary: Reset password (authenticated user)
      description: |
        Reset password for an authenticated user. Requires the current password for verification.
        <br><br>
        <b>Password Requirements:</b><br>
        - Minimum 8 characters<br>
        - At least 1 uppercase letter (A-Z)<br>
        - At least 1 lowercase letter (a-z)<br>
        - At least 1 number (0-9)<br>
        - At least 1 special character (#?!@$%^&*-)
        <br><br>
        <b>Security Notes:</b><br>
        - A new access token is returned (old tokens are invalidated)<br>
        - CAPTCHA may be required if enabled (pass <code>cf-turnstile-response</code>)
      operationId: resetPassword
      security:
        - bearerAuth: []
      requestBody:
        description: "Request payload"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PasswordResetRequest'
        required: true
      responses:
        '200':
          description: Password reset successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasswordResetResponse'
        '400':
          description: Invalid request or password doesn't meet requirements
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthError'
        '401':
          description: Current password is incorrect
        '404':
          description: User credentials not found
      x-speakeasy-group: userAccount
  /userAccount/password/forgot:
    post:
      tags:
        - User Account
      summary: Request password reset email
      description: |
        Send a password reset link to the user's email.
        The link contains a time-limited token that can be used to reset the password.
        <br><br>
        <b>Note:</b> This endpoint always returns 200 even if the email doesn't exist (to prevent email enumeration).
      operationId: forgotPassword
      security: []
      requestBody:
        description: "Request body for Request password reset email"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ForgotPasswordRequest'
        required: true
      responses:
        '200':
          description: Password reset email sent successfully (or email not found - same response for security)
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Password reset email sent"
        '400':
          description: Invalid request
        '429':
          description: Too many requests - rate limited
      x-speakeasy-group: userAccount
  /userAccount/password/reset/token:
    post:
      tags:
        - User Account
      summary: Reset password with email token
      description: |
        Reset password using a token received via email from the forgot password flow.
        <br><br>
        <b>Password Requirements:</b><br>
        - Minimum 8 characters<br>
        - At least 1 uppercase letter<br>
        - At least 1 lowercase letter<br>
        - At least 1 number<br>
        - At least 1 special character (#?!@$%^&*-)
        <br><br>
        <b>Security Notes:</b><br>
        - Token is single-use and expires after a set time<br>
        - A new access token is returned upon successful reset
      operationId: resetPasswordWithToken
      security:
        - scopedToken: []
      requestBody:
        description: "Request payload"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TokenPasswordResetRequest'
        required: true
      responses:
        '200':
          description: Password reset successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PasswordResetResponse'
        '400':
          description: Invalid request or password doesn't meet requirements
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthError'
        '401':
          description: Invalid or expired token
        '404':
          description: User not found
      x-speakeasy-group: userAccount
  /userAccount/internal/password/check:
    get:
      tags:
        - User Account
      summary: Check if user has password set (Internal)
      description: |
        Internal endpoint to check if a user has a password configured.
        Used by other services to determine authentication capabilities.
        <br><br>
        <b>Note:</b> This is an internal service-to-service endpoint.
      operationId: checkPasswordStatus
      security:
        - scopedToken: []
      responses:
        '200':
          description: Password status retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  hasPassword:
                    type: boolean
                    description: Whether the user has a password set
        '401':
          description: Unauthorized - invalid scoped token
        '404':
          description: User not found
      x-speakeasy-group: userAccount
  /userAccount/oauth/exchange:
    post:
      tags:
        - OAuth
      summary: Exchange OAuth authorization code for tokens
      description: |
        Exchange an OAuth authorization code for access and ID tokens.
        Used after the OAuth authorization flow redirects back to the application.
        <br><br>
        <b>Supported Providers:</b><br>
        - Generic OAuth 2.0 providers configured in org settings
        <br><br>
        <b>Flow:</b><br>
        1. User is redirected to OAuth provider's authorization URL<br>
        2. User authorizes and is redirected back with a code<br>
        3. This endpoint exchanges the code for tokens<br>
        4. Tokens can then be used with the <code>/userAccount/authenticate</code> endpoint
      operationId: exchangeOAuthCode
      security: []
      requestBody:
        description: "Request payload"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OAuthExchangeRequest'
        required: true
      responses:
        '200':
          description: Tokens retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OAuthExchangeResponse'
        '400':
          description: Invalid request or authorization code
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthError'
        '401':
          description: OAuth token exchange failed
        '404':
          description: OAuth provider configuration not found
      x-speakeasy-group: oauth
      x-speakeasy-name-override: exchangeCode
  # ==================== OAUTH PROVIDER ENDPOINTS ====================
  /oauth/authorize:
    get:
      tags:
        - OAuth Provider
      summary: Initiate OAuth authorization flow
      description: |
        OAuth 2.0 Authorization Endpoint (RFC 6749 Section 4.1.1).
        <br><br>
        Initiates the authorization code flow. Users are redirected here by OAuth clients
        to authorize access to their account.
        <br><br>
        <b>Flow:</b><br>
        1. Client redirects user to this endpoint with required parameters<br>
        2. If not logged in, user is redirected to PipesHub login<br>
        3. User sees consent page with requested scopes<br>
        4. User grants or denies consent<br>
        5. User is redirected back to client with authorization code
        <br><br>
        <b>PKCE Support (RFC 7636):</b><br>
        - Required for public clients (SPA, mobile apps)<br>
        - Recommended for confidential clients<br>
        - Use S256 method (SHA256 hash of code_verifier)
        <br><br>
        <b>Security:</b><br>
        - Always use HTTPS in production<br>
        - State parameter provides CSRF protection<br>
        - Redirect URI must match registered URIs exactly
      operationId: oauthAuthorize
      security: []
      parameters:
        - name: response_type
          in: query
          required: true
          schema:
            type: string
            enum: [code]
          description: Must be "code" for authorization code grant
        - name: client_id
          in: query
          required: true
          schema:
            type: string
          description: OAuth app client ID
        - name: redirect_uri
          in: query
          required: true
          schema:
            type: string
            format: uri
          description: Callback URI (must match registered URI)
        - name: scope
          in: query
          required: true
          schema:
            type: string
          description: Space-separated list of requested scopes
          example: "openid profile email read:records"
        - name: state
          in: query
          required: true
          schema:
            type: string
          description: Random string for CSRF protection
        - name: code_challenge
          in: query
          required: false
          schema:
            type: string
          description: PKCE code challenge (base64url-encoded)
        - name: code_challenge_method
          in: query
          required: false
          schema:
            type: string
            enum: [S256, plain]
          description: PKCE method (S256 recommended)
        - name: nonce
          in: query
          required: false
          schema:
            type: string
          description: Nonce for ID token binding
      responses:
        '302':
          description: |
            Redirects to either:
            - Login page (if user not authenticated)
            - Consent page (if user authenticated)
            - Redirect URI with code (if consent already granted)
            - Redirect URI with error (if request invalid)
          headers:
            Location:
              schema:
                type: string
              description: Redirect URL
        '400':
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OAuthErrorResponse'
      x-speakeasy-group: oauthProvider
      x-speakeasy-name-override: authorize
    post:
      tags:
        - OAuth Provider
      summary: Submit authorization consent
      description: |
        Submit user's consent decision for OAuth authorization.
        <br><br>
        Called after user reviews the consent page and makes a decision.
        This endpoint generates an authorization code if consent is granted.
        <br><br>
        <b>Responses:</b><br>
        - Consent granted: Redirects to client with authorization code<br>
        - Consent denied: Redirects to client with `access_denied` error
      operationId: oauthAuthorizeConsent
      security:
        - bearerAuth: []
      requestBody:
        description: "Request body for Submit authorization consent"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OAuthConsentRequest'
        required: true
      responses:
        '200':
          description: Consent processed, returns redirect URL with authorization code
          content:
            application/json:
              schema:
                type: object
                properties:
                  redirect_uri:
                    type: string
                    format: uri
                    description: URL to redirect user (includes code and state)
        '400':
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OAuthErrorResponse'
        '401':
          description: User not authenticated
        '403':
          description: Client not authorized or invalid redirect URI
      x-speakeasy-group: oauthProvider
      x-speakeasy-name-override: submitConsent
  /oauth/token:
    post:
      tags:
        - OAuth Provider
      summary: Exchange authorization code for tokens
      description: |
        OAuth 2.0 Token Endpoint (RFC 6749 Section 4.1.3).
        <br><br>
        Exchanges an authorization code, client credentials, or refresh token for access tokens.
        <br><br>
        <b>Grant Types:</b><br>
        - `authorization_code`: Exchange auth code for tokens (user-based)<br>
        - `client_credentials`: Get tokens for machine-to-machine auth<br>
        - `refresh_token`: Get new access token using refresh token
        <br><br>
        <b>Client Authentication:</b><br>
        Can be provided via:<br>
        - HTTP Basic auth: `Authorization: Basic base64(client_id:client_secret)`<br>
        - Request body: `client_id` and `client_secret` parameters
        <br><br>
        <b>PKCE Verification:</b><br>
        If authorization used PKCE, the `code_verifier` must be provided and will be
        verified against the stored code challenge.
      operationId: oauthToken
      security: []
      requestBody:
        description: "Request payload"
        content:
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/OAuthTokenRequest'
          application/json:
            schema:
              $ref: '#/components/schemas/OAuthTokenRequest'
        required: true
      responses:
        '200':
          description: Tokens issued successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OAuthTokenResponse'
              example:
                access_token: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                token_type: "Bearer"
                expires_in: 3600
                refresh_token: "dGhpcyBpcyBhIHJlZnJlc2ggdG9rZW4..."
                scope: "openid profile email"
                id_token: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
        '400':
          description: Invalid request (missing parameters, invalid code, etc.)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OAuthErrorResponse'
        '401':
          description: Client authentication failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OAuthErrorResponse'
      x-speakeasy-group: oauthProvider
      x-speakeasy-name-override: exchange
  /oauth/revoke:
    post:
      tags:
        - OAuth Provider
      summary: Revoke an access or refresh token
      description: |
        OAuth 2.0 Token Revocation Endpoint (RFC 7009).
        <br><br>
        Revokes an access token or refresh token, preventing further use.
        Revoking a refresh token also invalidates associated access tokens.
        <br><br>
        <b>Use Cases:</b><br>
        - User logs out of third-party app<br>
        - User revokes app access from account settings<br>
        - Security incident response
        <br><br>
        <b>Note:</b> Returns 200 OK even if token was already revoked or invalid
        (per RFC 7009, to prevent token enumeration).
      operationId: oauthRevoke
      security: []
      requestBody:
        description: "Request payload"
        content:
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/OAuthRevokeRequest'
          application/json:
            schema:
              $ref: '#/components/schemas/OAuthRevokeRequest'
        required: true
      responses:
        '200':
          description: Token revoked (or was already invalid)
        '401':
          description: Client authentication failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OAuthErrorResponse'
      x-speakeasy-group: oauthProvider
      x-speakeasy-name-override: revokeToken
  /oauth/introspect:
    post:
      tags:
        - OAuth Provider
      summary: Introspect a token
      description: |
        OAuth 2.0 Token Introspection Endpoint (RFC 7662).
        <br><br>
        Check if a token is active and retrieve its metadata.
        <br><br>
        <b>Use Cases:</b><br>
        - Resource servers validating tokens<br>
        - Debugging token issues<br>
        - Checking token scopes before processing requests
        <br><br>
        <b>Response:</b><br>
        - Active token: Returns `active: true` with token metadata<br>
        - Invalid/expired/revoked token: Returns only `active: false`
      operationId: oauthIntrospect
      security: []
      requestBody:
        description: "Request payload"
        content:
          application/x-www-form-urlencoded:
            schema:
              $ref: '#/components/schemas/OAuthIntrospectRequest'
          application/json:
            schema:
              $ref: '#/components/schemas/OAuthIntrospectRequest'
        required: true
      responses:
        '200':
          description: Token introspection result
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OAuthIntrospectResponse'
              examples:
                active:
                  summary: Active token
                  value:
                    active: true
                    scope: "openid profile email"
                    client_id: "abc123"
                    username: "user@example.com"
                    token_type: "Bearer"
                    exp: 1735686000
                    iat: 1735682400
                    sub: "user-id-123"
                    iss: "https://api.pipeshub.com"
                inactive:
                  summary: Inactive/invalid token
                  value:
                    active: false
        '401':
          description: Client authentication failed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OAuthErrorResponse'
      x-speakeasy-group: oauthProvider
      x-speakeasy-name-override: introspect
  /oauth/userinfo:
    get:
      tags:
        - OpenID Connect
      summary: Get authenticated user information
      description: |
        OpenID Connect UserInfo Endpoint.
        <br><br>
        Returns claims about the authenticated user. Requires a valid access token
        with the `openid` scope.
        <br><br>
        <b>Available Claims:</b><br>
        - `sub` - Subject identifier (user ID)<br>
        - `name`, `given_name`, `family_name` - Name claims (with `profile` scope)<br>
        - `email`, `email_verified` - Email claims (with `email` scope)
        <br><br>
        <b>Authentication:</b><br>
        Pass the access token as a Bearer token: `Authorization: Bearer {access_token}`
      operationId: oauthUserInfo
      security:
        - bearerAuth: []
      responses:
        '200':
          description: User information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OAuthUserInfoResponse'
              example:
                sub: "user-id-123"
                name: "John Doe"
                given_name: "John"
                family_name: "Doe"
                email: "john.doe@example.com"
                email_verified: true
        '401':
          description: Invalid or missing access token
        '403':
          description: Token does not have openid scope
      x-speakeasy-group: openIDConnect
      x-speakeasy-name-override: getUserInfo
  # ==================== OPENID CONNECT DISCOVERY ENDPOINTS ====================
  /.well-known/openid-configuration:
    get:
      tags:
        - OpenID Connect
      summary: OpenID Connect Discovery
      description: |
        OpenID Connect Discovery Endpoint (RFC 8414).
        <br><br>
        Returns metadata about the OAuth/OIDC authorization server including
        endpoint URLs, supported features, and capabilities.
        <br><br>
        <b>Use Cases:</b><br>
        - Automatic client configuration<br>
        - Discovering supported features<br>
        - Getting endpoint URLs without hardcoding
        <br><br>
        <b>Note:</b> This endpoint does not require authentication.
      operationId: openidConfiguration
      security: []
      servers:
        - url: /
          description: Root URL (not /api/v1)
      responses:
        '200':
          description: Authorization server metadata
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OpenIDConfiguration'
              example:
                issuer: "https://api.pipeshub.com"
                authorization_endpoint: "https://api.pipeshub.com/oauth/authorize"
                token_endpoint: "https://api.pipeshub.com/oauth/token"
                userinfo_endpoint: "https://api.pipeshub.com/oauth/userinfo"
                revocation_endpoint: "https://api.pipeshub.com/oauth/revoke"
                introspection_endpoint: "https://api.pipeshub.com/oauth/introspect"
                jwks_uri: "https://api.pipeshub.com/.well-known/jwks.json"
                scopes_supported: ["openid", "profile", "email", "read:records", "write:records"]
                response_types_supported: ["code"]
                grant_types_supported: ["authorization_code", "client_credentials", "refresh_token"]
                token_endpoint_auth_methods_supported: ["client_secret_basic", "client_secret_post"]
                code_challenge_methods_supported: ["S256", "plain"]
      x-speakeasy-group: openIDConnect
      x-speakeasy-name-override: getConfiguration
  /.well-known/jwks.json:
    get:
      tags:
        - OpenID Connect
      summary: JSON Web Key Set
      description: |
        JSON Web Key Set Endpoint (RFC 7517).
        <br><br>
        Returns the public keys used to verify JWT signatures for ID tokens
        and access tokens.
        <br><br>
        <b>Use Cases:</b><br>
        - Verifying ID token signatures<br>
        - Verifying access token signatures (if JWT-based)
        <br><br>
        <b>Note:</b><br>
        - For HS256 (symmetric) signing, this returns empty keys<br>
        - For RS256 (asymmetric) signing, returns public RSA keys<br>
        - Keys should be cached with appropriate TTL
      operationId: jwks
      security: []
      servers:
        - url: /
          description: Root URL (not /api/v1)
      responses:
        '200':
          description: JSON Web Key Set
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/JWKS'
              example:
                keys:
                  - kty: "RSA"
                    use: "sig"
                    alg: "RS256"
                    kid: "key-1"
                    n: "0vx7agoebG..."
                    e: "AQAB"
      x-speakeasy-group: openIDConnect
  # ==================== OAUTH APP MANAGEMENT ENDPOINTS ====================
  /oauth-clients:
    get:
      tags:
        - OAuth Apps
      summary: List OAuth apps
      description: |
        List all OAuth apps registered for the organization.
        <br><br>
        Returns a paginated list of apps with their configuration (excluding secrets).
        <br><br>
        <b>Filters:</b><br>
        - `status` - Filter by app status (active, suspended, revoked)<br>
        - `search` - Search by app name
      operationId: listOAuthApps
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
          description: Page number
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
          description: Items per page
        - name: status
          in: query
          schema:
            type: string
            enum: [active, suspended, revoked]
          description: Filter by status
        - name: search
          in: query
          schema:
            type: string
          description: Search by app name
      responses:
        '200':
          description: List of OAuth apps
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OAuthAppListResponse'
        '401':
          description: Unauthorized
      x-speakeasy-group: oauthApps
      x-speakeasy-name-override: list
    post:
      tags:
        - OAuth Apps
      summary: Create OAuth app
      description: |
        Create a new OAuth app for the organization.
        <br><br>
        <b>Important:</b> The client secret is only returned once during creation.
        Store it securely - it cannot be retrieved later. If lost, you'll need to
        regenerate it.
        <br><br>
        <b>Admin Only:</b> Requires admin privileges.
        <br><br>
        <b>Rate Limited:</b> 10 requests per minute.
      operationId: createOAuthApp
      security:
        - bearerAuth: []
      requestBody:
        description: "Request body for Create OAuth app"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateOAuthAppRequest'
        required: true
      responses:
        '201':
          description: OAuth app created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OAuthAppWithSecret'
        '400':
          description: Invalid request (validation error)
        '401':
          description: Unauthorized
        '403':
          description: Admin privileges required
        '429':
          description: Rate limit exceeded
      x-speakeasy-group: oauthApps
      x-speakeasy-name-override: create
  /oauth-clients/scopes:
    get:
      tags:
        - OAuth Apps
      summary: List available scopes
      description: |
        List all available OAuth scopes that can be requested by apps.
        <br><br>
        Returns scope names, descriptions, and categories for display
        in app configuration UI.
      operationId: listOAuthScopes
      security:
        - bearerAuth: []
      responses:
        '200':
          description: List of available scopes
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/OAuthScopeInfo'
              example:
                - name: "openid"
                  description: "OpenID Connect authentication"
                  category: "Identity"
                - name: "profile"
                  description: "Access to user profile information"
                  category: "Identity"
                - name: "email"
                  description: "Access to user email address"
                  category: "Identity"
                - name: "read:records"
                  description: "Read access to records"
                  category: "Records"
                - name: "write:records"
                  description: "Write access to records"
                  category: "Records"
        '401':
          description: Unauthorized
      x-speakeasy-group: oauthApps
      x-speakeasy-name-override: listScopes
  /oauth-clients/{appId}:
    get:
      tags:
        - OAuth Apps
      summary: Get OAuth app details
      description: |
        Get details of a specific OAuth app.
        <br><br>
        Returns app configuration without the client secret.
      operationId: getOAuthApp
      security:
        - bearerAuth: []
      parameters:
        - name: appId
          in: path
          required: true
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
          description: OAuth app ID (MongoDB ObjectId)
      responses:
        '200':
          description: OAuth app details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OAuthAppResponse'
        '401':
          description: Unauthorized
        '404':
          description: OAuth app not found
      x-speakeasy-group: oauthApps
      x-speakeasy-name-override: get
    put:
      tags:
        - OAuth Apps
      summary: Update OAuth app
      description: |
        Update an OAuth app's configuration.
        <br><br>
        <b>Admin Only:</b> Requires admin privileges.
        <br><br>
        <b>Rate Limited:</b> 10 requests per minute.
        <br><br>
        <b>Note:</b> To regenerate the client secret, use the
        `/oauth-clients/{appId}/regenerate-secret` endpoint.
      operationId: updateOAuthApp
      security:
        - bearerAuth: []
      parameters:
        - name: appId
          in: path
          required: true
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
          description: OAuth app ID
      requestBody:
        description: "Request payload"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateOAuthAppRequest'
        required: true
      responses:
        '200':
          description: OAuth app updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OAuthAppResponse'
        '400':
          description: Validation error
        '401':
          description: Unauthorized
        '403':
          description: Admin privileges required
        '404':
          description: OAuth app not found
        '429':
          description: Rate limit exceeded
      x-speakeasy-group: oauthApps
      x-speakeasy-name-override: update
    delete:
      tags:
        - OAuth Apps
      summary: Delete OAuth app
      description: |
        Delete (soft delete) an OAuth app.
        <br><br>
        This marks the app as deleted and revokes all its tokens.
        The app cannot be restored after deletion.
        <br><br>
        <b>Admin Only:</b> Requires admin privileges.
        <br><br>
        <b>Rate Limited:</b> 10 requests per minute.
      operationId: deleteOAuthApp
      security:
        - bearerAuth: []
      parameters:
        - name: appId
          in: path
          required: true
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
          description: OAuth app ID
      responses:
        '200':
          description: OAuth app deleted
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "OAuth app deleted successfully"
        '401':
          description: Unauthorized
        '403':
          description: Admin privileges required
        '404':
          description: OAuth app not found
        '429':
          description: Rate limit exceeded
      x-speakeasy-group: oauthApps
      x-speakeasy-name-override: delete
  /oauth-clients/{appId}/regenerate-secret:
    post:
      tags:
        - OAuth Apps
      summary: Regenerate client secret
      description: |
        Regenerate the client secret for an OAuth app.
        <br><br>
        The old secret is immediately invalidated. Any clients using the old
        secret will fail to authenticate until updated with the new secret.
        <br><br>
        <b>Important:</b> The new secret is only returned once. Store it securely.
        <br><br>
        <b>Admin Only:</b> Requires admin privileges.
        <br><br>
        <b>Rate Limited:</b> 10 requests per minute.
      operationId: regenerateOAuthAppSecret
      security:
        - bearerAuth: []
      parameters:
        - name: appId
          in: path
          required: true
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
          description: OAuth app ID
      responses:
        '200':
          description: New client secret generated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OAuthAppWithSecret'
        '401':
          description: Unauthorized
        '403':
          description: Admin privileges required
        '404':
          description: OAuth app not found
        '429':
          description: Rate limit exceeded
      x-speakeasy-group: oauthApps
      x-speakeasy-name-override: regenerateSecret
  /oauth-clients/{appId}/suspend:
    post:
      tags:
        - OAuth Apps
      summary: Suspend OAuth app
      description: |
        Suspend an OAuth app, preventing it from authenticating or issuing tokens.
        <br><br>
        Existing tokens remain valid until they expire, but no new tokens can
        be obtained. Use this for temporary access suspension.
        <br><br>
        <b>Admin Only:</b> Requires admin privileges.
        <br><br>
        <b>Rate Limited:</b> 10 requests per minute.
      operationId: suspendOAuthApp
      security:
        - bearerAuth: []
      parameters:
        - name: appId
          in: path
          required: true
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
          description: OAuth app ID
      responses:
        '200':
          description: OAuth app suspended
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OAuthAppResponse'
        '401':
          description: Unauthorized
        '403':
          description: Admin privileges required
        '404':
          description: OAuth app not found
        '429':
          description: Rate limit exceeded
      x-speakeasy-group: oauthApps
      x-speakeasy-name-override: suspend
  /oauth-clients/{appId}/activate:
    post:
      tags:
        - OAuth Apps
      summary: Activate suspended OAuth app
      description: |
        Reactivate a suspended OAuth app, allowing it to authenticate and issue tokens again.
        <br><br>
        <b>Admin Only:</b> Requires admin privileges.
        <br><br>
        <b>Rate Limited:</b> 10 requests per minute.
      operationId: activateOAuthApp
      security:
        - bearerAuth: []
      parameters:
        - name: appId
          in: path
          required: true
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
          description: OAuth app ID
      responses:
        '200':
          description: OAuth app activated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OAuthAppResponse'
        '401':
          description: Unauthorized
        '403':
          description: Admin privileges required
        '404':
          description: OAuth app not found
        '429':
          description: Rate limit exceeded
      x-speakeasy-group: oauthApps
      x-speakeasy-name-override: activate
  /oauth-clients/{appId}/tokens:
    get:
      tags:
        - OAuth Apps
      summary: List app tokens
      description: |
        List all active tokens issued to an OAuth app.
        <br><br>
        Useful for monitoring app usage and identifying tokens to revoke.
        <br><br>
        <b>Admin Only:</b> Requires admin privileges.
      operationId: listOAuthAppTokens
      security:
        - bearerAuth: []
      parameters:
        - name: appId
          in: path
          required: true
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
          description: OAuth app ID
      responses:
        '200':
          description: List of tokens
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/OAuthTokenListItem'
        '401':
          description: Unauthorized
        '403':
          description: Admin privileges required
        '404':
          description: OAuth app not found
      x-speakeasy-group: oauthApps
      x-speakeasy-name-override: listTokens
  /oauth-clients/{appId}/revoke-all-tokens:
    post:
      tags:
        - OAuth Apps
      summary: Revoke all app tokens
      description: |
        Revoke all tokens (access and refresh) issued to an OAuth app.
        <br><br>
        Use this for emergency access removal or when rotating credentials.
        <br><br>
        <b>Admin Only:</b> Requires admin privileges.
        <br><br>
        <b>Rate Limited:</b> 10 requests per minute.
      operationId: revokeAllOAuthAppTokens
      security:
        - bearerAuth: []
      parameters:
        - name: appId
          in: path
          required: true
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
          description: OAuth app ID
      responses:
        '200':
          description: All tokens revoked
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "All tokens revoked successfully"
                  count:
                    type: integer
                    description: Number of tokens revoked
        '401':
          description: Unauthorized
        '403':
          description: Admin privileges required
        '404':
          description: OAuth app not found
        '429':
          description: Rate limit exceeded
      x-speakeasy-group: oauthApps
      x-speakeasy-name-override: revokeAllTokens
  /userAccount/refresh/token:
    post:
      tags:
        - User Account
      summary: Refresh access token
      description: |
        Get a new access token using a valid refresh token.
        <br><br>
        <b>Usage:</b><br>
        - Pass the refresh token as a Bearer token in the Authorization header<br>
        - Returns a new access token (1 hour expiry) and basic user information
        <br><br>
        <b>Token Lifetimes:</b><br>
        - Access token: 1 hour<br>
        - Refresh token: 7 days
        <br><br>
        <b>Best Practices:</b><br>
        - Call this endpoint before the access token expires<br>
        - Store the new access token and continue using it for authenticated requests<br>
        - If refresh fails with 401, redirect user to login flow
      operationId: refreshToken
      security:
        - scopedToken: []
      responses:
        '200':
          description: Token refreshed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RefreshTokenResponse'
        '401':
          description: Invalid or expired refresh token - user must re-authenticate
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthError'
        '404':
          description: User not found (account may have been deleted)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthError'
      x-speakeasy-group: userAccount
      x-speakeasy-name-override: refresh
  /userAccount/logout/manual:
    post:
      tags:
        - User Account
      summary: Logout current session
      description: |
        Log out the current user session and invalidate tokens.
        <br><br>
        <b>Effects:</b><br>
        - Invalidates the current access token<br>
        - Clears server-side session data<br>
        - Client should also clear stored tokens locally
        <br><br>
        <b>Note:</b> This endpoint requires the access token, not the refresh token.
      operationId: logout
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Logged out successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Logged out successfully"
        '401':
          description: Unauthorized - invalid or expired access token
      x-speakeasy-group: userAccount
  # ==================== ORGANIZATION AUTH CONFIG ENDPOINTS ====================
  /orgAuthConfig/:
    post:
      tags:
        - Organization Auth Config
      summary: Create organization authentication configuration
      description: |
        Create initial organization authentication configuration during onboarding.
        This endpoint creates a new organization with admin user and default auth settings.
        <br><br>
        <b>Note:</b> This is typically called during the initial setup process.
      operationId: createOrgAuthConfig
      security: []
      requestBody:
        description: "Request body for Create organization authentication configuration"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OrgAuthConfigCreateRequest'
        required: true
      responses:
        '200':
          description: Organization auth configuration created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Organization created successfully"
                  orgId:
                    type: string
                    description: Created organization ID
                  userId:
                    type: string
                    description: Created admin user ID
        '400':
          description: Invalid request or organization already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthError'
        '409':
          description: Organization with this email already exists
      x-speakeasy-group: organizationAuthConfigs
      x-speakeasy-name-override: create
  /orgAuthConfig/authMethods:
    get:
      tags:
        - Organization Auth Config
      summary: Get organization authentication methods
      description: |
        Retrieve the configured authentication methods for the organization.
        <br><br>
        <b>Response Structure:</b><br>
        Returns an array of authentication steps, each containing:<br>
        - <code>order</code>: Step number (1-3)<br>
        - <code>allowedMethods</code>: Array of methods allowed for that step
        <br><br>
        <b>Example Response:</b><br>
        <pre>
        {
          "authMethods": [
            { "order": 1, "allowedMethods": [{ "type": "password" }, { "type": "google" }] },
            { "order": 2, "allowedMethods": [{ "type": "otp" }] }
          ]
        }
        </pre>
        <br>
        <b>Admin Access Required:</b> Only organization admins can view auth configuration.
      operationId: getAuthMethods
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Authentication methods retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthConfig'
        '401':
          description: Unauthorized - invalid or missing token
        '403':
          description: Admin access required - user is not an admin
        '404':
          description: Organization configuration not found
      x-speakeasy-group: organizationAuthConfig
  /orgAuthConfig/updateAuthMethod:
    post:
      tags:
        - Organization Auth Config
      summary: Update organization authentication methods
      description: |
        Update the authentication methods configuration for an organization.
        This allows admins to configure single or multi-factor authentication.
        <br><br>
        <b>Validation Rules:</b><br>
        - Minimum 1 step, maximum 3 steps<br>
        - Each step must have a unique order (1, 2, or 3)<br>
        - No duplicate methods within the same step<br>
        - No method can appear in multiple steps<br>
        - Each step must have at least one allowed method
        <br><br>
        <b>Available Methods:</b><br>
        - <code>password</code>: Email/password authentication<br>
        - <code>otp</code>: One-time password via email<br>
        - <code>google</code>: Google OAuth 2.0<br>
        - <code>microsoft</code>: Microsoft OAuth 2.0<br>
        - <code>azureAd</code>: Azure Active Directory<br>
        - <code>samlSso</code>: SAML 2.0 Single Sign-On<br>
        - <code>oauth</code>: Generic OAuth 2.0 provider
        <br><br>
        <b>Example - Single Factor (Password or Google):</b><br>
        <pre>
        {
          "authMethods": [
            { "order": 1, "allowedMethods": [{ "type": "password" }, { "type": "google" }] }
          ]
        }
        </pre>
        <br>
        <b>Example - Two Factor (Password + OTP):</b><br>
        <pre>
        {
          "authMethods": [
            { "order": 1, "allowedMethods": [{ "type": "password" }] },
            { "order": 2, "allowedMethods": [{ "type": "otp" }] }
          ]
        }
        </pre>
        <br>
        <b>Admin Access Required:</b> Only organization admins can update auth configuration.
      operationId: updateAuthMethod
      security:
        - bearerAuth: []
      requestBody:
        description: "Request payload"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthConfig'
        required: true
      responses:
        '200':
          description: Authentication methods updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Authentication methods updated"
        '400':
          description: Invalid request or validation failed (duplicate methods, invalid order, etc.)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthError'
        '401':
          description: Unauthorized - invalid or missing token
        '403':
          description: Admin access required - user is not an admin
        '404':
          description: Organization configuration not found
      x-speakeasy-group: organizationAuthConfiguration
      x-speakeasy-name-override: updateMethod
  # ==================== SAML ENDPOINTS ====================
  /saml/signIn:
    get:
      tags:
        - SAML
      summary: Initiate SAML sign-in flow
      description: |
        Initiate SAML Single Sign-On authentication by redirecting to the Identity Provider (IDP).
        <br><br>
        <b>Usage:</b><br>
        1. Call <code>/userAccount/initAuth</code> to get a session token<br>
        2. If <code>samlSso</code> is in the allowed methods, redirect the user to this endpoint<br>
        3. User authenticates with their IDP<br>
        4. IDP redirects back to <code>/saml/signIn/callback</code> with SAML response<br>
        5. Callback completes authentication and returns tokens
        <br><br>
        <b>Note:</b> This is a browser redirect endpoint, not a typical API call.
        The user's browser should be redirected to this URL.
        <br><br>
        <b>Prerequisites:</b><br>
        - Organization must have SAML SSO configured via <code>/saml/updateAppConfig</code><br>
        - User must belong to an organization with SAML enabled
      operationId: signInViaSAML
      security: []
      parameters:
        - name: email
          in: query
          required: true
          description: User's email address
          schema:
            type: string
            format: email
        - name: sessionToken
          in: query
          required: false
          description: |
            Session token from `/userAccount/initAuth`. Optional but recommended
            for maintaining authentication state across the SAML flow.
          schema:
            type: string
      responses:
        '302':
          description: Redirect to SAML Identity Provider login page
          headers:
            Location:
              description: IDP SSO URL
              schema:
                type: string
        '400':
          description: Invalid request (missing or malformed parameters)
        '404':
          description: User not found or SAML not configured for organization
      x-speakeasy-group: saml
      x-speakeasy-name-override: signIn
  /saml/signIn/callback:
    post:
      tags:
        - SAML
      summary: SAML authentication callback
      description: |
        Handle the callback from SAML Identity Provider after user authentication.
        This endpoint processes the SAML response and completes the authentication flow.
        <br><br>
        <b>Note:</b> This endpoint is called by the IDP, not directly by the client.
        The IDP posts the SAML response to this URL after user authentication.
        <br><br>
        <b>Flow:</b><br>
        1. IDP posts SAMLResponse and RelayState<br>
        2. Server validates SAML assertion signature<br>
        3. Server extracts user identity from assertion<br>
        4. Server completes the authentication step<br>
        5. Redirects to frontend with success/error status
        <br><br>
        <b>RelayState:</b> Contains the session token to resume the authentication flow.
      operationId: samlCallback
      security: []
      requestBody:
        description: "Request payload"
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                SAMLResponse:
                  type: string
                  description: Base64-encoded SAML Response from IDP
                RelayState:
                  type: string
                  description: State parameter containing session information
              required:
                - SAMLResponse
      responses:
        '302':
          description: Redirect to frontend with authentication result
          headers:
            Location:
              description: Frontend URL with auth result parameters
              schema:
                type: string
        '400':
          description: Invalid SAML response format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthError'
        '401':
          description: SAML assertion validation failed (invalid signature, expired, etc.)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthError'
        '404':
          description: Session expired or user not found
      x-speakeasy-group: saml
      x-speakeasy-name-override: callback
  /saml/updateAppConfig:
    post:
      tags:
        - SAML
      summary: Reload SAML application configuration (Internal)
      description: |
        Internal endpoint to reload SAML configuration from the configuration manager.
        This is called by other services when SAML settings are updated.<br><br>
        <b>Purpose:</b><br>
        When SAML configuration is updated in the Configuration Manager, this endpoint
        is called to reload the settings into the authentication service without restart.<br><br>
        <b>Effects:</b><br>
        <ul>
        <li>Reloads AppConfig from configuration files</li>
        <li>Rebinds authentication controllers with new config</li>
        <li>Updates SAML passport strategy settings</li>
        </ul>
        <b>Note:</b> This is an internal service-to-service endpoint.
      operationId: updateSamlAppConfig
      security:
        - scopedToken: []
      responses:
        '200':
          description: Configuration reloaded successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Auth configuration updated successfully"
                  config:
                    type: object
                    description: Updated application configuration
        '401':
          description: Unauthorized - Invalid or missing scoped token
        '500':
          description: Failed to reload configuration
      x-speakeasy-group: saml
      x-speakeasy-name-override: updateAppConfig
  # ==================== USER MANAGEMENT ENDPOINTS ====================
  # ==================== USERS ENDPOINTS ====================
  /users:
    get:
      tags:
        - Users
      summary: Get all users
      description: |
        Retrieve a paginated list of all users in the organization.<br><br>
        <b>Overview:</b><br>
        This endpoint returns all active users in your organization. It's the primary endpoint for listing and displaying users in admin dashboards, user directories, and selection interfaces.<br><br>
        <b>Response Data:</b><br>
        <ul>
        <li>User profile information (name, email, designation)</li>
        <li>Account status (active, pending invitation, disabled)</li>
        <li>Login history (hasLoggedIn flag)</li>
        <li>Timestamps (createdAt, updatedAt)</li>
        </ul>
        <b>Privacy Controls:</b><br>
        <ul>
        <li>Email addresses may be masked based on organization settings</li>
        <li>Sensitive fields (password, tokens) are never exposed</li>
        <li>Deleted users are excluded from results</li>
        </ul>
        <b>Performance Notes:</b><br>
        <ul>
        <li>Results are cached for improved performance</li>
        <li>For large organizations, consider using pagination</li>
        <li>Use <code>/users/by-ids</code> for fetching specific users</li>
        </ul>
      operationId: getAllUsers
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          required: false
          description: Page number for pagination (1-based)
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          required: false
          description: Number of users per page
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 50
        - name: search
          in: query
          required: false
          description: Search users by name or email
          schema:
            type: string
      responses:
        '200':
          description: List of users retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/User'
                  pagination:
                    type: object
                    properties:
                      page:
                        type: integer
                      limit:
                        type: integer
                      total:
                        type: integer
                      totalPages:
                        type: integer
        '401':
          description: Unauthorized - Valid bearer token required
      x-speakeasy-name-override: get
    post:
      tags:
        - Users
      summary: Create a new user
      description: |
        Create a new user account in the organization and optionally send an invitation email.<br><br>
        <b>Overview:</b><br>
        This endpoint creates a new user account. The user will be added to the organization but won't have a password set until they complete the invitation flow or are assigned one by an admin.<br><br>
        <b>Invitation Flow:</b><br>
        <ol>
        <li>Admin creates user with this endpoint</li>
        <li>System generates invitation token</li>
        <li>User receives invitation email (if sendInvite is true)</li>
        <li>User clicks link and sets their password</li>
        <li>User can now log in normally</li>
        </ol>
        <b>Validation Rules:</b><br>
        <ul>
        <li><code>fullName</code>: Required, 1-100 characters</li>
        <li><code>email</code>: Required, valid email format, must be unique in org</li>
        <li><code>mobile</code>: Optional, format: +[country][number] (10-15 digits)</li>
        <li><code>designation</code>: Optional, job title or role</li>
        </ul>
        <b>Side Effects:</b><br>
        <ul>
        <li>User is automatically added to the "everyone" group</li>
        <li>Invitation email sent if <code>sendInvite: true</code></li>
        <li>User creation event published to event bus</li>
        <li>Audit log entry created</li>
        </ul>
        <b>Authorization:</b><br>
        Only organization administrators can create new users.
      operationId: createUser
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                fullName:
                  type: string
                  minLength: 1
                  maxLength: 100
                  description: User's full display name
                  example: "John Smith"
                email:
                  type: string
                  format: email
                  description: User's email address (must be unique)
                  example: "john.smith@company.com"
                mobile:
                  type: string
                  pattern: '^\+?[0-9]{10,15}$'
                  description: Mobile phone number with country code
                  example: "+15551234567"
                designation:
                  type: string
                  description: Job title or designation
                  example: "Software Engineer"
                sendInvite:
                  type: boolean
                  default: true
                  description: Whether to send invitation email immediately
              required:
                - fullName
                - email
      responses:
        '201':
          description: User created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "User created successfully"
                  data:
                    $ref: '#/components/schemas/User'
                  inviteSent:
                    type: boolean
                    description: Whether invitation email was sent
        '400':
          description: |
            Invalid request. Possible reasons:<br>
            <ul>
            <li>Missing required fields (fullName, email)</li>
            <li>Invalid email format</li>
            <li>Email already exists in organization</li>
            <li>Invalid mobile number format</li>
            </ul>
        '401':
          description: Unauthorized - Valid bearer token required
        '403':
          description: Forbidden - Admin privileges required
      x-speakeasy-name-override: create
  /users/{id}:
    get:
      tags:
        - Users
      summary: Get user by ID
      description: |
        Retrieve detailed information about a specific user by their unique identifier.<br><br>
        <b>Overview:</b><br>
        This endpoint returns the complete user profile for the specified user ID. Use this to display user details in profiles, settings pages, or when you need full user information.<br><br>
        <b>Response Data:</b><br>
        <ul>
        <li>Basic info: fullName, firstName, lastName, email</li>
        <li>Contact: mobile, address</li>
        <li>Professional: designation</li>
        <li>Status: hasLoggedIn, isDeleted, accountStatus</li>
        <li>Metadata: createdAt, updatedAt, createdBy</li>
        </ul>
        <b>Privacy Notes:</b><br>
        <ul>
        <li>Email may be masked for non-admin users based on org settings</li>
        <li>Password and sensitive tokens are never returned</li>
        <li>Display picture URL returned if set</li>
        </ul>
        <b>Related Endpoints:</b><br>
        <ul>
        <li><code>GET /users/{id}/email</code> - Get just the email (admin only)</li>
        <li><code>GET /users/fetch/with-groups</code> - Get user with group memberships</li>
        </ul>
      operationId: getUserById
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: User ID (24-character MongoDB ObjectId)
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
            example: "507f1f77bcf86cd799439011"
      responses:
        '200':
          description: User details retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/User'
        '400':
          description: Invalid user ID format
        '401':
          description: Unauthorized - Valid bearer token required
        '404':
          description: User not found or has been deleted
      x-speakeasy-name-override: getById
    put:
      tags:
        - Users
      summary: Update user
      description: |
        Update user profile information. Users can update their own profile, admins can update any user.<br><br>
        <b>Overview:</b><br>
        This endpoint allows updating user profile fields. The scope of allowed updates depends on the requester's role and relationship to the user being updated.<br><br>
        <b>Authorization Matrix:</b><br>
        <ul>
        <li><b>Self-update:</b> Users can update their own fullName, mobile, designation, address</li>
        <li><b>Admin-update:</b> Admins can update any field for any user</li>
        <li><b>Email changes:</b> Require admin privileges and trigger re-verification</li>
        </ul>
        <b>Updatable Fields:</b><br>
        <ul>
        <li><code>fullName</code>: Display name (also updates firstName/lastName if parsed)</li>
        <li><code>firstName</code>: First name only</li>
        <li><code>lastName</code>: Last name only</li>
        <li><code>email</code>: Email address (admin only, triggers verification)</li>
        <li><code>mobile</code>: Phone number with country code</li>
        <li><code>designation</code>: Job title</li>
        <li><code>address</code>: Full address object</li>
        </ul>
        <b>Validation Rules:</b><br>
        <ul>
        <li>Email must be unique within the organization</li>
        <li>Mobile must match pattern: +[country][number]</li>
        <li>Name fields: 1-100 characters</li>
        </ul>
        <b>Side Effects:</b><br>
        <ul>
        <li>User update event published to event bus</li>
        <li>Audit log entry created for admin updates</li>
        <li>Email change triggers verification email</li>
        </ul>
      operationId: updateUser
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: User ID (24-character MongoDB ObjectId)
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
            example: "507f1f77bcf86cd799439011"
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                fullName:
                  type: string
                  minLength: 1
                  maxLength: 100
                  description: Full display name
                  example: "John Smith"
                firstName:
                  type: string
                  description: First name only
                  example: "John"
                lastName:
                  type: string
                  description: Last name only
                  example: "Smith"
                email:
                  type: string
                  format: email
                  description: Email address (admin only)
                  example: "john.smith@company.com"
                mobile:
                  type: string
                  pattern: '^\+?[0-9]{10,15}$'
                  description: Mobile phone with country code
                  example: "+15551234567"
                designation:
                  type: string
                  description: Job title or role
                  example: "Senior Software Engineer"
                address:
                  $ref: '#/components/schemas/Address'
      responses:
        '200':
          description: User updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "User updated successfully"
                  data:
                    $ref: '#/components/schemas/User'
        '400':
          description: |
            Invalid request. Possible reasons:<br>
            <ul>
            <li>Invalid field values</li>
            <li>Email already exists</li>
            <li>Invalid mobile format</li>
            </ul>
        '401':
          description: Unauthorized - Valid bearer token required
        '403':
          description: |
            Forbidden. Possible reasons:<br>
            <ul>
            <li>Attempting to update another user without admin privileges</li>
            <li>Attempting to update email without admin privileges</li>
            </ul>
        '404':
          description: User not found
      x-speakeasy-name-override: update
    delete:
      tags:
        - Users
      summary: Delete user
      description: |
        Soft delete a user from the organization. The user account is deactivated but data is retained for audit purposes.<br><br>
        <b>Overview:</b><br>
        This endpoint performs a soft delete on a user account. The user is marked as deleted and can no longer access the system, but their data is retained for compliance and audit purposes.<br><br>
        <b>What Happens on Delete:</b><br>
        <ol>
        <li>User's <code>isDeleted</code> flag is set to true</li>
        <li>User's password is cleared</li>
        <li>User is removed from all user groups</li>
        <li>User's active sessions are invalidated</li>
        <li>User deletion event is published</li>
        </ol>
        <b>Restrictions:</b><br>
        <ul>
        <li>Cannot delete organization admins (demote first)</li>
        <li>Cannot delete the organization owner</li>
        <li>Cannot delete yourself through this endpoint</li>
        <li>Cannot delete already-deleted users</li>
        </ul>
        <b>Data Retention:</b><br>
        <ul>
        <li>User profile data is retained (soft delete)</li>
        <li>User's documents and content remain with updated ownership</li>
        <li>Audit logs are preserved</li>
        <li>Data can be permanently purged by super admin if required</li>
        </ul>
        <b>Recovery:</b><br>
        Deleted users can be restored by organization admins within a configurable retention period.
      operationId: deleteUser
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: User ID (24-character MongoDB ObjectId)
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
            example: "507f1f77bcf86cd799439011"
      responses:
        '200':
          description: User deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "User deleted successfully"
                  deletedUser:
                    type: object
                    properties:
                      _id:
                        type: string
                      fullName:
                        type: string
                      email:
                        type: string
        '400':
          description: |
            Invalid request. Possible reasons:<br>
            <ul>
            <li>User is already deleted</li>
            <li>Invalid user ID format</li>
            </ul>
        '401':
          description: Unauthorized - Valid bearer token required
        '403':
          description: |
            Forbidden. Possible reasons:<br>
            <ul>
            <li>Admin privileges required</li>
            <li>Cannot delete admin users</li>
            <li>Cannot delete organization owner</li>
            </ul>
        '404':
          description: User not found
      x-speakeasy-name-override: delete
  /users/fetch/with-groups:
    get:
      tags:
        - Users
      summary: Get all users with their groups
      description: |
        Retrieve all users along with their group memberships in a single optimized query.<br><br>
        <b>Overview:</b><br>
        This endpoint returns users with their associated groups pre-loaded, eliminating the need for separate group lookup calls. Ideal for admin dashboards that need to display user permissions at a glance.<br><br>
        <b>Use Cases:</b><br>
        <ul>
        <li>Admin dashboards showing user-group matrix</li>
        <li>Permission auditing and compliance checks</li>
        <li>Bulk user management interfaces</li>
        <li>Access control visualization</li>
        </ul>
        <b>Response Data per User:</b><br>
        <ul>
        <li><code>_id</code>: User's unique identifier</li>
        <li><code>userId</code>: User's public-facing ID</li>
        <li><code>orgId</code>: Organization identifier</li>
        <li><code>fullName</code>: User's display name</li>
        <li><code>hasLoggedIn</code>: Whether user has ever logged in</li>
        <li><code>groups</code>: Array of group objects with name and type</li>
        </ul>
        <b>Group Types Returned:</b><br>
        <ul>
        <li><code>admin</code>: Administrative groups with elevated permissions</li>
        <li><code>standard</code>: Regular user groups</li>
        <li><code>everyone</code>: Default group containing all org users</li>
        <li><code>custom</code>: Custom groups created by admins</li>
        </ul>
        <b>Performance Notes:</b><br>
        Uses aggregation pipeline for efficient single-query retrieval. Cached results for improved performance on large organizations.
      operationId: getAllUsersWithGroups
      security:
        - bearerAuth: []
      parameters:
        - name: includeDeleted
          in: query
          required: false
          description: Include soft-deleted users (admin only)
          schema:
            type: boolean
            default: false
      responses:
        '200':
          description: Users with groups retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        _id:
                          type: string
                          example: "507f1f77bcf86cd799439011"
                        userId:
                          type: string
                        orgId:
                          type: string
                        fullName:
                          type: string
                          example: "John Smith"
                        hasLoggedIn:
                          type: boolean
                        groups:
                          type: array
                          items:
                            type: object
                            properties:
                              _id:
                                type: string
                              name:
                                type: string
                                example: "Engineering Team"
                              type:
                                type: string
                                enum: [admin, standard, everyone, custom]
        '401':
          description: Unauthorized - Valid bearer token required
      x-speakeasy-name-override: fetchWithGroups
  /users/{id}/email:
    get:
      tags:
        - Users
      summary: Get user email by ID
      description: |
        Retrieve the email address for a specific user. This is a dedicated endpoint for email lookup with proper access controls.<br><br>
        <b>Overview:</b><br>
        This endpoint provides direct access to a user's email address. It exists separately from the main user endpoint to allow granular permission control over email visibility.<br><br>
        <b>Use Cases:</b><br>
        <ul>
        <li>Admin communication workflows</li>
        <li>Invitation and notification systems</li>
        <li>Email-based user lookup</li>
        <li>Contact information export</li>
        </ul>
        <b>Privacy Considerations:</b><br>
        <ul>
        <li>Only organization admins can access this endpoint</li>
        <li>Access is logged for audit purposes</li>
        <li>Consider GDPR/privacy regulations when exposing emails</li>
        </ul>
        <b>Authorization:</b><br>
        Requires admin privileges. Regular users should use the main user endpoint which may mask emails based on organization settings.
      operationId: getUserEmailById
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: User ID (24-character MongoDB ObjectId)
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
            example: "507f1f77bcf86cd799439011"
      responses:
        '200':
          description: User email retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  email:
                    type: string
                    format: email
                    example: "john.smith@company.com"
        '401':
          description: Unauthorized - Valid bearer token required
        '403':
          description: Forbidden - Admin privileges required
        '404':
          description: User not found
      x-speakeasy-name-override: getEmail
  /users/by-ids:
    post:
      tags:
        - Users
      summary: Get users by IDs (bulk)
      description: |
        Retrieve multiple users by their IDs in a single optimized request. Ideal for efficiently fetching a specific set of users.<br><br>
        <b>Overview:</b><br>
        This bulk endpoint allows fetching multiple users in a single API call, reducing network overhead when you need to display information about several known users.<br><br>
        <b>Use Cases:</b><br>
        <ul>
        <li>Fetching user details for a list of team members</li>
        <li>Populating user cards in a dashboard</li>
        <li>Loading participants in a document or conversation</li>
        <li>Building user mention/autocomplete features</li>
        </ul>
        <b>Request Format:</b><br>
        <ul>
        <li>Send array of user IDs in request body</li>
        <li>Each ID must be valid 24-character MongoDB ObjectId</li>
        <li>Maximum 100 IDs per request (for performance)</li>
        <li>Duplicate IDs are automatically deduplicated</li>
        </ul>
        <b>Response Behavior:</b><br>
        <ul>
        <li>Returns array of found users</li>
        <li>Order matches order of requested IDs</li>
        <li>Non-existent or deleted users are silently omitted</li>
        <li>Partial results returned if some IDs are invalid</li>
        </ul>
        <b>Performance Notes:</b><br>
        Uses single database query with $in operator for optimal performance. Preferable to multiple individual user fetches.
      operationId: getUsersByIds
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                userIds:
                  type: array
                  items:
                    type: string
                    pattern: '^[a-fA-F0-9]{24}$'
                  minItems: 1
                  maxItems: 100
                  description: Array of user IDs to retrieve
                  example: ["507f1f77bcf86cd799439011", "507f1f77bcf86cd799439012"]
              required:
                - userIds
      responses:
        '200':
          description: Users retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/User'
                  requestedCount:
                    type: integer
                    description: Number of IDs requested
                  foundCount:
                    type: integer
                    description: Number of users found
        '400':
          description: |
            Invalid request. Possible reasons:<br>
            <ul>
            <li>Empty userIds array</li>
            <li>Invalid ObjectId format in array</li>
            <li>Exceeded maximum limit (100 IDs)</li>
            </ul>
        '401':
          description: Unauthorized - Valid bearer token required
      x-speakeasy-name-override: getByIds
  /users/email/exists:
    get:
      tags:
        - Users
      summary: Check if user exists by email
      description: |
        Check if a user account exists with the given email address. Used for pre-validation in registration and invitation flows.<br><br>
        <b>Overview:</b><br>
        This internal service endpoint validates email existence before creating accounts or sending invitations. It helps prevent duplicate accounts and validates recovery email addresses.<br><br>
        <b>Use Cases:</b><br>
        <ul>
        <li>Pre-flight check before user invitation</li>
        <li>Email validation during registration</li>
        <li>Account recovery flow validation</li>
        <li>Duplicate prevention checks</li>
        </ul>
        <b>Security Model:</b><br>
        <ul>
        <li>Requires scoped token with USER_LOOKUP privilege</li>
        <li>Not accessible with regular bearer tokens</li>
        <li>Typically called from internal services only</li>
        </ul>
        <b>Response Behavior:</b><br>
        <ul>
        <li>Returns matching users (including soft-deleted for recovery)</li>
        <li>Empty array if no match found</li>
        <li>Does not expose whether email exists to prevent enumeration</li>
        </ul>
        <b>Note:</b> May return soft-deleted users to support account recovery workflows.
      operationId: checkUserExistsByEmail
      security:
        - scopedToken: []
      parameters:
        - name: email
          in: query
          required: true
          description: Email address to check
          schema:
            type: string
            format: email
            example: "john.smith@company.com"
        - name: includeDeleted
          in: query
          required: false
          description: Whether to include soft-deleted users
          schema:
            type: boolean
            default: true
      responses:
        '200':
          description: Email check completed
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  exists:
                    type: boolean
                    description: Whether a user exists with this email
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/User'
        '400':
          description: Invalid email format
        '401':
          description: |
            Unauthorized. Possible reasons:<br>
            <ul>
            <li>Missing scoped token</li>
            <li>Invalid scoped token</li>
            <li>Token lacks USER_LOOKUP privilege</li>
            </ul>
      x-speakeasy-name-override: checkExistsByEmail
  /users/internal/{id}:
    get:
      tags:
        - Users
      summary: Get user (internal service-to-service)
      description: |
        Internal endpoint for service-to-service user lookup. Returns complete user data without privacy masking.<br><br>
        <b>Overview:</b><br>
        This internal endpoint provides full user data access for trusted backend services. Unlike public endpoints, it bypasses privacy controls and returns complete user information.<br><br>
        <b>Security Model:</b><br>
        <ul>
        <li>Requires scoped token with USER_LOOKUP privilege</li>
        <li>Not accessible via regular bearer tokens</li>
        <li>Intended for trusted internal services only</li>
        <li>All access is logged for audit purposes</li>
        </ul>
        <b>Intended Consumers:</b><br>
        <ul>
        <li>Email notification service</li>
        <li>Analytics and reporting services</li>
        <li>Audit logging service</li>
        <li>Integration sync services</li>
        </ul>
        <b>Data Returned:</b><br>
        Complete user object including fields that may be masked in public endpoints (email, phone, etc.).<br><br>
        <b>Warning:</b><br>
        This endpoint returns sensitive data. Ensure consuming services handle data according to privacy policies.
      operationId: getInternalUser
      security:
        - scopedToken: []
      parameters:
        - name: id
          in: path
          required: true
          description: User ID (24-character MongoDB ObjectId)
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
            example: "507f1f77bcf86cd799439011"
      responses:
        '200':
          description: User retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/User'
        '401':
          description: |
            Unauthorized. Possible reasons:<br>
            <ul>
            <li>Missing scoped token</li>
            <li>Invalid scoped token</li>
            <li>Token lacks USER_LOOKUP privilege</li>
            </ul>
        '404':
          description: User not found
      x-speakeasy-name-override: getInternal
  /users/{id}/fullname:
    patch:
      tags:
        - Users
      summary: Update user full name
      description: |
        Update the full name of a user. This is a targeted update endpoint for changing only the display name without affecting other profile fields.<br><br>
        <b>Overview:</b><br>
        This endpoint updates a user's fullName field, which is their primary display name throughout the application. The firstName and lastName fields may also be updated based on name parsing logic.<br><br>
        <b>Authorization:</b><br>
        <ul>
        <li><b>Self-update:</b> Users can update their own full name</li>
        <li><b>Admin-update:</b> Admins can update any user's name</li>
        </ul>
        <b>Side Effects:</b><br>
        <ul>
        <li>Updates fullName field</li>
        <li>May parse and update firstName/lastName</li>
        <li>User update event published</li>
        <li>Cached user data invalidated</li>
        </ul>
        <b>Use Cases:</b><br>
        <ul>
        <li>User profile name change</li>
        <li>Name correction by admin</li>
        <li>Legal name update</li>
        </ul>
      operationId: updateUserFullName
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                fullName:
                  type: string
                  minLength: 1
              required:
                - fullName
      responses:
        '200':
          description: User updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '400':
          description: Invalid request
        '401':
          description: Unauthorized
        '403':
          description: Not allowed to update this user
        '404':
          description: User not found
      x-speakeasy-name-override: updateFullName
  /users/{id}/firstName:
    patch:
      tags:
        - Users
      summary: Update user first name
      description: |
        Update only the first name of a user without affecting other profile fields.<br><br>
        <b>Overview:</b><br>
        This targeted endpoint updates just the firstName field. Useful when you need fine-grained control over name components rather than updating the full name.<br><br>
        <b>Authorization:</b><br>
        <ul>
        <li><b>Self-update:</b> Users can update their own first name</li>
        <li><b>Admin-update:</b> Admins can update any user's first name</li>
        </ul>
        <b>Note:</b> This does NOT automatically update the fullName field. Use <code>/users/{id}/fullname</code> if you need to update the complete display name.
      operationId: updateUserFirstName
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: User ID (24-character MongoDB ObjectId)
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
            example: "507f1f77bcf86cd799439011"
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                firstName:
                  type: string
                  minLength: 1
                  maxLength: 50
                  description: New first name
                  example: "John"
              required:
                - firstName
      responses:
        '200':
          description: First name updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/User'
        '400':
          description: Invalid first name (empty or too long)
        '401':
          description: Unauthorized - Valid bearer token required
        '403':
          description: Forbidden - Cannot update this user's profile
        '404':
          description: User not found
      x-speakeasy-name-override: updateFirstName
  /users/{id}/lastName:
    patch:
      tags:
        - Users
      summary: Update user last name
      description: |
        Update only the last name of a user without affecting other profile fields.<br><br>
        <b>Overview:</b><br>
        This targeted endpoint updates just the lastName field. Useful for fine-grained control over name components.<br><br>
        <b>Authorization:</b><br>
        <ul>
        <li><b>Self-update:</b> Users can update their own last name</li>
        <li><b>Admin-update:</b> Admins can update any user's last name</li>
        </ul>
        <b>Note:</b> This does NOT automatically update the fullName field. Use <code>/users/{id}/fullname</code> if you need to update the complete display name.
      operationId: updateUserLastName
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: User ID (24-character MongoDB ObjectId)
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
            example: "507f1f77bcf86cd799439011"
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                lastName:
                  type: string
                  minLength: 1
                  maxLength: 50
                  description: New last name
                  example: "Smith"
              required:
                - lastName
      responses:
        '200':
          description: Last name updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/User'
        '400':
          description: Invalid last name (empty or too long)
        '401':
          description: Unauthorized - Valid bearer token required
        '403':
          description: Forbidden - Cannot update this user's profile
        '404':
          description: User not found
      x-speakeasy-name-override: updateLastName
  /users/{id}/designation:
    patch:
      tags:
        - Users
      summary: Update user designation
      description: |
        Update the job title or designation of a user.<br><br>
        <b>Overview:</b><br>
        This endpoint updates the user's designation field, which typically represents their job title, role, or position within the organization.<br><br>
        <b>Authorization:</b><br>
        <ul>
        <li><b>Self-update:</b> Users can update their own designation</li>
        <li><b>Admin-update:</b> Admins can update any user's designation</li>
        </ul>
        <b>Common Values:</b><br>
        <ul>
        <li>Software Engineer</li>
        <li>Product Manager</li>
        <li>Team Lead</li>
        <li>Director of Engineering</li>
        </ul>
        <b>Display:</b><br>
        Designation is shown in user profiles, team views, and organizational charts.
      operationId: updateUserDesignation
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: User ID (24-character MongoDB ObjectId)
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
            example: "507f1f77bcf86cd799439011"
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                designation:
                  type: string
                  minLength: 1
                  maxLength: 100
                  description: Job title or designation
                  example: "Senior Software Engineer"
              required:
                - designation
      responses:
        '200':
          description: Designation updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/User'
        '400':
          description: Invalid designation (empty or too long)
        '401':
          description: Unauthorized - Valid bearer token required
        '403':
          description: Forbidden - Cannot update this user's profile
        '404':
          description: User not found
      x-speakeasy-name-override: updateDesignation
  /users/{id}/adminCheck:
    get:
      tags:
        - Users
      summary: Check if user is admin
      description: |
        Verify whether a specific user has administrative privileges in the organization.<br><br>
        <b>Overview:</b><br>
        This endpoint checks if the specified user belongs to an admin group and has elevated permissions. It's useful for authorization checks before performing admin-only operations.<br><br>
        <b>What Makes a User an Admin:</b><br>
        <ul>
        <li>Member of a group with type "admin"</li>
        <li>Has explicit admin role assignment</li>
        <li>Organization owner (always admin)</li>
        </ul>
        <b>Use Cases:</b><br>
        <ul>
        <li>UI permission checks before showing admin features</li>
        <li>Pre-flight authorization validation</li>
        <li>Access control for sensitive operations</li>
        </ul>
        <b>Response Codes:</b><br>
        <ul>
        <li><code>200</code>: User IS an admin</li>
        <li><code>403</code>: User is NOT an admin</li>
        </ul>
      operationId: checkUserIsAdmin
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: User ID to check for admin privileges
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
            example: "507f1f77bcf86cd799439011"
      responses:
        '200':
          description: User has admin access
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  isAdmin:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "User has admin access"
                  adminGroups:
                    type: array
                    description: List of admin groups the user belongs to
                    items:
                      type: string
        '401':
          description: Unauthorized - Valid bearer token required
        '403':
          description: |
            User does not have admin access. Response includes:<br>
            <code>{ "isAdmin": false, "message": "User does not have admin privileges" }</code>
        '404':
          description: User not found
      x-speakeasy-name-override: checkIsAdmin
  /users/dp:
    put:
      tags:
        - Users
      summary: Upload display picture
      description: |
        Upload or update the display picture (avatar) for the authenticated user.<br><br>
        <b>Overview:</b><br>
        This endpoint allows users to upload their profile picture. The image is processed, resized, and stored for use throughout the application.<br><br>
        <b>File Requirements:</b><br>
        <ul>
        <li><b>Allowed types:</b> PNG, JPEG, JPG, WebP, GIF</li>
        <li><b>Maximum size:</b> 1MB (1,048,576 bytes)</li>
        <li><b>Recommended dimensions:</b> 256x256 pixels or larger</li>
        <li><b>Aspect ratio:</b> Square recommended (will be cropped to square)</li>
        </ul>
        <b>Image Processing:</b><br>
        <ul>
        <li>Images are automatically resized to standard dimensions</li>
        <li>Converted to JPEG for consistency and smaller file size</li>
        <li>Multiple sizes may be generated (thumbnail, standard, large)</li>
        <li>Original is not preserved</li>
        </ul>
        <b>Side Effects:</b><br>
        <ul>
        <li>Previous display picture is replaced</li>
        <li>Cached images are invalidated</li>
        <li>CDN cache may take time to update</li>
        </ul>
        <b>Authorization:</b><br>
        Users can only upload their own display picture. Admins cannot upload on behalf of other users.
      operationId: uploadUserDisplayPicture
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request payload"
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
                  description: Image file (PNG, JPEG, WebP, or GIF, max 1MB)
              required:
                - file
      responses:
        '201':
          description: Display picture uploaded
          content:
            image/jpeg:
              schema:
                type: string
                format: binary
        '400':
          description: Invalid file type or size
        '401':
          description: Unauthorized
      x-speakeasy-name-override: uploadDisplayPicture
    get:
      tags:
        - Users
      summary: Get display picture
      description: |
        Retrieve the current user's display picture image.<br><br>
        <b>Overview:</b><br>
        This endpoint returns the user's profile picture as binary image data. Use this for displaying the user's avatar in the application.<br><br>
        <b>Response Format:</b><br>
        <ul>
        <li>Returns raw image data (not JSON)</li>
        <li>Content-Type header indicates image format (typically image/jpeg)</li>
        <li>Suitable for use directly in &lt;img&gt; src or CSS background</li>
        </ul>
        <b>Caching:</b><br>
        <ul>
        <li>Response includes cache headers for browser caching</li>
        <li>Use ETag for conditional requests</li>
        <li>Cache invalidated when picture is updated</li>
        </ul>
        <b>Alternative:</b><br>
        For signed URL access, use the user profile endpoint which returns a <code>displayPictureUrl</code> field.
      operationId: getUserDisplayPicture
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Display picture retrieved successfully
          content:
            image/jpeg:
              schema:
                type: string
                format: binary
            image/png:
              schema:
                type: string
                format: binary
        '401':
          description: Unauthorized - Valid bearer token required
        '404':
          description: No display picture set - User has not uploaded a profile picture
      x-speakeasy-name-override: getDisplayPicture
    delete:
      tags:
        - Users
      summary: Remove display picture
      description: |
        Remove the current user's display picture and revert to default avatar.<br><br>
        <b>Overview:</b><br>
        This endpoint permanently removes the user's uploaded profile picture. After removal, the user will display a default avatar (typically initials or generic icon).<br><br>
        <b>What Happens:</b><br>
        <ul>
        <li>Profile picture file is deleted from storage</li>
        <li>User profile updated to remove picture reference</li>
        <li>Cached images invalidated</li>
        <li>Default avatar will be shown in UI</li>
        </ul>
        <b>Note:</b><br>
        This action is immediate and irreversible. To restore a picture, user must upload a new one.
      operationId: removeUserDisplayPicture
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Display picture removed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Display picture removed successfully"
        '401':
          description: Unauthorized - Valid bearer token required
        '404':
          description: No display picture to remove
      x-speakeasy-name-override: removeDisplayPicture
  /users/bulk/invite:
    post:
      tags:
        - Users
      summary: Bulk invite users
      description: |
        Invite multiple users to the organization in a single operation. Ideal for onboarding entire teams at once.<br><br>
        <b>Overview:</b><br>
        This endpoint creates user accounts for multiple email addresses and sends invitation emails to all of them. It's the most efficient way to add multiple users to your organization.<br><br>
        <b>Invitation Flow:</b><br>
        <ol>
        <li>Validate all email addresses</li>
        <li>Check for existing accounts (skip duplicates)</li>
        <li>Create user accounts for new emails</li>
        <li>Restore any previously deleted accounts</li>
        <li>Add users to specified groups (optional)</li>
        <li>Send invitation emails to all new users</li>
        </ol>
        <b>Requirements:</b><br>
        <ul>
        <li><b>Account Type:</b> Business accounts only (not individual)</li>
        <li><b>SMTP:</b> Email configuration must be set up</li>
        <li><b>Authorization:</b> Admin privileges required</li>
        </ul>
        <b>Email Processing:</b><br>
        <ul>
        <li>Duplicate emails are automatically skipped</li>
        <li>Invalid email formats are rejected</li>
        <li>Existing users are not re-invited (use resend-invite)</li>
        <li>Previously deleted users are restored</li>
        </ul>
        <b>Response Details:</b><br>
        Response includes count of successful invites and any failures with reasons.
      operationId: bulkInviteUsers
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                emails:
                  type: array
                  items:
                    type: string
                    format: email
                  minItems: 1
                  maxItems: 100
                  description: Array of email addresses to invite (max 100)
                  example: ["user1@company.com", "user2@company.com"]
                groupIds:
                  type: array
                  items:
                    type: string
                    pattern: '^[a-fA-F0-9]{24}$'
                  description: Optional group IDs to add all invited users to
                  example: ["507f1f77bcf86cd799439011"]
                sendEmail:
                  type: boolean
                  default: true
                  description: Whether to send invitation emails immediately
              required:
                - emails
      responses:
        '200':
          description: Bulk invitation processed
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Bulk invitation completed"
                  invited:
                    type: integer
                    description: Number of successful invitations sent
                    example: 8
                  skipped:
                    type: integer
                    description: Number of existing users skipped
                    example: 1
                  failed:
                    type: integer
                    description: Number of failed invitations
                    example: 1
                  failures:
                    type: array
                    description: Details of failed invitations
                    items:
                      type: object
                      properties:
                        email:
                          type: string
                        reason:
                          type: string
        '400':
          description: |
            Invalid request. Possible reasons:<br>
            <ul>
            <li>Empty emails array</li>
            <li>Invalid email format in array</li>
            <li>Exceeded maximum (100 emails)</li>
            </ul>
        '401':
          description: Unauthorized - Valid bearer token required
        '403':
          description: |
            Forbidden. Possible reasons:<br>
            <ul>
            <li>Admin privileges required</li>
            <li>Business account required (individual accounts cannot bulk invite)</li>
            </ul>
        '503':
          description: Email service unavailable - SMTP not configured
      x-speakeasy-name-override: bulkInvite
  /users/{id}/resend-invite:
    post:
      tags:
        - Users
      summary: Resend user invite
      description: |
        Resend the invitation email to a user who hasn't completed their account setup.<br><br>
        <b>Overview:</b><br>
        This endpoint resends the invitation email to a user who was previously invited but hasn't logged in yet. Useful when the original invitation email was lost, expired, or ended up in spam.<br><br>
        <b>When to Use:</b><br>
        <ul>
        <li>User didn't receive original invitation</li>
        <li>Invitation link expired</li>
        <li>User forgot to complete setup</li>
        <li>Email went to spam folder</li>
        </ul>
        <b>Requirements:</b><br>
        <ul>
        <li>User must exist in the system</li>
        <li>User must NOT have logged in yet (hasLoggedIn: false)</li>
        <li>SMTP configuration must be active</li>
        <li>Admin privileges required</li>
        </ul>
        <b>What Happens:</b><br>
        <ul>
        <li>Generates a new invitation token</li>
        <li>Invalidates any previous invitation links</li>
        <li>Sends new invitation email</li>
        <li>Resets invitation expiry timer</li>
        </ul>
      operationId: resendUserInvite
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          description: User ID of the user to resend invitation to
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
            example: "507f1f77bcf86cd799439011"
      responses:
        '200':
          description: Invitation resent successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Invitation resent successfully"
                  sentTo:
                    type: string
                    format: email
                    description: Email address the invitation was sent to
        '400':
          description: |
            Invalid request. Possible reasons:<br>
            <ul>
            <li>User has already logged in (no longer pending)</li>
            <li>User account is deleted</li>
            </ul>
        '401':
          description: Unauthorized - Valid bearer token required
        '403':
          description: Forbidden - Admin privileges required
        '404':
          description: User not found
        '503':
          description: Email service unavailable - SMTP not configured
      x-speakeasy-name-override: resendInvite
  /users/graph/list:
    get:
      tags:
        - Users
      summary: List users (paginated with graph data)
      description: |
        Retrieve a paginated list of users with enhanced search capabilities using the graph service.<br><br>
        <b>Overview:</b><br>
        This endpoint provides advanced user listing with full-text search, pagination, and optional relationship data from the knowledge graph. It's optimized for large organizations with thousands of users.<br><br>
        <b>Search Capabilities:</b><br>
        <ul>
        <li>Full-text search across name and email</li>
        <li>Fuzzy matching for typo tolerance</li>
        <li>Results ranked by relevance</li>
        </ul>
        <b>Use Cases:</b><br>
        <ul>
        <li>User directory with search</li>
        <li>Autocomplete user selection</li>
        <li>Admin user management lists</li>
        <li>User analytics dashboards</li>
        </ul>
        <b>Performance:</b><br>
        <ul>
        <li>Powered by graph database for fast queries</li>
        <li>Supports pagination for large datasets</li>
        <li>Results cached for repeated queries</li>
        </ul>
        <b>vs /users endpoint:</b><br>
        Use this endpoint when you need advanced search or are dealing with large user bases. Use <code>/users</code> for simple full-list retrieval.
      operationId: listUsersGraph
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          description: Page number (1-based)
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          description: Number of results per page
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
        - name: search
          in: query
          description: Search query (searches name and email)
          schema:
            type: string
            maxLength: 1000
            example: "john"
        - name: sortBy
          in: query
          description: Field to sort by
          schema:
            type: string
            enum: [fullName, email, createdAt]
            default: fullName
        - name: sortOrder
          in: query
          description: Sort direction
          schema:
            type: string
            enum: [asc, desc]
            default: asc
      responses:
        '200':
          description: Paginated list of users
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/User'
                  pagination:
                    type: object
                    properties:
                      page:
                        type: integer
                        example: 1
                      limit:
                        type: integer
                        example: 10
                      total:
                        type: integer
                        example: 156
                      totalPages:
                        type: integer
                        example: 16
                  total:
                    type: integer
                  page:
                    type: integer
                  limit:
                    type: integer
        '401':
          description: Unauthorized
      x-speakeasy-name-override: listGraph
  /users/teams/list:
    get:
      tags:
        - Users
      summary: Get current user's teams
      description: Get teams that the current user belongs to
      operationId: getCurrentUserTeams
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          schema:
            type: integer
        - name: limit
          in: query
          schema:
            type: integer
        - name: search
          in: query
          schema:
            type: string
      responses:
        '200':
          description: User's teams
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Team'
        '401':
          description: Unauthorized
      x-speakeasy-name-override: listTeams
  # ==================== TEAMS ENDPOINTS ====================
  /teams:
    post:
      tags:
        - Teams
      summary: Create a team
      description: |
        Create a new team within the organization for project collaboration and resource sharing.<br><br>
        <b>Overview:</b><br>
        Teams are collaborative units that group users together for specific projects, departments, or initiatives. Teams have their own resources, permissions, and member hierarchies.<br><br>
        <b>Team Structure:</b><br>
        <ul>
        <li><b>Owner:</b> Creator of the team, full administrative control</li>
        <li><b>Admins:</b> Can manage members and settings</li>
        <li><b>Members:</b> Standard access to team resources</li>
        <li><b>Viewers:</b> Read-only access</li>
        </ul>
        <b>What Gets Created:</b><br>
        <ul>
        <li>Team entity with unique identifier</li>
        <li>Owner role automatically assigned to creator</li>
        <li>Team workspace for shared resources</li>
        <li>Default permission settings</li>
        </ul>
        <b>Initial Members:</b><br>
        You can optionally add initial members with their roles during creation using the <code>userRoles</code> array.<br><br>
        <b>Validation:</b><br>
        <ul>
        <li>Team name is required and must be unique in the org</li>
        <li>Name: 1-100 characters</li>
        <li>Description: Optional, max 500 characters</li>
        </ul>
      operationId: createTeam
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  minLength: 1
                  maxLength: 100
                  description: Team display name (must be unique in org)
                  example: "Engineering Team"
                description:
                  type: string
                  maxLength: 500
                  description: Team description and purpose
                  example: "Core engineering team for product development"
                userRoles:
                  type: array
                  description: Optional initial members with roles
                  items:
                    $ref: '#/components/schemas/UserRole'
              required:
                - name
      responses:
        '201':
          description: Team created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Team created successfully"
                  data:
                    $ref: '#/components/schemas/Team'
        '400':
          description: |
            Invalid request. Possible reasons:<br>
            <ul>
            <li>Missing team name</li>
            <li>Team name already exists</li>
            <li>Invalid user IDs in userRoles</li>
            </ul>
        '401':
          description: Unauthorized - Valid bearer token required
      x-speakeasy-name-override: create
    get:
      tags:
        - Teams
      summary: List teams
      description: |
        Retrieve all teams in the organization with optional search and pagination.<br><br>
        <b>Overview:</b><br>
        This endpoint returns teams the authenticated user can access. Admins see all teams; regular users see teams they're members of.<br><br>
        <b>Response Data per Team:</b><br>
        <ul>
        <li>Team metadata (name, description)</li>
        <li>Member count</li>
        <li>Owner information</li>
        <li>Creation timestamp</li>
        </ul>
        <b>Search:</b><br>
        The search parameter performs fuzzy matching on team names and descriptions.<br><br>
        <b>Visibility Rules:</b><br>
        <ul>
        <li><b>Admins:</b> See all organization teams</li>
        <li><b>Users:</b> See only teams they belong to</li>
        </ul>
        <b>Sorting:</b><br>
        Results are sorted by name alphabetically by default.
      operationId: listTeams
      security:
        - bearerAuth: []
      parameters:
        - name: search
          in: query
          description: Search teams by name or description
          schema:
            type: string
            example: "engineering"
        - name: limit
          in: query
          description: Number of results per page
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
        - name: page
          in: query
          description: Page number (1-based)
          schema:
            type: integer
            minimum: 1
            default: 1
      responses:
        '200':
          description: Teams retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Team'
                  pagination:
                    type: object
                    properties:
                      page:
                        type: integer
                      limit:
                        type: integer
                      total:
                        type: integer
                      totalPages:
                        type: integer
        '401':
          description: Unauthorized - Valid bearer token required
      x-speakeasy-name-override: list
  /teams/{teamId}:
    get:
      tags:
        - Teams
      summary: Get team by ID
      description: |
        Retrieve detailed information about a specific team.<br><br>
        <b>Overview:</b><br>
        Returns complete team details including metadata, member list with roles, and resource information. Use this for team profile pages and detailed views.<br><br>
        <b>Response Includes:</b><br>
        <ul>
        <li>Team metadata (name, description, slug)</li>
        <li>Owner and creator information</li>
        <li>Member count and list (with pagination)</li>
        <li>Team settings and permissions</li>
        <li>Creation and modification timestamps</li>
        </ul>
        <b>Authorization:</b><br>
        <ul>
        <li>Team members can view their team</li>
        <li>Organization admins can view any team</li>
        </ul>
      operationId: getTeamById
      security:
        - bearerAuth: []
      parameters:
        - name: teamId
          in: path
          required: true
          description: Team ID (24-character MongoDB ObjectId)
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
            example: "507f1f77bcf86cd799439011"
      responses:
        '200':
          description: Team details retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Team'
        '401':
          description: Unauthorized - Valid bearer token required
        '403':
          description: Forbidden - Not a team member
        '404':
          description: Team not found
      x-speakeasy-name-override: get
    put:
      tags:
        - Teams
      summary: Update team
      description: |
        Update team metadata and settings.<br><br>
        <b>Overview:</b><br>
        This endpoint allows updating team properties like name and description. Member management is handled through separate endpoints.<br><br>
        <b>Updatable Fields:</b><br>
        <ul>
        <li><code>name</code>: Team display name (must remain unique)</li>
        <li><code>description</code>: Team description</li>
        </ul>
        <b>Authorization:</b><br>
        <ul>
        <li><b>Team Owner:</b> Full update access</li>
        <li><b>Team Admin:</b> Can update name and description</li>
        <li><b>Org Admin:</b> Can update any team</li>
        </ul>
        <b>Side Effects:</b><br>
        <ul>
        <li>Team update event published</li>
        <li>Team slug may be regenerated if name changes</li>
        <li>Cached team data invalidated</li>
        </ul>
      operationId: updateTeam
      security:
        - bearerAuth: []
      parameters:
        - name: teamId
          in: path
          required: true
          description: Team ID (24-character MongoDB ObjectId)
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
            example: "507f1f77bcf86cd799439011"
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  minLength: 1
                  maxLength: 100
                  description: New team name
                  example: "Core Engineering Team"
                description:
                  type: string
                  maxLength: 500
                  description: New team description
                  example: "Primary engineering team for product development"
      responses:
        '200':
          description: Team updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Team updated successfully"
                  data:
                    $ref: '#/components/schemas/Team'
        '400':
          description: |
            Invalid request. Possible reasons:<br>
            <ul>
            <li>Team name already exists</li>
            <li>Invalid field values</li>
            </ul>
        '401':
          description: Unauthorized - Valid bearer token required
        '403':
          description: Forbidden - Insufficient permissions to update this team
        '404':
          description: Team not found
      x-speakeasy-name-override: update
    delete:
      tags:
        - Teams
      summary: Delete team
      description: |
        Delete a team from the organization.<br><br>
        <b>Behavior:</b><br>
        <ul>
        <li>Team is soft-deleted (isDeleted: true)</li>
        <li>Team members lose access to team resources</li>
        <li>Team can be restored by admin if needed</li>
        </ul>
        <b>Restrictions:</b><br>
        <ul>
        <li>Only team owner or organization admin can delete</li>
        <li>Team must have no active resources (configurable)</li>
        </ul>
      operationId: deleteTeam
      security:
        - bearerAuth: []
      parameters:
        - name: teamId
          in: path
          required: true
          description: Unique identifier of the team to delete
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
            example: "507f1f77bcf86cd799439011"
      responses:
        '200':
          description: Team deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Team deleted successfully"
        '401':
          description: Unauthorized - Valid authentication required
        '403':
          description: Forbidden - Only team owner or admin can delete
        '404':
          description: Team not found
      x-speakeasy-name-override: delete
  /teams/{teamId}/users:
    get:
      tags:
        - Teams
      summary: Get team members
      description: |
        Retrieve all users that are members of a specific team.<br><br>
        <b>Response Details:</b><br>
        <ul>
        <li>Returns user profiles with their team role</li>
        <li>Supports pagination for large teams</li>
        <li>Excludes deleted or inactive users</li>
        </ul>
        <b>Team Roles:</b><br>
        <ul>
        <li><code>owner</code> - Full control over team settings and members</li>
        <li><code>admin</code> - Can manage members and most settings</li>
        <li><code>member</code> - Standard team member</li>
        <li><code>viewer</code> - Read-only access to team resources</li>
        </ul>
      operationId: getTeamUsers
      security:
        - bearerAuth: []
      parameters:
        - name: teamId
          in: path
          required: true
          description: Unique identifier of the team
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
            example: "507f1f77bcf86cd799439011"
        - name: page
          in: query
          required: false
          description: Page number for pagination (1-based)
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          required: false
          description: Number of users per page
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
      responses:
        '200':
          description: Team members retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        user:
                          $ref: '#/components/schemas/User'
                        role:
                          type: string
                          enum: [owner, admin, member, viewer]
                        joinedAt:
                          type: string
                          format: date-time
                  pagination:
                    type: object
                    properties:
                      page:
                        type: integer
                        example: 1
                      limit:
                        type: integer
                        example: 20
                      total:
                        type: integer
                        example: 15
        '400':
          description: Invalid team ID format
        '401':
          description: Unauthorized - Valid authentication required
        '403':
          description: Forbidden - Must be team member to view members
        '404':
          description: Team not found
      x-speakeasy-name-override: getUsers
    post:
      tags:
        - Teams
      summary: Add users to team
      description: |
        Add one or more users to a team with specified roles.<br><br>
        <b>Behavior:</b><br>
        <ul>
        <li>Users already in the team are skipped</li>
        <li>Default role is "member" if not specified</li>
        <li>Sends invitation notification to added users</li>
        </ul>
        <b>Validation:</b><br>
        <ul>
        <li>All user IDs must be valid and from the same organization</li>
        <li>Role must be one of the allowed values</li>
        <li>Only team owner/admin can add members</li>
        </ul>
      operationId: addUsersToTeam
      security:
        - bearerAuth: []
      parameters:
        - name: teamId
          in: path
          required: true
          description: Unique identifier of the team
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
            example: "507f1f77bcf86cd799439011"
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                users:
                  type: array
                  items:
                    type: object
                    properties:
                      userId:
                        type: string
                        pattern: '^[a-fA-F0-9]{24}$'
                        description: User ID to add to the team
                      role:
                        type: string
                        enum: [admin, member, viewer]
                        default: member
                        description: Role to assign to the user
                    required:
                      - userId
                  example:
                    - userId: "507f1f77bcf86cd799439012"
                      role: "member"
                    - userId: "507f1f77bcf86cd799439013"
                      role: "admin"
              required:
                - users
      responses:
        '200':
          description: Users added to team successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "2 users added to team successfully"
                  addedCount:
                    type: integer
                    example: 2
                  skippedCount:
                    type: integer
                    description: Number of users already in the team
                    example: 0
        '400':
          description: |
            Invalid request. Possible reasons:<br>
            <ul>
            <li>Invalid team ID or user ID format</li>
            <li>Invalid role specified</li>
            <li>Empty users array</li>
            </ul>
        '401':
          description: Unauthorized - Valid authentication required
        '403':
          description: Forbidden - Only team owner/admin can add members
        '404':
          description: Team or one or more users not found
      x-speakeasy-name-override: addUsers
    delete:
      tags:
        - Teams
      summary: Remove users from team
      description: |
        Remove one or more users from a team.<br><br>
        <b>Behavior:</b><br>
        <ul>
        <li>Users not in the team are silently skipped</li>
        <li>Removed users lose access to team resources immediately</li>
        </ul>
        <b>Restrictions:</b><br>
        <ul>
        <li>Cannot remove the team owner</li>
        <li>Only team owner/admin can remove members</li>
        <li>Admins cannot remove other admins (only owner can)</li>
        </ul>
      operationId: removeUsersFromTeam
      security:
        - bearerAuth: []
      parameters:
        - name: teamId
          in: path
          required: true
          description: Unique identifier of the team
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
            example: "507f1f77bcf86cd799439011"
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                userIds:
                  type: array
                  items:
                    type: string
                    pattern: '^[a-fA-F0-9]{24}$'
                  description: Array of user IDs to remove from the team
                  example: ["507f1f77bcf86cd799439012"]
              required:
                - userIds
      responses:
        '200':
          description: Users removed from team successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "1 user removed from team"
                  removedCount:
                    type: integer
                    example: 1
        '400':
          description: |
            Invalid request. Possible reasons:<br>
            <ul>
            <li>Invalid team ID or user ID format</li>
            <li>Cannot remove team owner</li>
            </ul>
        '401':
          description: Unauthorized - Valid authentication required
        '403':
          description: Forbidden - Only team owner/admin can remove members
        '404':
          description: Team not found
      x-speakeasy-name-override: removeUsers
  /teams/{teamId}/users/permissions:
    put:
      tags:
        - Teams
      summary: Update user role in team
      description: |
        Update a user's role/permissions within a team.<br><br>
        <b>Available Roles:</b><br>
        <ul>
        <li><code>owner</code> - Full control (only one per team, transferable)</li>
        <li><code>admin</code> - Can manage members and settings</li>
        <li><code>member</code> - Standard access</li>
        <li><code>viewer</code> - Read-only access</li>
        </ul>
        <b>Restrictions:</b><br>
        <ul>
        <li>Only team owner can promote to admin</li>
        <li>Only team owner can transfer ownership</li>
        <li>Admins can modify member/viewer roles</li>
        </ul>
      operationId: updateTeamUserPermissions
      security:
        - bearerAuth: []
      parameters:
        - name: teamId
          in: path
          required: true
          description: Unique identifier of the team
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
            example: "507f1f77bcf86cd799439011"
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                userId:
                  type: string
                  pattern: '^[a-fA-F0-9]{24}$'
                  description: ID of the user whose role to update
                  example: "507f1f77bcf86cd799439012"
                role:
                  type: string
                  enum: [owner, admin, member, viewer]
                  description: New role to assign to the user
                  example: "admin"
              required:
                - userId
                - role
      responses:
        '200':
          description: User role updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "User role updated to admin"
                  previousRole:
                    type: string
                    example: "member"
                  newRole:
                    type: string
                    example: "admin"
        '400':
          description: |
            Invalid request. Possible reasons:<br>
            <ul>
            <li>Invalid team ID or user ID format</li>
            <li>Invalid role specified</li>
            <li>User not a member of the team</li>
            </ul>
        '401':
          description: Unauthorized - Valid authentication required
        '403':
          description: |
            Forbidden. Possible reasons:<br>
            <ul>
            <li>Insufficient permissions to modify this role</li>
            <li>Cannot demote yourself as owner</li>
            </ul>
        '404':
          description: Team or user not found
      x-speakeasy-name-override: updatePermissions
  /teams/user/teams:
    get:
      tags:
        - Teams
      summary: Get current user's teams
      description: |
        Retrieve all teams that the authenticated user is a member of.<br><br>
        <b>Response Details:</b><br>
        <ul>
        <li>Includes teams where user is owner, admin, member, or viewer</li>
        <li>Returns user's role in each team</li>
        <li>Sorted by most recently accessed</li>
        </ul>
        <b>Use Cases:</b><br>
        <ul>
        <li>Populating team switcher in UI</li>
        <li>Dashboard team list</li>
        <li>Access control checks</li>
        </ul>
      operationId: getUserTeams
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          required: false
          description: Page number for pagination (1-based)
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          required: false
          description: Number of teams per page
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
      responses:
        '200':
          description: User's teams retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        team:
                          $ref: '#/components/schemas/Team'
                        role:
                          type: string
                          enum: [owner, admin, member, viewer]
                        joinedAt:
                          type: string
                          format: date-time
                  pagination:
                    type: object
                    properties:
                      page:
                        type: integer
                        example: 1
                      limit:
                        type: integer
                        example: 20
                      total:
                        type: integer
                        example: 5
        '401':
          description: Unauthorized - Valid authentication required
      x-speakeasy-name-override: getUser
  /teams/user/teams/created:
    get:
      tags:
        - Teams
      summary: Get teams created by current user
      description: |
        Retrieve all teams that were created by the authenticated user.<br><br>
        <b>Response Details:</b><br>
        <ul>
        <li>Only includes teams where user is the original creator</li>
        <li>User may or may not still be the owner (ownership can be transferred)</li>
        <li>Useful for tracking team creation history</li>
        </ul>
      operationId: getUserCreatedTeams
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          required: false
          description: Page number for pagination (1-based)
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          required: false
          description: Number of teams per page
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
      responses:
        '200':
          description: User's created teams retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        team:
                          $ref: '#/components/schemas/Team'
                        currentRole:
                          type: string
                          enum: [owner, admin, member, viewer, none]
                          description: User's current role (none if no longer a member)
                        createdAt:
                          type: string
                          format: date-time
                  pagination:
                    type: object
                    properties:
                      page:
                        type: integer
                        example: 1
                      limit:
                        type: integer
                        example: 20
                      total:
                        type: integer
                        example: 3
        '401':
          description: Unauthorized - Valid authentication required
      x-speakeasy-name-override: getCreatedByUser
  # ==================== ORGANIZATION ENDPOINTS ====================
  /org/exists:
    get:
      tags:
        - Organizations
      summary: Check if organization exists
      description: |
        Check if any organization has been created in the system. This is typically the first API call made during initial setup.<br><br>
        <b>Overview:</b><br>
        This public endpoint determines whether the system has been initialized with an organization. Used by the frontend to decide whether to show the setup wizard or the login screen.<br><br>
        <b>Use Cases:</b><br>
        <ul>
        <li>First-time setup detection</li>
        <li>Onboarding flow decisions</li>
        <li>System initialization checks</li>
        </ul>
        <b>Response:</b><br>
        <ul>
        <li><code>exists: true</code> - Organization exists, show login</li>
        <li><code>exists: false</code> - No organization, show setup wizard</li>
        </ul>
        <b>Note:</b> This endpoint requires no authentication and is publicly accessible.
      operationId: checkOrgExists
      security: []
      responses:
        '200':
          description: Organization existence check completed
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  exists:
                    type: boolean
                    description: Whether an organization has been created
                    example: true
      x-speakeasy-name-override: checkExists
  /org:
    post:
      tags:
        - Organizations
      summary: Create organization
      description: |
        Create a new organization and its first admin user. This is the initial setup endpoint for new PipesHub installations.<br><br>
        <b>Overview:</b><br>
        This endpoint performs the complete initial setup of a PipesHub instance, including creating the organization entity and its first administrator account. Should only be called once during initial setup.<br><br>
        <b>Setup Flow:</b><br>
        <ol>
        <li>Frontend calls <code>/org/exists</code> to check if setup is needed</li>
        <li>If no organization exists, show setup wizard</li>
        <li>Collect organization and admin details</li>
        <li>Call this endpoint to create organization</li>
        <li>User is automatically logged in as admin</li>
        </ol>
        <b>What Gets Created:</b><br>
        <ul>
        <li>Organization entity with provided details</li>
        <li>Admin user account with provided credentials</li>
        <li>Default user groups (admin, everyone)</li>
        <li>Default system settings</li>
        <li>Initial authentication configuration</li>
        </ul>
        <b>Account Types:</b><br>
        <ul>
        <li><code>individual</code>: Single-user account, limited team features</li>
        <li><code>business</code>: Multi-user organization with full features</li>
        </ul>
        <b>Security:</b><br>
        <ul>
        <li>This endpoint only works if no organization exists</li>
        <li>Password must meet security requirements</li>
        <li>Email verification may be required based on config</li>
        </ul>
      operationId: createOrganization
      security: []
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                accountType:
                  type: string
                  enum: [individual, business]
                  description: Type of organization account
                  example: "business"
                shortName:
                  type: string
                  description: Short display name for the organization
                  example: "Acme"
                registeredName:
                  type: string
                  description: Official registered name (for business accounts)
                  example: "Acme Corporation Inc."
                contactEmail:
                  type: string
                  format: email
                  description: Primary contact email (also used as admin email)
                  example: "admin@acme.com"
                adminFullName:
                  type: string
                  description: Full name of the first admin user
                  example: "John Smith"
                password:
                  type: string
                  format: password
                  minLength: 8
                  description: Password for the admin account (min 8 chars)
                  example: "SecurePassword123!"
              required:
                - accountType
                - contactEmail
                - adminFullName
                - password
      responses:
        '201':
          description: Organization created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Organization created successfully"
                  data:
                    type: object
                    properties:
                      organization:
                        $ref: '#/components/schemas/Organization'
                      adminUser:
                        $ref: '#/components/schemas/User'
                      accessToken:
                        type: string
                        description: JWT token for immediate login
        '400':
          description: |
            Invalid request. Possible reasons:<br>
            <ul>
            <li>Organization already exists</li>
            <li>Invalid email format</li>
            <li>Password too weak</li>
            <li>Missing required fields</li>
            </ul>
        '409':
          description: Conflict - Organization already exists in the system
      x-speakeasy-name-override: create
    get:
      tags:
        - Organizations
      summary: Get current organization
      description: |
        Retrieve details about the authenticated user's organization.<br><br>
        <b>Overview:</b><br>
        This endpoint returns complete information about the current user's organization, including profile data, settings, and configuration. Use this for organization profile pages and settings.<br><br>
        <b>Response Includes:</b><br>
        <ul>
        <li>Organization profile (name, email, address)</li>
        <li>Account type and billing status</li>
        <li>Feature flags and limits</li>
        <li>Branding settings (logo, colors)</li>
        <li>Creation and modification timestamps</li>
        </ul>
        <b>Use Cases:</b><br>
        <ul>
        <li>Organization profile pages</li>
        <li>Settings and configuration screens</li>
        <li>Billing and subscription displays</li>
        <li>White-label branding retrieval</li>
        </ul>
        <b>Note:</b><br>
        All authenticated users can access this endpoint to view their organization's details.
      operationId: getCurrentOrganization
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Organization details retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Organization'
        '401':
          description: Unauthorized - Valid bearer token required
        '404':
          description: Organization not found - User's organization does not exist
      x-speakeasy-name-override: getCurrent
    put:
      tags:
        - Organizations
      summary: Update organization
      description: |
        Update organization profile and settings information.<br><br>
        <b>Overview:</b><br>
        This endpoint allows administrators to update the organization's profile information, contact details, and address. Used in the organization settings section of the admin panel.<br><br>
        <b>Updatable Fields:</b><br>
        <ul>
        <li><code>registeredName</code>: Official registered/legal name of the organization</li>
        <li><code>shortName</code>: Short display name used in UI</li>
        <li><code>phoneNumber</code>: Primary contact phone number</li>
        <li><code>permanentAddress</code>: Full address object with street, city, state, country, postal code</li>
        </ul>
        <b>Restrictions:</b><br>
        <ul>
        <li>Only organization admins can perform updates</li>
        <li>Contact email cannot be changed through this endpoint</li>
        <li>Account type cannot be changed after creation</li>
        </ul>
        <b>Side Effects:</b><br>
        <ul>
        <li>Organization update event is published</li>
        <li>Cached organization data is invalidated</li>
        <li>Changes are reflected immediately across all services</li>
        </ul>
        <b>Validation:</b><br>
        <ul>
        <li>Phone number must be valid international format</li>
        <li>Address fields have maximum length constraints</li>
        <li>Names cannot be empty if provided</li>
        </ul>
      operationId: updateOrganization
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                registeredName:
                  type: string
                  maxLength: 200
                  description: Official registered/legal name
                  example: "Acme Corporation Inc."
                shortName:
                  type: string
                  maxLength: 50
                  description: Short display name for UI
                  example: "Acme Corp"
                phoneNumber:
                  type: string
                  pattern: '^\+?[0-9]{10,15}$'
                  description: Contact phone number (international format)
                  example: "+15551234567"
                permanentAddress:
                  $ref: '#/components/schemas/Address'
      responses:
        '200':
          description: Organization updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Organization updated successfully"
                  data:
                    $ref: '#/components/schemas/Organization'
        '400':
          description: |
            Invalid request. Possible reasons:<br>
            <ul>
            <li>Invalid phone number format</li>
            <li>Field exceeds maximum length</li>
            <li>Invalid address structure</li>
            </ul>
        '401':
          description: Unauthorized - Valid bearer token required
        '403':
          description: Forbidden - Admin privileges required
      x-speakeasy-name-override: update
    delete:
      tags:
        - Organizations
      summary: Delete organization
      description: |
        Permanently delete an organization and all associated data.<br><br>
        <b>WARNING:</b> This action is <b>irreversible</b>.<br><br>
        <b>Data Deleted:</b><br>
        <ul>
        <li>All user accounts in the organization</li>
        <li>All teams and user groups</li>
        <li>All documents and storage data</li>
        <li>All configuration and settings</li>
        </ul>
        <b>Requirements:</b><br>
        <ul>
        <li>Must be the organization owner (super admin)</li>
        <li>Must provide confirmation parameter</li>
        <li>All active subscriptions must be cancelled first</li>
        </ul>
      operationId: deleteOrganization
      security:
        - bearerAuth: []
      parameters:
        - name: confirm
          in: query
          required: true
          description: Must be "DELETE" to confirm deletion
          schema:
            type: string
            enum: [DELETE]
      responses:
        '200':
          description: Organization deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Organization and all associated data have been permanently deleted"
        '400':
          description: |
            Invalid request. Possible reasons:<br>
            <ul>
            <li>Missing or incorrect confirmation parameter</li>
            <li>Active subscriptions exist</li>
            </ul>
        '401':
          description: Unauthorized - Valid authentication required
        '403':
          description: Forbidden - Only organization owner can delete
      x-speakeasy-name-override: delete
  /org/logo:
    put:
      tags:
        - Organizations
      summary: Upload organization logo
      description: |
        Upload or update the organization's logo image.<br><br>
        <b>Supported Formats:</b><br>
        <ul>
        <li>PNG (recommended for transparency)</li>
        <li>JPG/JPEG</li>
        <li>SVG</li>
        <li>WebP</li>
        </ul>
        <b>Requirements:</b><br>
        <ul>
        <li>Maximum file size: 5MB</li>
        <li>Recommended dimensions: 256x256 pixels or higher</li>
        <li>Square aspect ratio recommended</li>
        </ul>
        <b>Side Effects:</b><br>
        <ul>
        <li>Previous logo is replaced</li>
        <li>Multiple sizes may be generated for different use cases</li>
        </ul>
      operationId: uploadOrganizationLogo
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request payload"
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                logo:
                  type: string
                  format: binary
                  description: Logo image file
              required:
                - logo
      responses:
        '200':
          description: Logo uploaded successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  logoUrl:
                    type: string
                    format: uri
                    description: URL to access the uploaded logo
                    example: "https://storage.pipeshub.com/org/507f1f77bcf86cd799439011/logo.png"
        '400':
          description: |
            Invalid request. Possible reasons:<br>
            <ul>
            <li>No file provided</li>
            <li>Invalid file format</li>
            <li>File too large</li>
            </ul>
        '401':
          description: Unauthorized - Valid authentication required
        '403':
          description: Forbidden - Admin privileges required
      x-speakeasy-name-override: uploadLogo
    get:
      tags:
        - Organizations
      summary: Get organization logo
      description: |
        Retrieve the organization's logo image or URL.<br><br>
        <b>Response Formats:</b><br>
        <ul>
        <li>Returns a signed URL to access the logo</li>
        <li>URL is valid for a limited time (typically 1 hour)</li>
        </ul>
        <b>Use Cases:</b><br>
        <ul>
        <li>Displaying logo in navigation/header</li>
        <li>Email templates</li>
        <li>White-label branding</li>
        </ul>
      operationId: getOrganizationLogo
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Logo URL retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  hasLogo:
                    type: boolean
                    description: Whether organization has a custom logo
                    example: true
                  logoUrl:
                    type: string
                    format: uri
                    description: Signed URL to access the logo (null if no logo)
                    example: "https://storage.pipeshub.com/org/507f1f77bcf86cd799439011/logo.png?token=..."
        '401':
          description: Unauthorized - Valid authentication required
        '404':
          description: Organization not found
      x-speakeasy-name-override: getLogo
    delete:
      tags:
        - Organizations
      summary: Delete organization logo
      description: |
        Remove the organization's custom logo.<br><br>
        <b>Behavior:</b><br>
        <ul>
        <li>Logo file is permanently deleted from storage</li>
        <li>Organization reverts to default/placeholder logo</li>
        </ul>
      operationId: deleteOrganizationLogo
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Logo deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Organization logo deleted successfully"
        '401':
          description: Unauthorized - Valid authentication required
        '403':
          description: Forbidden - Admin privileges required
        '404':
          description: No logo exists to delete
      x-speakeasy-name-override: deleteLogo
  /org/onboarding-status:
    get:
      tags:
        - Organizations
      summary: Get onboarding status
      description: |
        Retrieve the organization's onboarding progress and status.<br><br>
        <b>Response Details:</b><br>
        <ul>
        <li>Current onboarding step</li>
        <li>Completion status of each step</li>
        <li>Overall completion percentage</li>
        </ul>
        <b>Onboarding Steps:</b><br>
        <ul>
        <li>Organization profile setup</li>
        <li>Admin account configuration</li>
        <li>Invite team members</li>
        <li>Connect integrations</li>
        <li>Configure settings</li>
        </ul>
      operationId: getOnboardingStatus
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Onboarding status retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      isCompleted:
                        type: boolean
                        description: Whether onboarding is fully complete
                        example: false
                      currentStep:
                        type: string
                        description: Current active onboarding step
                        example: "invite_team"
                      completedSteps:
                        type: array
                        items:
                          type: string
                        example: ["org_profile", "admin_setup"]
                      completionPercentage:
                        type: integer
                        minimum: 0
                        maximum: 100
                        example: 40
                      steps:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: string
                            name:
                              type: string
                            isCompleted:
                              type: boolean
                            isRequired:
                              type: boolean
        '401':
          description: Unauthorized - Valid authentication required
    put:
      tags:
        - Organizations
      summary: Update onboarding status
      description: |
        Update the organization's onboarding progress.<br><br>
        <b>Use Cases:</b><br>
        <ul>
        <li>Mark a step as completed</li>
        <li>Skip optional steps</li>
        <li>Complete entire onboarding</li>
        </ul>
        <b>Behavior:</b><br>
        <ul>
        <li>Steps must be completed in order (unless skippable)</li>
        <li>Completing all required steps marks onboarding as complete</li>
        </ul>
      operationId: updateOnboardingStatus
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                stepId:
                  type: string
                  description: ID of the step to update
                  example: "invite_team"
                action:
                  type: string
                  enum: [complete, skip]
                  description: Action to perform on the step
                  example: "complete"
              required:
                - stepId
                - action
      responses:
        '200':
          description: Onboarding status updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Step 'invite_team' marked as complete"
                  isOnboardingComplete:
                    type: boolean
                    description: Whether all onboarding is now complete
                    example: false
                  nextStep:
                    type: string
                    description: Next step to complete (null if done)
                    example: "connect_integrations"
        '400':
          description: |
            Invalid request. Possible reasons:<br>
            <ul>
            <li>Invalid step ID</li>
            <li>Step cannot be skipped (required)</li>
            <li>Previous required steps not completed</li>
            </ul>
        '401':
          description: Unauthorized - Valid authentication required
  # ==================== USER GROUPS ENDPOINTS ====================
  /user-groups:
    post:
      tags:
        - User Groups
      summary: Create user group
      description: |
        Create a new user group within the organization.<br><br>
        <b>Group Types:</b><br>
        <ul>
        <li><code>admin</code> - Administrative group with elevated privileges</li>
        <li><code>standard</code> - Regular user group</li>
        <li><code>everyone</code> - Automatically includes all organization users</li>
        <li><code>custom</code> - Custom group with manual membership management</li>
        </ul>
        <b>Validation Rules:</b><br>
        <ul>
        <li>Group name must be unique within the organization</li>
        <li>Group name is required and cannot be empty</li>
        <li>Type must be one of the allowed values</li>
        </ul>
        <b>Side Effects:</b><br>
        <ul>
        <li>Creates a unique slug from the group name</li>
        <li>Sets createdBy to the authenticated user</li>
        </ul>
      operationId: createUserGroup
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  description: Display name for the group
                  example: "Engineering Team"
                type:
                  type: string
                  enum: [admin, standard, everyone, custom]
                  description: Group type determining behavior and privileges
                  example: "standard"
                description:
                  type: string
                  description: Optional description of the group's purpose
                  example: "All engineering department members"
              required:
                - name
                - type
      responses:
        '201':
          description: User group created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserGroup'
        '400':
          description: |
            Invalid request. Possible reasons:<br>
            <ul>
            <li>Missing required fields (name, type)</li>
            <li>Invalid group type</li>
            <li>Group name already exists</li>
            </ul>
        '401':
          description: Unauthorized - Valid authentication required
        '403':
          description: Forbidden - Admin privileges required
      x-speakeasy-group: userGroups
      x-speakeasy-name-override: create
    get:
      tags:
        - User Groups
      summary: Get all user groups
      description: |
        Retrieve all user groups in the organization.<br><br>
        <b>Response Details:</b><br>
        <ul>
        <li>Returns all groups including admin, standard, everyone, and custom types</li>
        <li>Groups are returned with their member counts</li>
        <li>Soft-deleted groups are excluded by default</li>
        </ul>
        <b>Use Cases:</b><br>
        <ul>
        <li>Populating group selection dropdowns</li>
        <li>Managing group memberships</li>
        <li>Access control configuration</li>
        </ul>
      operationId: getAllUserGroups
      security:
        - bearerAuth: []
      responses:
        '200':
          description: List of user groups retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/UserGroup'
        '401':
          description: Unauthorized - Valid authentication required
        '403':
          description: Forbidden - Admin privileges required
      x-speakeasy-group: userGroups
      x-speakeasy-name-override: list
  /user-groups/{groupId}:
    get:
      tags:
        - User Groups
      summary: Get user group by ID
      description: |
        Retrieve detailed information about a specific user group.<br><br>
        <b>Response Includes:</b><br>
        <ul>
        <li>Group metadata (name, type, description)</li>
        <li>Member count</li>
        <li>Creation and modification timestamps</li>
        <li>Creator information</li>
        </ul>
      operationId: getUserGroupById
      security:
        - bearerAuth: []
      parameters:
        - name: groupId
          in: path
          required: true
          description: Unique identifier of the user group
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
            example: "507f1f77bcf86cd799439011"
      responses:
        '200':
          description: User group details retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserGroup'
        '400':
          description: Invalid group ID format
        '401':
          description: Unauthorized - Valid authentication required
        '404':
          description: User group not found
      x-speakeasy-group: userGroups
      x-speakeasy-name-override: getById
    put:
      tags:
        - User Groups
      summary: Update user group
      description: |
        Update an existing user group's information.<br><br>
        <b>Updatable Fields:</b><br>
        <ul>
        <li><code>name</code> - Display name (must remain unique)</li>
        <li><code>description</code> - Group description</li>
        </ul>
        <b>Note:</b> Group type cannot be changed after creation.
      operationId: updateUserGroup
      security:
        - bearerAuth: []
      parameters:
        - name: groupId
          in: path
          required: true
          description: Unique identifier of the user group to update
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
            example: "507f1f77bcf86cd799439011"
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  description: New display name for the group
                  example: "Engineering Team - Updated"
                description:
                  type: string
                  description: Updated description
                  example: "All engineering and DevOps members"
      responses:
        '200':
          description: User group updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserGroup'
        '400':
          description: |
            Invalid request. Possible reasons:<br>
            <ul>
            <li>Invalid group ID format</li>
            <li>Group name already exists</li>
            </ul>
        '401':
          description: Unauthorized - Valid authentication required
        '403':
          description: Forbidden - Admin privileges required
        '404':
          description: User group not found
      x-speakeasy-group: userGroups
      x-speakeasy-name-override: update
    delete:
      tags:
        - User Groups
      summary: Delete user group
      description: |
        Soft delete a user group.<br><br>
        <b>Behavior:</b><br>
        <ul>
        <li>Group is marked as deleted (isDeleted: true)</li>
        <li>Group members are not affected</li>
        <li>Group can be restored by admin if needed</li>
        </ul>
        <b>Restrictions:</b><br>
        <ul>
        <li>Cannot delete system groups (admin, everyone)</li>
        <li>Requires admin privileges</li>
        </ul>
      operationId: deleteUserGroup
      security:
        - bearerAuth: []
      parameters:
        - name: groupId
          in: path
          required: true
          description: Unique identifier of the user group to delete
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
            example: "507f1f77bcf86cd799439011"
      responses:
        '200':
          description: User group deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "User group deleted successfully"
        '400':
          description: |
            Invalid request. Cannot delete system groups.
        '401':
          description: Unauthorized - Valid authentication required
        '403':
          description: Forbidden - Admin privileges required
        '404':
          description: User group not found
      x-speakeasy-group: userGroups
      x-speakeasy-name-override: delete
  /user-groups/add-users:
    post:
      tags:
        - User Groups
      summary: Add users to group
      description: |
        Add one or more users to a user group.<br><br>
        <b>Behavior:</b><br>
        <ul>
        <li>Users already in the group are silently skipped</li>
        <li>Invalid user IDs are reported in the response</li>
        <li>Operation is atomic - all valid users are added together</li>
        </ul>
        <b>Validation:</b><br>
        <ul>
        <li>All user IDs must be valid MongoDB ObjectIds</li>
        <li>Users must belong to the same organization</li>
        <li>Group must exist and not be deleted</li>
        </ul>
      operationId: addUsersToGroup
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                groupId:
                  type: string
                  pattern: '^[a-fA-F0-9]{24}$'
                  description: ID of the group to add users to
                  example: "507f1f77bcf86cd799439011"
                userIds:
                  type: array
                  items:
                    type: string
                    pattern: '^[a-fA-F0-9]{24}$'
                  description: Array of user IDs to add to the group
                  example: ["507f1f77bcf86cd799439012", "507f1f77bcf86cd799439013"]
              required:
                - groupId
                - userIds
      responses:
        '200':
          description: Users added to group successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "2 users added to group successfully"
                  addedCount:
                    type: integer
                    example: 2
                  skippedCount:
                    type: integer
                    description: Number of users already in the group
                    example: 0
        '400':
          description: |
            Invalid request. Possible reasons:<br>
            <ul>
            <li>Invalid group ID or user ID format</li>
            <li>Empty userIds array</li>
            </ul>
        '401':
          description: Unauthorized - Valid authentication required
        '403':
          description: Forbidden - Admin privileges required
        '404':
          description: Group or one or more users not found
      x-speakeasy-group: userGroups
      x-speakeasy-name-override: addUsers
  /user-groups/remove-users:
    post:
      tags:
        - User Groups
      summary: Remove users from group
      description: |
        Remove one or more users from a user group.<br><br>
        <b>Behavior:</b><br>
        <ul>
        <li>Users not in the group are silently skipped</li>
        <li>Operation is atomic - all specified users are removed together</li>
        </ul>
        <b>Restrictions:</b><br>
        <ul>
        <li>Cannot remove users from "everyone" group type</li>
        <li>Cannot remove the last admin from admin group</li>
        </ul>
      operationId: removeUsersFromGroup
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                groupId:
                  type: string
                  pattern: '^[a-fA-F0-9]{24}$'
                  description: ID of the group to remove users from
                  example: "507f1f77bcf86cd799439011"
                userIds:
                  type: array
                  items:
                    type: string
                    pattern: '^[a-fA-F0-9]{24}$'
                  description: Array of user IDs to remove from the group
                  example: ["507f1f77bcf86cd799439012"]
              required:
                - groupId
                - userIds
      responses:
        '200':
          description: Users removed from group successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "1 user removed from group successfully"
                  removedCount:
                    type: integer
                    example: 1
        '400':
          description: |
            Invalid request. Possible reasons:<br>
            <ul>
            <li>Invalid group ID or user ID format</li>
            <li>Cannot remove from "everyone" group</li>
            <li>Cannot remove last admin from admin group</li>
            </ul>
        '401':
          description: Unauthorized - Valid authentication required
        '403':
          description: Forbidden - Admin privileges required
        '404':
          description: Group not found
      x-speakeasy-group: userGroups
      x-speakeasy-name-override: removeUsers
  /user-groups/{groupId}/users:
    get:
      tags:
        - User Groups
      summary: Get users in a group
      description: |
        Retrieve all users that belong to a specific user group.<br><br>
        <b>Response Details:</b><br>
        <ul>
        <li>Returns user profiles with basic information</li>
        <li>Supports pagination for large groups</li>
        <li>Excludes deleted users</li>
        </ul>
      operationId: getUsersInGroup
      security:
        - bearerAuth: []
      parameters:
        - name: groupId
          in: path
          required: true
          description: Unique identifier of the user group
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
            example: "507f1f77bcf86cd799439011"
        - name: page
          in: query
          required: false
          description: Page number for pagination (1-based)
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          required: false
          description: Number of users per page
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
      responses:
        '200':
          description: Users in group retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/User'
                  pagination:
                    type: object
                    properties:
                      page:
                        type: integer
                        example: 1
                      limit:
                        type: integer
                        example: 20
                      total:
                        type: integer
                        example: 45
                      totalPages:
                        type: integer
                        example: 3
        '400':
          description: Invalid group ID format
        '401':
          description: Unauthorized - Valid authentication required
        '404':
          description: User group not found
      x-speakeasy-group: userGroups
      x-speakeasy-name-override: getUsers
  /user-groups/users/{userId}:
    get:
      tags:
        - User Groups
      summary: Get groups for a user
      description: |
        Retrieve all user groups that a specific user belongs to.<br><br>
        <b>Response Details:</b><br>
        <ul>
        <li>Includes all group types (admin, standard, everyone, custom)</li>
        <li>Returns group metadata for each membership</li>
        </ul>
        <b>Use Cases:</b><br>
        <ul>
        <li>Displaying user's group memberships in profile</li>
        <li>Access control checks</li>
        <li>Permission inheritance calculations</li>
        </ul>
      operationId: getGroupsForUser
      security:
        - bearerAuth: []
      parameters:
        - name: userId
          in: path
          required: true
          description: Unique identifier of the user
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
            example: "507f1f77bcf86cd799439012"
      responses:
        '200':
          description: User's groups retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/UserGroup'
        '400':
          description: Invalid user ID format
        '401':
          description: Unauthorized - Valid authentication required
        '404':
          description: User not found
      x-speakeasy-group: userGroups
      x-speakeasy-name-override: getUserGroups
  /user-groups/stats/list:
    get:
      tags:
        - User Groups
      summary: Get user group statistics
      description: |
        Retrieve statistics for all user groups in the organization.<br><br>
        <b>Statistics Include:</b><br>
        <ul>
        <li>Total number of groups by type</li>
        <li>Member counts per group</li>
        <li>Active vs deleted groups</li>
        <li>Recently created/modified groups</li>
        </ul>
        <b>Use Cases:</b><br>
        <ul>
        <li>Admin dashboard displays</li>
        <li>Organization analytics</li>
        <li>Capacity planning</li>
        </ul>
      operationId: getUserGroupStats
      security:
        - bearerAuth: []
      responses:
        '200':
          description: User group statistics retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      totalGroups:
                        type: integer
                        example: 12
                      groupsByType:
                        type: object
                        properties:
                          admin:
                            type: integer
                            example: 1
                          standard:
                            type: integer
                            example: 5
                          everyone:
                            type: integer
                            example: 1
                          custom:
                            type: integer
                            example: 5
                      totalMembers:
                        type: integer
                        description: Sum of all group memberships (may include duplicates)
                        example: 156
                      groups:
                        type: array
                        items:
                          type: object
                          properties:
                            _id:
                              type: string
                            name:
                              type: string
                            type:
                              type: string
                            memberCount:
                              type: integer
        '401':
          description: Unauthorized - Valid authentication required
        '403':
          description: Forbidden - Admin privileges required
      x-speakeasy-group: userGroups
      x-speakeasy-name-override: getStats
  # ==================== STORAGE ENDPOINTS ====================
  /document/upload:
    post:
      tags:
        - Document Upload
      summary: Upload a new document
      description: |
        Upload a new document to PipesHub storage. Supports multiple storage backends including S3, Azure Blob, and local storage.<br><br>
        <b>Overview:</b><br>
        This endpoint handles document uploads with automatic processing, metadata extraction, and optional versioning. It's the primary endpoint for adding new files to PipesHub.<br><br>
        <b>Upload Flow:</b><br>
        <ol>
        <li>Client sends file with metadata via multipart/form-data</li>
        <li>Document metadata saved to database</li>
        <li>Returns document object with storage URLs</li>
        </ol>
        <b>File Size Limits:</b><br>
        <ul>
        <li><b>Maximum:</b> 1GB (1,073,741,824 bytes)</li>
        <li><b>Large file threshold:</b> 10MB (triggers direct upload flow)</li>
        </ul>
        <b>Supported File Types:</b><br>
        <ul>
        <li><b>Documents:</b> PDF, DOCX, DOC, XLSX, XLS, PPTX, PPT, TXT, MD, CSV</li>
        <li><b>Images:</b> PNG, JPG, JPEG, GIF, WebP, SVG, BMP, TIFF</li>
        <li><b>Videos:</b> MP4, AVI, MOV, MKV, WebM</li>
        <li><b>Audio:</b> MP3, WAV, FLAC, AAC</li>
        <li><b>Archives:</b> ZIP, RAR, 7Z, TAR, GZ</li>
        </ul>
        <b>Version Control:</b><br>
        Set <code>isVersionedFile: "true"</code> to enable version tracking. Versioned documents maintain full history of all changes.<br><br>
        <b>Response Headers:</b><br>
        <ul>
        <li><code>x-document-id</code>: Unique document identifier</li>
        <li><code>x-document-name</code>: Document name as stored</li>
        </ul>
        <b>Storage Backends:</b><br>
        Automatically routes to configured storage: Amazon S3, Azure Blob Storage, or Local filesystem.
      operationId: uploadDocument
      x-speakeasy-errors:
        statusCodes:
          - "308"
          - "4XX"
          - "5XX"
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request payload"
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                documentName:
                  type: string
                  description: Display name for the document
                  example: "Q4 Financial Report.pdf"
                documentPath:
                  type: string
                  description: Virtual folder path for organization
                  example: "/reports/finance/2024"
                alternateDocumentName:
                  type: string
                  description: Alternative name for search/display
                  example: "2024-Q4-Finance"
                permissions:
                  type: string
                  enum: [owner, editor, commentator, readonly]
                  description: Default permission level for shared access
                  default: owner
                customMetadata:
                  type: string
                  description: JSON string of custom key-value metadata
                  example: '{"department":"finance","quarter":"Q4"}'
                isVersionedFile:
                  type: string
                  enum: ["true", "false"]
                  description: Enable version control for this document
                  example: "true"
                file:
                  type: string
                  format: binary
                  description: The file to upload (max 1GB)
              required:
                - documentName
                - isVersionedFile
                - file
      responses:
        '200':
          description: Document uploaded successfully
          headers:
            x-document-id:
              description: Unique identifier of the created document
              schema:
                type: string
            x-document-name:
              description: Document name as stored
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Document'
        '308':
          description: |
            Permanent Redirect - File requires direct upload.<br>
            For files &gt;10MB, client should upload directly to the URL in the Location header.
          headers:
            Location:
              description: Presigned URL for direct upload to storage
              schema:
                type: string
                format: uri
            x-document-id:
              description: Document ID for follow-up requests
              schema:
                type: string
        '400':
          description: |
            Invalid request. Possible reasons:<br>
            <ul>
            <li>Missing required fields</li>
            <li>Unsupported file type</li>
            <li>File exceeds size limit (1GB)</li>
            <li>Invalid metadata format</li>
            </ul>
        '401':
          description: Unauthorized - Valid bearer token required
        '413':
          description: File too large - Maximum size is 1GB
      x-speakeasy-group: documentUpload
      x-speakeasy-name-override: upload
  /document/placeholder:
    post:
      tags:
        - Document Upload
      summary: Create document placeholder
      description: |
        Create a document metadata record without uploading file content. Used in conjunction with direct upload for large files.<br><br>
        <b>Overview:</b><br>
        This endpoint creates a document entry in the database without actual file content. The file is then uploaded directly to storage using the <code>/directUpload</code> endpoint.<br><br>
        <b>Direct Upload Flow:</b><br>
        <ol>
        <li>Call this endpoint to create document placeholder</li>
        <li>Receive document ID in response</li>
        <li>Call <code>/document/{documentId}/directUpload</code> to get presigned URL</li>
        <li>Upload file directly to presigned URL</li>
        <li>Document becomes accessible once upload completes</li>
        </ol>
        <b>Use Cases:</b><br>
        <ul>
        <li>Large file uploads (bypassing server)</li>
        <li>Client-side upload progress tracking</li>
        <li>Resumable uploads</li>
        <li>Reduced server memory usage</li>
        </ul>
        <b>Note:</b> Extension must be provided without the dot (e.g., "pdf" not ".pdf").
      operationId: createDocumentPlaceholder
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                documentName:
                  type: string
                  description: Display name for the document
                  example: "Large Video File.mp4"
                alternateDocumentName:
                  type: string
                  description: Alternative name for search/display
                documentPath:
                  type: string
                  description: Virtual folder path
                  example: "/videos/training"
                permissions:
                  type: string
                  enum: [owner, editor, commentator, readonly]
                  default: owner
                metaData:
                  type: object
                  description: Custom metadata key-value pairs
                isVersionedFile:
                  type: boolean
                  description: Enable version control
                  default: false
                extension:
                  type: string
                  description: File extension WITHOUT dot
                  example: "mp4"
              required:
                - documentName
                - documentPath
                - extension
      responses:
        '200':
          description: Document placeholder created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Document'
        '400':
          description: |
            Invalid request. Possible reasons:<br>
            <ul>
            <li>Missing required fields</li>
            <li>Invalid extension</li>
            </ul>
        '401':
          description: Unauthorized - Valid bearer token required
      x-speakeasy-group: documentUpload
      x-speakeasy-name-override: createPlaceholder
  /document/{documentId}:
    get:
      tags:
        - Document Management
      summary: Get document by ID
      description: |
        Retrieve complete document metadata by its unique identifier.<br><br>
        <b>Overview:</b><br>
        Returns all document information including metadata, version history, storage location, and access permissions. Use this to display document details or prepare for download/edit operations.<br><br>
        <b>Response Includes:</b><br>
        <ul>
        <li>Document metadata (name, path, size, type)</li>
        <li>Storage information (vendor, URLs)</li>
        <li>Version history (if versioned)</li>
        <li>Permission settings</li>
        <li>Custom metadata</li>
        <li>Timestamps (created, updated)</li>
        </ul>
        <b>Authorization:</b><br>
        Document must belong to the requesting user's organization.<br><br>
        <b>Note:</b> Soft-deleted documents (isDeleted: true) are not returned.
      operationId: getDocumentById
      security:
        - bearerAuth: []
      parameters:
        - name: documentId
          in: path
          required: true
          description: Document ID (24-character MongoDB ObjectId)
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
            example: "507f1f77bcf86cd799439011"
      responses:
        '200':
          description: Document details retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Document'
        '400':
          description: Invalid document ID format
        '401':
          description: Unauthorized - Valid bearer token required
        '404':
          description: Document not found or has been deleted
      x-speakeasy-group: documentManagement
      x-speakeasy-name-override: getById
    delete:
      tags:
        - Document Management
      summary: Delete document
      description: |
        Soft delete a document from the system. The document is marked as deleted but not permanently removed.<br><br>
        <b>Overview:</b><br>
        This endpoint performs a soft delete, marking the document as deleted while preserving its data for potential recovery or audit purposes.<br><br>
        <b>What Happens on Delete:</b><br>
        <ul>
        <li><code>isDeleted</code> flag set to true</li>
        <li><code>deletedByUserId</code> recorded</li>
        <li>Document excluded from normal queries</li>
        <li>File remains in storage (soft delete)</li>
        </ul>
        <b>Restrictions:</b><br>
        <ul>
        <li>Document must belong to user's organization</li>
        <li>User must have appropriate permissions</li>
        </ul>
        <b>Recovery:</b><br>
        Soft-deleted documents can be restored by administrators if needed.
      operationId: deleteDocumentById
      security:
        - bearerAuth: []
      parameters:
        - name: documentId
          in: path
          required: true
          description: Document ID (24-character MongoDB ObjectId)
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
            example: "507f1f77bcf86cd799439011"
      responses:
        '200':
          description: Document deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Document deleted successfully"
                  data:
                    type: object
                    properties:
                      _id:
                        type: string
                      isDeleted:
                        type: boolean
                        example: true
                      deletedByUserId:
                        type: string
        '401':
          description: Unauthorized - Valid bearer token required
        '404':
          description: Document not found
      x-speakeasy-group: documentManagement
      x-speakeasy-name-override: delete
  /document/{documentId}/download:
    get:
      tags:
        - Document Management
      summary: Download document
      description: |
        Get a time-limited signed URL to download the document, or receive the file directly for local storage.<br><br>
        <b>Overview:</b><br>
        This endpoint generates secure download access to documents. For cloud storage (S3/Azure), it returns a presigned URL. For local storage, it streams the file directly.<br><br>
        <b>Download Behavior by Storage:</b><br>
        <ul>
        <li><b>S3/Azure:</b> Returns presigned URL valid for specified duration</li>
        <li><b>Local:</b> Streams file directly with appropriate headers</li>
        </ul>
        <b>Version Download:</b><br>
        Specify the <code>version</code> parameter to download a specific historical version. Only available for versioned documents.<br><br>
        <b>URL Expiration:</b><br>
        <ul>
        <li>Default: 3600 seconds (1 hour)</li>
        <li>Configurable via <code>expirationTimeInSeconds</code></li>
        <li>Maximum depends on storage provider limits</li>
        </ul>
        <b>Security:</b><br>
        Signed URLs are single-use and time-limited. They can be safely shared for temporary access.
      operationId: downloadDocument
      security:
        - bearerAuth: []
      parameters:
        - name: documentId
          in: path
          required: true
          description: Document ID (24-character MongoDB ObjectId)
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
            example: "507f1f77bcf86cd799439011"
        - name: version
          in: query
          required: false
          description: Version number to download (0-indexed). Must be less than total versions.
          schema:
            type: integer
            minimum: 0
            example: 2
        - name: expirationTimeInSeconds
          in: query
          required: false
          description: Signed URL validity duration in seconds
          schema:
            type: integer
            minimum: 1
            maximum: 86400
            default: 3600
            example: 7200
      responses:
        '200':
          description: Download URL generated or file stream
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  signedUrl:
                    type: string
                    format: uri
                    description: Presigned URL for download (S3/Azure only)
                    example: "https://bucket.s3.amazonaws.com/docs/file.pdf?X-Amz-Signature=..."
            application/octet-stream:
              schema:
                type: string
                format: binary
                description: Direct file stream (local storage only)
        '400':
          description: |
            Invalid request. Possible reasons:<br>
            <ul>
            <li>Invalid version number</li>
            <li>Version requested for non-versioned document</li>
            <li>Version exceeds available versions</li>
            </ul>
        '401':
          description: Unauthorized - Valid bearer token required
        '404':
          description: Document not found
      x-speakeasy-group: documentManagement
      x-speakeasy-name-override: download
  /document/{documentId}/buffer:
    get:
      tags:
        - Document Buffer
      summary: Get document buffer
      description: |
        Retrieve the raw binary content of a document as a buffer. Used for in-memory document processing.<br><br>
        <b>Overview:</b><br>
        Returns the complete file content as a binary buffer. This is useful for server-side document processing, content analysis, or format conversion.<br><br>
        <b>Use Cases:</b><br>
        <ul>
        <li>Document parsing and text extraction</li>
        <li>Format conversion pipelines</li>
        <li>Content analysis and indexing</li>
        <li>Thumbnail generation</li>
        </ul>
        <b>Version Support:</b><br>
        Specify <code>version</code> to get a specific historical version's content.<br><br>
        <b>Memory Considerations:</b><br>
        Large files will consume significant memory. For files &gt;100MB, consider using streaming download instead.<br><br>
        <b>Response Format:</b><br>
        Returns Node.js Buffer object serialized as JSON with type and data array.
      operationId: getDocumentBuffer
      security:
        - bearerAuth: []
      parameters:
        - name: documentId
          in: path
          required: true
          description: Document ID (24-character MongoDB ObjectId)
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
            example: "507f1f77bcf86cd799439011"
        - name: version
          in: query
          required: false
          description: Version number to retrieve (0-indexed)
          schema:
            type: integer
            minimum: 0
      responses:
        '200':
          description: Document buffer retrieved successfully
          content:
            application/octet-stream:
              schema:
                type: string
                format: binary
                description: Raw file content as binary buffer
        '400':
          description: Invalid version number
        '401':
          description: Unauthorized - Valid bearer token required
        '404':
          description: Document not found
      x-speakeasy-group: documentBuffer
      x-speakeasy-name-override: get
    put:
      tags:
        - Document Buffer
      summary: Update document buffer
      description: |
        Replace the document's file content with a new file. Updates the current version without creating version history.<br><br>
        <b>Overview:</b><br>
        This endpoint replaces the document's content in storage. Use this for quick updates that don't need version tracking.<br><br>
        <b>When to Use:</b><br>
        <ul>
        <li>Updating draft documents</li>
        <li>Replacing temporary files</li>
        <li>Quick fixes without version history</li>
        </ul>
        <b>For Version Tracking:</b><br>
        Use <code>/uploadNextVersion</code> instead if you need to maintain version history.<br><br>
        <b>File Constraints:</b><br>
        <ul>
        <li>Maximum size: 100MB</li>
        <li>File extension must match original document</li>
        </ul>
        <b>Side Effects:</b><br>
        <ul>
        <li>Increments <code>mutationCount</code></li>
        <li>Updates <code>sizeInBytes</code></li>
        <li>Updates <code>updatedAt</code> timestamp</li>
        </ul>
      operationId: updateDocumentBuffer
      security:
        - bearerAuth: []
      parameters:
        - name: documentId
          in: path
          required: true
          description: Document ID (24-character MongoDB ObjectId)
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
            example: "507f1f77bcf86cd799439011"
      requestBody:
        required: true
        description: "Request payload"
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - file
              properties:
                file:
                  type: string
                  format: binary
                  description: New file content (max 100MB)
      responses:
        '200':
          description: Buffer updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Document buffer updated successfully"
        '400':
          description: |
            Invalid request. Possible reasons:<br>
            <ul>
            <li>File extension mismatch</li>
            <li>File exceeds 100MB limit</li>
            </ul>
        '401':
          description: Unauthorized - Valid bearer token required
        '404':
          description: Document not found
      x-speakeasy-group: documentBuffer
      x-speakeasy-name-override: update
  /document/{documentId}/uploadNextVersion:
    post:
      tags:
        - Version Control
      summary: Upload next version
      description: |
        Upload a new version of a versioned document, maintaining full version history.<br><br>
        <b>Overview:</b><br>
        This endpoint creates a new version entry in the document's version history. The previous version remains accessible and the document can be rolled back if needed.<br><br>
        <b>Version Control Flow:</b><br>
        <ol>
        <li>Upload new file content</li>
        <li>System compares with previous version</li>
        <li>If different, creates new version entry</li>
        <li>Updates version history with metadata</li>
        <li>Current document points to new version</li>
        </ol>
        <b>Version Entry Contains:</b><br>
        <ul>
        <li>Version number (auto-incremented)</li>
        <li>Storage URL for this version</li>
        <li>Size and extension</li>
        <li>Optional note describing changes</li>
        <li>User who created version</li>
        <li>Timestamp</li>
        </ul>
        <b>Requirements:</b><br>
        <ul>
        <li>Document must have <code>isVersionedFile: true</code></li>
        <li>File extension must match original document</li>
        <li>Content must differ from previous version</li>
        </ul>
        <b>File Constraints:</b><br>
        <ul>
        <li>Maximum size: 100MB</li>
        <li>Same extension as original required</li>
        </ul>
      operationId: uploadNextVersion
      security:
        - bearerAuth: []
      parameters:
        - name: documentId
          in: path
          required: true
          description: Document ID (24-character MongoDB ObjectId)
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
            example: "507f1f77bcf86cd799439011"
      requestBody:
        required: true
        description: "Request payload"
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - file
              properties:
                currentVersionNote:
                  type: string
                  description: Note describing the current version being replaced
                  example: "Draft version with initial content"
                nextVersionNote:
                  type: string
                  description: Note describing the new version being uploaded
                  example: "Final version with all revisions incorporated"
                file:
                  type: string
                  format: binary
                  description: New version file (max 100MB)
      responses:
        '200':
          description: New version uploaded successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Version 3 uploaded successfully"
                  data:
                    $ref: '#/components/schemas/Document'
        '400':
          description: |
            Invalid request. Possible reasons:<br>
            <ul>
            <li>Document is not versioned</li>
            <li>File extension mismatch</li>
            <li>Content identical to previous version</li>
            <li>File exceeds 100MB limit</li>
            </ul>
        '401':
          description: Unauthorized - Valid bearer token required
        '403':
          description: |
            Forbidden. Possible reasons:<br>
            <ul>
            <li>File extension doesn't match original</li>
            </ul>
        '404':
          description: Document not found
      x-speakeasy-group: versionControl
      x-speakeasy-name-override: uploadNext
  /document/{documentId}/rollBack:
    post:
      tags:
        - Version Control
      summary: Rollback to previous version
      description: |
        Restore a versioned document to a previous version. Creates a new version entry with the rolled-back content.<br><br>
        <b>Overview:</b><br>
        This endpoint allows reverting a document to any previous version while maintaining the complete version history. The rollback itself creates a new version entry.<br><br>
        <b>Rollback Flow:</b><br>
        <ol>
        <li>Specify target version number to rollback to</li>
        <li>System retrieves content from that version</li>
        <li>Creates new version entry with restored content</li>
        <li>Adds rollback note to version history</li>
        <li>Document now shows restored content</li>
        </ol>
        <b>Version History Preserved:</b><br>
        Rollback does NOT delete intermediate versions. Full history remains intact for audit purposes.<br><br>
        <b>Requirements:</b><br>
        <ul>
        <li>Document must be versioned</li>
        <li>Target version must exist (less than current version count)</li>
        <li>Note explaining rollback reason is required</li>
        </ul>
        <b>Use Cases:</b><br>
        <ul>
        <li>Reverting accidental changes</li>
        <li>Restoring to known-good state</li>
        <li>Undoing problematic updates</li>
        </ul>
      operationId: rollBackToPreviousVersion
      security:
        - bearerAuth: []
      parameters:
        - name: documentId
          in: path
          required: true
          description: Document ID (24-character MongoDB ObjectId)
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
            example: "507f1f77bcf86cd799439011"
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                version:
                  type: string
                  description: Version number to rollback to (0-indexed)
                  example: "2"
                note:
                  type: string
                  description: Reason for rollback (required for audit trail)
                  example: "Reverting to version 2 due to incorrect data in version 3"
              required:
                - version
                - note
      responses:
        '200':
          description: Document rolled back successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Document rolled back to version 2"
                  data:
                    $ref: '#/components/schemas/Document'
        '400':
          description: |
            Invalid request. Possible reasons:<br>
            <ul>
            <li>Document is not versioned</li>
            <li>Invalid version number</li>
            <li>Version doesn't exist</li>
            <li>Missing rollback note</li>
            </ul>
        '401':
          description: Unauthorized - Valid bearer token required
        '404':
          description: Document not found
      x-speakeasy-group: versionControl
      x-speakeasy-name-override: rollBack
  /document/{documentId}/directUpload:
    post:
      tags:
        - Document Upload
      summary: Get direct upload URL
      description: |
        Generate a presigned URL for direct client-to-storage upload, bypassing the server for large files.<br><br>
        <b>Overview:</b><br>
        This endpoint provides a presigned URL that allows clients to upload directly to storage (S3/Azure) without routing through the server. Essential for large file uploads.<br><br>
        <b>Direct Upload Flow:</b><br>
        <ol>
        <li>Create document placeholder with <code>/placeholder</code></li>
        <li>Call this endpoint with document ID</li>
        <li>Receive presigned URL and document ID</li>
        <li>Client uploads file directly to presigned URL (PUT request)</li>
        <li>Document becomes available once upload completes</li>
        </ol>
        <b>Benefits:</b><br>
        <ul>
        <li>No server memory consumption for large files</li>
        <li>Direct transfer to storage (faster)</li>
        <li>Client-side progress tracking</li>
        <li>Reduced server bandwidth</li>
        </ul>
        <b>URL Validity:</b><br>
        Presigned URLs typically expire after 1 hour. Upload must complete before expiration.<br><br>
        <b>Note:</b> Only available for S3 and Azure Blob storage. Local storage does not support direct upload.
      operationId: getDirectUploadUrl
      security:
        - bearerAuth: []
      parameters:
        - name: documentId
          in: path
          required: true
          description: Document ID from placeholder creation
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
            example: "507f1f77bcf86cd799439011"
      responses:
        '200':
          description: Direct upload URL generated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  signedUrl:
                    type: string
                    format: uri
                    description: Presigned URL for direct PUT upload
                    example: "https://bucket.s3.amazonaws.com/path/file.pdf?X-Amz-Signature=..."
                  documentId:
                    type: string
                    description: Document ID for reference
                    example: "507f1f77bcf86cd799439011"
        '400':
          description: |
            Invalid request. Possible reasons:<br>
            <ul>
            <li>Document doesn't exist</li>
            <li>Document already has content</li>
            </ul>
        '401':
          description: Unauthorized - Valid bearer token required
        '404':
          description: Document placeholder not found
      x-speakeasy-group: documentUpload
  /document/{documentId}/isModified:
    get:
      tags:
        - Version Control
      summary: Check if document is modified
      description: |
        Check if the current document content differs from the last saved version. Useful for detecting unsaved changes.<br><br>
        <b>Overview:</b><br>
        Compares the current document buffer with the most recent version in history to detect modifications. Returns true if content has changed since last version.<br><br>
        <b>Use Cases:</b><br>
        <ul>
        <li>Prompting user to save before closing</li>
        <li>Auto-save decision making</li>
        <li>Version creation validation</li>
        <li>Change detection in workflows</li>
        </ul>
        <b>Comparison Method:</b><br>
        Performs binary comparison of file buffers. Identical content returns false even if edited and reverted.<br><br>
        <b>Requirements:</b><br>
        Document must be versioned to have comparison baseline.
      operationId: checkDocumentModified
      security:
        - bearerAuth: []
      parameters:
        - name: documentId
          in: path
          required: true
          description: Document ID (24-character MongoDB ObjectId)
          schema:
            type: string
            pattern: '^[a-fA-F0-9]{24}$'
            example: "507f1f77bcf86cd799439011"
      responses:
        '200':
          description: Modification check completed
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  isModified:
                    type: boolean
                    description: True if current content differs from last version
                    example: true
        '401':
          description: Unauthorized - Valid bearer token required
        '404':
          description: Document not found
      x-speakeasy-group: versionControl
      x-speakeasy-name-override: checkModified
  # ==================== KNOWLEDGE BASE ENDPOINTS ====================

  # -------------------- Knowledge Base Management --------------------
  /knowledgeBase:
    post:
      tags:
        - Knowledge Bases
      summary: Create a new knowledge base
      description: |
        Create a new knowledge base for organizing and managing documents within your organization.<br><br>
        <b>Overview:</b><br>
        A knowledge base is a container for organizing related documents, files, and content. It provides a central location for teams to collaborate on shared information.<br><br>
        <b>Features:</b><br>
        <ul>
        <li>Hierarchical folder structure support</li>
        <li>Role-based access control (OWNER, ORGANIZER, WRITER, READER, etc.)</li>
        <li>Full-text search across all records</li>
        <li>Integration with external connectors (Google Drive, OneDrive, etc.)</li>
        <li>Automatic content indexing for AI-powered search</li>
        </ul>
        <b>Naming Rules:</b><br>
        <ul>
        <li>Name must be 1-255 characters</li>
        <li>Special characters and HTML tags are sanitized</li>
        <li>Names don't need to be unique within organization</li>
        </ul>
        <b>Creator Permissions:</b><br>
        The user creating the KB automatically becomes the OWNER with full administrative rights.
      operationId: createKnowledgeBase
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                kbName:
                  type: string
                  minLength: 1
                  maxLength: 255
                  description: Name of the knowledge base
                  example: "Product Documentation"
              required:
                - kbName
      responses:
        '200':
          description: Knowledge base created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KnowledgeBase'
        '400':
          description: |
            Invalid request:<br>
            <ul>
            <li>Name too short or too long</li>
            <li>Invalid characters in name</li>
            </ul>
        '401':
          description: Unauthorized - Valid bearer token required
      x-speakeasy-group: knowledgeBases
      x-speakeasy-name-override: create
    get:
      tags:
        - Knowledge Bases
      summary: List all knowledge bases
      description: |
        Retrieve a paginated list of all knowledge bases accessible to the authenticated user.<br><br>
        <b>Overview:</b><br>
        Returns knowledge bases where the user has at least READER permission. Results include the user's role for each KB.<br><br>
        <b>Filtering:</b><br>
        <ul>
        <li><b>search:</b> Full-text search on KB names (max 1000 chars)</li>
        <li><b>permissions:</b> Filter by user's role (comma-separated: OWNER,WRITER,READER)</li>
        </ul>
        <b>Sorting Options:</b><br>
        <ul>
        <li><code>name</code> - Alphabetical by KB name</li>
        <li><code>createdAtTimestamp</code> - By creation date</li>
        <li><code>updatedAtTimestamp</code> - By last modification</li>
        <li><code>userRole</code> - By permission level</li>
        </ul>
        <b>Performance:</b><br>
        Uses efficient pagination with limit/offset. For large result sets, use smaller page sizes.
      operationId: listKnowledgeBases
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          description: Page number (1-indexed)
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          description: Results per page (max 100)
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
        - name: search
          in: query
          description: Search query for KB names (max 1000 chars)
          schema:
            type: string
            maxLength: 1000
        - name: permissions
          in: query
          description: Filter by permission roles (comma-separated)
          schema:
            type: string
            example: "OWNER,ORGANIZER,WRITER"
        - name: sortBy
          in: query
          description: Field to sort by
          schema:
            type: string
            enum: [name, createdAtTimestamp, updatedAtTimestamp, userRole]
            default: name
        - name: sortOrder
          in: query
          description: Sort direction
          schema:
            type: string
            enum: [asc, desc]
            default: asc
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                type: object
                properties:
                  knowledgeBases:
                    type: array
                    items:
                      $ref: '#/components/schemas/KnowledgeBase'
                  pagination:
                    $ref: '#/components/schemas/PaginationInfo'
        '400':
          description: Invalid query parameters
        '401':
          description: Unauthorized - Valid bearer token required
      x-speakeasy-group: knowledgeBases
      x-speakeasy-name-override: list
  /knowledgeBase/{kbId}:
    get:
      tags:
        - Knowledge Bases
      summary: Get knowledge base by ID
      description: |
        Retrieve detailed information about a specific knowledge base.<br><br>
        <b>Overview:</b><br>
        Returns complete KB metadata including name, timestamps, and the requesting user's role/permissions.<br><br>
        <b>Access Control:</b><br>
        User must have at least READER permission to view KB details.
      operationId: getKnowledgeBase
      security:
        - bearerAuth: []
      parameters:
        - name: kbId
          in: path
          required: true
          description: Knowledge base ID
          schema:
            type: string
            example: "kb_550e8400-e29b-41d4-a716"
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KnowledgeBase'
        '401':
          description: Unauthorized - Valid bearer token required
        '403':
          description: Forbidden - No access to this knowledge base
        '404':
          description: Knowledge base not found
      x-speakeasy-group: knowledgeBases
      x-speakeasy-name-override: get
    put:
      tags:
        - Knowledge Bases
      summary: Update knowledge base
      description: |
        Update a knowledge base's name.<br><br>
        <b>Required Permission:</b> OWNER or ORGANIZER<br><br>
        <b>Validation:</b><br>
        <ul>
        <li>Name must be 1-255 characters</li>
        <li>XSS protection applied to input</li>
        </ul>
      operationId: updateKnowledgeBase
      security:
        - bearerAuth: []
      parameters:
        - name: kbId
          in: path
          required: true
          description: Knowledge base ID
          schema:
            type: string
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                kbName:
                  type: string
                  minLength: 1
                  maxLength: 255
                  description: New name for the knowledge base
                  example: "Updated Documentation Hub"
      responses:
        '200':
          description: Knowledge base updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/KnowledgeBase'
        '400':
          description: Invalid request - Name validation failed
        '401':
          description: Unauthorized - Valid bearer token required
        '403':
          description: Forbidden - Requires OWNER or ORGANIZER role
        '404':
          description: Knowledge base not found
      x-speakeasy-group: knowledgeBases
      x-speakeasy-name-override: update
    delete:
      tags:
        - Knowledge Bases
      summary: Delete knowledge base
      description: |
        Permanently delete a knowledge base and all its contents.<br><br>
        <b>Required Permission:</b> OWNER only<br><br>
        <b>What Gets Deleted:</b><br>
        <ul>
        <li>All folders within the KB</li>
        <li>All records and their indexed content</li>
        <li>All permission grants</li>
        <li>Associated storage files</li>
        </ul>
        <b>Warning:</b> This action is irreversible. Consider exporting data before deletion.
      operationId: deleteKnowledgeBase
      security:
        - bearerAuth: []
      parameters:
        - name: kbId
          in: path
          required: true
          description: Knowledge base ID
          schema:
            type: string
      responses:
        '200':
          description: Knowledge base deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Knowledge base deleted successfully"
        '401':
          description: Unauthorized - Valid bearer token required
        '403':
          description: Forbidden - Only OWNER can delete KB
        '404':
          description: Knowledge base not found
      x-speakeasy-group: knowledgeBases
      x-speakeasy-name-override: delete
  # -------------------- Records Endpoints --------------------
  /knowledgeBase/records:
    get:
      tags:
        - Records
      summary: Get all records across knowledge bases
      description: |
        Retrieve records from all knowledge bases accessible to the user.<br><br>
        <b>Overview:</b><br>
        Search and filter records across your entire organization. Useful for global search, reporting, and cross-KB content discovery.<br><br>
        <b>Filtering Options:</b><br>
        <ul>
        <li><b>search:</b> Full-text search in record names</li>
        <li><b>recordTypes:</b> FILE, WEBPAGE, EMAIL, MESSAGE, TICKET, etc.</li>
        <li><b>origins:</b> UPLOAD or CONNECTOR</li>
        <li><b>connectors:</b> Filter by connector source</li>
        <li><b>indexingStatus:</b> COMPLETED, FAILED, IN_PROGRESS, etc.</li>
        <li><b>dateFrom/dateTo:</b> Filter by creation date range</li>
        </ul>
        <b>Response Includes:</b><br>
        <ul>
        <li>Paginated record list</li>
        <li>Applied and available filter counts</li>
        <li>Pagination metadata</li>
        </ul>
      operationId: getAllRecords
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
        - name: search
          in: query
          description: Search query (max 1000 chars)
          schema:
            type: string
            maxLength: 1000
        - name: recordTypes
          in: query
          description: Filter by record types (comma-separated)
          schema:
            type: string
            example: "FILE,WEBPAGE,EMAIL"
        - name: origins
          in: query
          description: Filter by origin (comma-separated)
          schema:
            type: string
            enum: [UPLOAD, CONNECTOR]
        - name: connectors
          in: query
          description: Filter by connector names (comma-separated)
          schema:
            type: string
            example: "GOOGLE_DRIVE,ONEDRIVE"
        - name: indexingStatus
          in: query
          description: Filter by indexing status (comma-separated)
          schema:
            type: string
            example: "COMPLETED,FAILED"
        - name: dateFrom
          in: query
          description: Start date filter (Unix timestamp ms)
          schema:
            type: integer
            format: int64
        - name: dateTo
          in: query
          description: End date filter (Unix timestamp ms)
          schema:
            type: integer
            format: int64
        - name: sortBy
          in: query
          schema:
            type: string
            default: createdAtTimestamp
        - name: sortOrder
          in: query
          schema:
            type: string
            enum: [asc, desc]
            default: desc
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RecordsResponse'
        '401':
          description: Unauthorized
      x-speakeasy-name-override: get
  /knowledgeBase/{kbId}/records:
    get:
      tags:
        - Records
      summary: Get records for a knowledge base
      description: |
        Retrieve a paginated list of records within a specific knowledge base.<br><br>
        <b>Overview:</b><br>
        Returns all records (documents, files, content) stored in the specified KB, with powerful filtering and sorting capabilities.<br><br>
        <b>Filtering:</b><br>
        <ul>
        <li><b>search:</b> Search by record name (partial match, max 1000 chars)</li>
        <li><b>recordTypes:</b> FILE, WEBPAGE, COMMENT, MESSAGE, EMAIL, TICKET</li>
        <li><b>origins:</b> UPLOAD (manual uploads) or CONNECTOR (synced)</li>
        <li><b>indexingStatus:</b> Filter by processing state</li>
        <li><b>dateFrom/dateTo:</b> Creation date range (Unix timestamps)</li>
        </ul>
        <b>Sorting:</b><br>
        Default sorts by <code>createdAtTimestamp</code> descending (newest first).
      operationId: getKBRecords
      security:
        - bearerAuth: []
      parameters:
        - name: kbId
          in: path
          required: true
          description: Knowledge base ID
          schema:
            type: string
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
        - name: search
          in: query
          description: Search query for record names
          schema:
            type: string
            maxLength: 1000
        - name: recordTypes
          in: query
          description: Filter by record types (comma-separated)
          schema:
            type: string
        - name: origins
          in: query
          description: Filter by origin
          schema:
            type: string
        - name: indexingStatus
          in: query
          description: Filter by indexing status
          schema:
            type: string
        - name: dateFrom
          in: query
          description: Start date filter (Unix timestamp)
          schema:
            type: integer
            format: int64
        - name: dateTo
          in: query
          description: End date filter (Unix timestamp)
          schema:
            type: integer
            format: int64
        - name: sortBy
          in: query
          schema:
            type: string
            default: createdAtTimestamp
        - name: sortOrder
          in: query
          schema:
            type: string
            enum: [asc, desc]
            default: desc
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RecordsResponse'
        '401':
          description: Unauthorized
        '403':
          description: No access to this knowledge base
        '404':
          description: Knowledge base not found
      x-speakeasy-name-override: list
  /knowledgeBase/record/{recordId}:
    get:
      tags:
        - Records
      summary: Get record by ID
      description: |
        Retrieve detailed information about a specific record.<br><br>
        <b>Overview:</b><br>
        Returns complete record metadata including name, type, indexing status, storage information, and version history.<br><br>
        <b>File Conversion:</b><br>
        Use the optional <code>convertTo</code> parameter to request file format conversion (e.g., PDF to text).
      operationId: getRecordById
      security:
        - bearerAuth: []
      parameters:
        - name: recordId
          in: path
          required: true
          description: Record ID
          schema:
            type: string
        - name: convertTo
          in: query
          description: Optional format to convert the file to
          schema:
            type: string
            example: "txt"
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Record'
        '401':
          description: Unauthorized
        '404':
          description: Record not found
      x-speakeasy-name-override: getById
    put:
      tags:
        - Records
      summary: Update record
      description: |
        Update a record's name and/or file content.<br><br>
        <b>Overview:</b><br>
        Allows updating the display name and optionally replacing the file content. Triggers re-indexing when content changes.<br><br>
        <b>Required Permission:</b> WRITER or higher<br><br>
        <b>Updating File Content:</b><br>
        Include a new file in the request to replace the existing content. The file extension must match the original.<br><br>
        <b>Side Effects:</b><br>
        <ul>
        <li>Updates <code>updatedAtTimestamp</code></li>
        <li>Increments version if file content changed</li>
        <li>Triggers re-indexing for content changes</li>
        </ul>
      operationId: updateRecord
      security:
        - bearerAuth: []
      parameters:
        - name: recordId
          in: path
          required: true
          description: Record ID
          schema:
            type: string
      requestBody:
        description: "Request payload"
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                recordName:
                  type: string
                  description: New name for the record
                  maxLength: 255
                file:
                  type: string
                  format: binary
                  description: Replacement file content
      responses:
        '200':
          description: Record updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  record:
                    $ref: '#/components/schemas/Record'
        '400':
          description: Invalid request
        '401':
          description: Unauthorized
        '403':
          description: Insufficient permissions
        '404':
          description: Record not found
      x-speakeasy-name-override: update
    delete:
      tags:
        - Records
      summary: Delete record
      description: |
        Permanently delete a record from the knowledge base.<br><br>
        <b>Required Permission:</b> WRITER or higher<br><br>
        <b>What Gets Deleted:</b><br>
        <ul>
        <li>Record metadata</li>
        <li>Associated storage file</li>
        <li>Indexed content and embeddings</li>
        </ul>
        <b>Warning:</b> This action is irreversible.
      operationId: deleteRecord
      security:
        - bearerAuth: []
      parameters:
        - name: recordId
          in: path
          required: true
          description: Record ID
          schema:
            type: string
      responses:
        '200':
          description: Record deleted successfully
        '401':
          description: Unauthorized
        '403':
          description: Insufficient permissions
        '404':
          description: Record not found
      x-speakeasy-name-override: delete
  /knowledgeBase/stream/record/{recordId}:
    get:
      tags:
        - Records
      summary: Stream record content
      description: |
        Stream the binary content of a record's file.<br><br>
        <b>Overview:</b><br>
        Returns the raw file content with appropriate Content-Type and Content-Disposition headers for download or inline viewing.<br><br>
        <b>Use Cases:</b><br>
        <ul>
        <li>File downloads</li>
        <li>Inline document preview</li>
        <li>Content extraction pipelines</li>
        </ul>
        <b>Format Conversion:</b><br>
        Use <code>convertTo</code> parameter to convert between formats (e.g., DOCX to PDF).
      operationId: streamRecordBuffer
      security:
        - bearerAuth: []
      parameters:
        - name: recordId
          in: path
          required: true
          description: Record ID
          schema:
            type: string
        - name: convertTo
          in: query
          description: Target format for conversion
          schema:
            type: string
      responses:
        '200':
          description: File content stream
          content:
            application/octet-stream:
              schema:
                type: string
                format: binary
        '401':
          description: Unauthorized
        '404':
          description: Record not found
      x-speakeasy-name-override: streamContent
  # -------------------- Folder Endpoints --------------------
  /knowledgeBase/{kbId}/folder:
    post:
      tags:
        - Folders
      summary: Create root folder
      description: |
        Create a new folder at the root level of a knowledge base.<br><br>
        <b>Required Permission:</b> FILEORGANIZER or higher<br><br>
        <b>Folder Features:</b><br>
        <ul>
        <li>Organize records hierarchically</li>
        <li>Support nested subfolders</li>
        <li>Inherit parent KB permissions</li>
        </ul>
        <b>Naming Rules:</b><br>
        <ul>
        <li>1-255 characters</li>
        <li>XSS protection applied</li>
        <li>Can contain spaces and special characters</li>
        </ul>
      operationId: createRootFolder
      security:
        - bearerAuth: []
      parameters:
        - name: kbId
          in: path
          required: true
          description: Knowledge base ID
          schema:
            type: string
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                folderName:
                  type: string
                  minLength: 1
                  maxLength: 255
                  description: Name of the folder
                  example: "Project Documents"
              required:
                - folderName
      responses:
        '200':
          description: Folder created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Folder'
        '400':
          description: Invalid folder name
        '401':
          description: Unauthorized
        '403':
          description: Insufficient permissions
        '404':
          description: Knowledge base not found
      x-speakeasy-name-override: create
  /knowledgeBase/{kbId}/folder/{folderId}:
    get:
      tags:
        - Folders
      summary: Get folder contents
      description: |
        Retrieve the contents of a folder including subfolders and records.<br><br>
        <b>Overview:</b><br>
        Returns paginated list of records within the folder, with same filtering options as KB-level record listing.<br><br>
        <b>Navigation:</b><br>
        Use this endpoint to browse folder hierarchies. Response includes folder metadata and child items.
      operationId: getFolderContents
      security:
        - bearerAuth: []
      parameters:
        - name: kbId
          in: path
          required: true
          description: Knowledge base ID
          schema:
            type: string
        - name: folderId
          in: path
          required: true
          description: Folder ID
          schema:
            type: string
        - name: page
          in: query
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
            maximum: 100
        - name: search
          in: query
          schema:
            type: string
        - name: sortBy
          in: query
          schema:
            type: string
            default: createdAtTimestamp
        - name: sortOrder
          in: query
          schema:
            type: string
            enum: [asc, desc]
            default: desc
      responses:
        '200':
          description: Folder contents retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RecordsResponse'
        '401':
          description: Unauthorized
        '404':
          description: Folder or knowledge base not found
      x-speakeasy-name-override: getContents
    put:
      tags:
        - Folders
      summary: Update folder
      description: |
        Rename a folder.<br><br>
        <b>Required Permission:</b> FILEORGANIZER or higher
      operationId: updateFolder
      security:
        - bearerAuth: []
      parameters:
        - name: kbId
          in: path
          required: true
          schema:
            type: string
        - name: folderId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                folderName:
                  type: string
                  minLength: 1
                  maxLength: 255
              required:
                - folderName
      responses:
        '200':
          description: Folder updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Folder'
        '400':
          description: Invalid folder name
        '401':
          description: Unauthorized
        '403':
          description: Insufficient permissions
        '404':
          description: Folder not found
      x-speakeasy-name-override: update
    delete:
      tags:
        - Folders
      summary: Delete folder
      description: |
        Delete a folder and all its contents.<br><br>
        <b>Required Permission:</b> FILEORGANIZER or higher<br><br>
        <b>Cascade Delete:</b><br>
        All subfolders and records within will be permanently deleted.<br><br>
        <b>Warning:</b> This action is irreversible.
      operationId: deleteFolder
      security:
        - bearerAuth: []
      parameters:
        - name: kbId
          in: path
          required: true
          schema:
            type: string
        - name: folderId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Folder deleted successfully
        '401':
          description: Unauthorized
        '403':
          description: Insufficient permissions
        '404':
          description: Folder not found
      x-speakeasy-name-override: delete
  /knowledgeBase/{kbId}/folder/{folderId}/subfolder:
    post:
      tags:
        - Folders
      summary: Create subfolder
      description: |
        Create a nested folder within an existing folder.<br><br>
        <b>Required Permission:</b> FILEORGANIZER or higher<br><br>
        <b>Nesting:</b><br>
        Supports unlimited folder nesting depth for complex organizational structures.
      operationId: createSubfolder
      security:
        - bearerAuth: []
      parameters:
        - name: kbId
          in: path
          required: true
          schema:
            type: string
        - name: folderId
          in: path
          required: true
          description: Parent folder ID
          schema:
            type: string
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                folderName:
                  type: string
                  minLength: 1
                  maxLength: 255
              required:
                - folderName
      responses:
        '200':
          description: Subfolder created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Folder'
        '400':
          description: Invalid folder name
        '401':
          description: Unauthorized
        '403':
          description: Insufficient permissions
        '404':
          description: Parent folder not found
  # -------------------- Upload Endpoints --------------------
  /knowledgeBase/{kbId}/upload:
    post:
      tags:
        - Upload
      summary: Upload files to knowledge base
      description: |
        Upload one or more files directly to a knowledge base.<br><br>
        <b>Overview:</b><br>
        Batch upload multiple files in a single request. Each file becomes a new record in the KB with automatic content indexing.<br><br>
        <b>Upload Limits:</b><br>
        <ul>
        <li><b>Max files per request:</b> 1000</li>
        <li><b>Default max file size:</b> 30MB (configurable via platform settings)</li>
        <li>Use <code>GET /knowledgeBase/limits</code> to check current limits</li>
        </ul>
        <b>Supported File Types:</b><br>
        Documents (PDF, DOCX, TXT), Images (PNG, JPG), Videos (MP4), and more.<br><br>
        <b>File Metadata:</b><br>
        Use <code>files_metadata</code> to provide additional info like file paths and last modified timestamps.<br><br>
        <b>Versioning:</b><br>
        Set <code>isVersioned: true</code> to enable version tracking for uploaded files.
      operationId: uploadRecordsToKB
      security:
        - bearerAuth: []
      parameters:
        - name: kbId
          in: path
          required: true
          description: Knowledge base ID
          schema:
            type: string
      requestBody:
        required: true
        description: "Request payload"
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                files:
                  type: array
                  items:
                    type: string
                    format: binary
                  description: Files to upload (max 1000)
                files_metadata:
                  type: string
                  description: JSON array with file_path and last_modified for each file
                  example: '[{"file_path":"/docs/report.pdf","last_modified":"2024-01-15T10:30:00Z"}]'
                isVersioned:
                  type: boolean
                  default: true
                  description: Enable version tracking
                recordType:
                  type: string
                  default: FILE
                  description: Type of records to create
              required:
                - files
      responses:
        '200':
          description: Files uploaded successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UploadResult'
        '400':
          description: Invalid request - Check file types and sizes
        '401':
          description: Unauthorized
        '403':
          description: Insufficient permissions (requires WRITER or higher)
        '404':
          description: Knowledge base not found
        '413':
          description: File size exceeds maximum allowed
      x-speakeasy-name-override: files
  /knowledgeBase/{kbId}/folder/{folderId}/upload:
    post:
      tags:
        - Upload
      summary: Upload files to folder
      description: |
        Upload files directly to a specific folder within a knowledge base.<br><br>
        <b>Same as KB upload</b> but files are placed in the specified folder instead of KB root.
      operationId: uploadRecordsToFolder
      security:
        - bearerAuth: []
      parameters:
        - name: kbId
          in: path
          required: true
          schema:
            type: string
        - name: folderId
          in: path
          required: true
          description: Target folder ID
          schema:
            type: string
      requestBody:
        required: true
        description: "Request payload"
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                files:
                  type: array
                  items:
                    type: string
                    format: binary
                files_metadata:
                  type: string
                  description: JSON array with file metadata
                isVersioned:
                  type: boolean
                  default: true
              required:
                - files
      responses:
        '200':
          description: Files uploaded successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UploadResult'
        '400':
          description: Invalid request
        '401':
          description: Unauthorized
        '403':
          description: Insufficient permissions
        '404':
          description: Folder or knowledge base not found
      x-speakeasy-name-override: toFolder
  /knowledgeBase/limits:
    get:
      tags:
        - Upload
      summary: Get upload limits
      description: |
        Retrieve current upload constraints for the organization.<br><br>
        <b>Use Case:</b><br>
        Call this before uploads to validate file sizes on the client side and display appropriate limits to users.
      operationId: getUploadLimits
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Upload limits retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  maxFilesPerRequest:
                    type: integer
                    example: 1000
                    description: Maximum number of files per upload request
                  maxFileSizeBytes:
                    type: integer
                    example: 31457280
                    description: Maximum file size in bytes (default 30MB)
        '401':
          description: Unauthorized
      x-speakeasy-name-override: getLimits
  # -------------------- Reindex/Sync Endpoints --------------------
  /knowledgeBase/reindex/record/{recordId}:
    post:
      tags:
        - Connector
      summary: Reindex single record
      description: |
        Trigger reindexing for a specific record.<br><br>
        <b>Overview:</b><br>
        Reprocesses the record's content to update search indexes and AI embeddings. Useful after content changes or to fix indexing failures.<br><br>
        <b>Depth Parameter:</b><br>
        Controls processing depth for complex documents (-1 for full depth, 0-100 for limited).
      operationId: reindexRecord
      security:
        - bearerAuth: []
      parameters:
        - name: recordId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                depth:
                  type: integer
                  minimum: -1
                  maximum: 100
                  default: -1
                  description: Processing depth (-1 for unlimited)
      responses:
        '200':
          description: Reindexing triggered successfully
        '401':
          description: Unauthorized
        '404':
          description: Record not found
      x-speakeasy-name-override: reindex
  /knowledgeBase/reindex/record-group/{recordGroupId}:
    post:
      tags:
        - Connector
      summary: Reindex record group
      description: |
        Trigger reindexing for all records in a folder or knowledge base.<br><br>
        <b>Overview:</b><br>
        Batch reindex operation for entire containers. The recordGroupId can be a folder ID or KB ID.
      operationId: reindexRecordGroup
      security:
        - bearerAuth: []
      parameters:
        - name: recordGroupId
          in: path
          required: true
          description: Folder ID or KB ID
          schema:
            type: string
      requestBody:
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                depth:
                  type: integer
                  minimum: -1
                  maximum: 100
                  default: -1
      responses:
        '200':
          description: Reindexing triggered for all records in group
        '401':
          description: Unauthorized
        '404':
          description: Record group not found
  /knowledgeBase/reindex-failed/connector:
    post:
      tags:
        - Connector
      summary: Reindex failed connector records
      description: |
        Retry indexing for all failed records from a specific connector.<br><br>
        <b>Use Case:</b><br>
        After fixing connectivity issues or configuration problems, use this to reprocess all records that failed during the initial sync.
      operationId: reindexFailedConnectorRecords
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request body for Reindex failed connector records"
        content:
          application/json:
            schema:
              type: object
              properties:
                app:
                  type: string
                  description: Connector app name
                  example: "GOOGLE_DRIVE"
                connectorId:
                  type: string
                  description: Connector instance ID
              required:
                - app
                - connectorId
      responses:
        '200':
          description: Reindexing triggered for failed records
        '400':
          description: Invalid connector parameters
        '401':
          description: Unauthorized
      x-speakeasy-name-override: reindexFailed
  /knowledgeBase/resync/connector:
    post:
      tags:
        - Connector
      summary: Resync connector
      description: |
        Trigger a full resync of all records from a connector.<br><br>
        <b>Overview:</b><br>
        Fetches all content from the external source and updates local records. Use when you suspect data is out of sync.<br><br>
        <b>Warning:</b> This can be resource-intensive for large connectors.
      operationId: resyncConnector
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request body for Resync connector"
        content:
          application/json:
            schema:
              type: object
              properties:
                connectorName:
                  type: string
                  description: Connector type name
                  example: "GOOGLE_DRIVE"
                connectorId:
                  type: string
                  description: Connector instance ID
              required:
                - connectorName
                - connectorId
      responses:
        '200':
          description: Resync initiated
        '400':
          description: Invalid connector parameters
        '401':
          description: Unauthorized
      x-speakeasy-name-override: resync
  /knowledgeBase/stats/{connectorId}:
    get:
      tags:
        - Connector
      summary: Get connector statistics
      description: |
        Retrieve statistics for a specific connector including record counts, indexing status breakdown, and sync information.
      operationId: getConnectorStats
      security:
        - bearerAuth: []
      parameters:
        - name: connectorId
          in: path
          required: true
          description: Connector ID
          schema:
            type: string
      responses:
        '200':
          description: Connector statistics
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConnectorStats'
        '401':
          description: Unauthorized
        '404':
          description: Connector not found
      x-speakeasy-name-override: getStats
  # -------------------- Permissions Endpoints --------------------
  /knowledgeBase/{kbId}/permissions:
    post:
      tags:
        - Permissions
      summary: Grant permissions
      description: |
        Grant access permissions to users or teams for a knowledge base.<br><br>
        <b>Required Permission:</b> OWNER or ORGANIZER<br><br>
        <b>Permission Roles (highest to lowest):</b><br>
        <ol>
        <li><b>OWNER:</b> Full control, can delete KB, manage all permissions</li>
        <li><b>ORGANIZER:</b> Can manage permissions (except OWNER), edit KB settings</li>
        <li><b>FILEORGANIZER:</b> Can create/delete folders, organize content</li>
        <li><b>WRITER:</b> Can upload, edit, delete records</li>
        <li><b>COMMENTER:</b> Can add comments (if supported)</li>
        <li><b>READER:</b> View-only access</li>
        </ol>
        <b>Grant to Multiple:</b><br>
        Provide arrays of userIds and/or teamIds to grant the same role to multiple entities.
      operationId: createKBPermission
      security:
        - bearerAuth: []
      parameters:
        - name: kbId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                userIds:
                  type: array
                  items:
                    type: string
                  description: User IDs to grant permission
                teamIds:
                  type: array
                  items:
                    type: string
                  description: Team IDs to grant permission
                role:
                  type: string
                  enum: [OWNER, ORGANIZER, FILEORGANIZER, WRITER, COMMENTER, READER]
                  description: Permission role to grant
              required:
                - role
      responses:
        '200':
          description: Permissions granted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  kbId:
                    type: string
                  permissionResult:
                    type: object
                    properties:
                      grantedCount:
                        type: integer
                      updatedCount:
                        type: integer
        '400':
          description: Invalid request
        '401':
          description: Unauthorized
        '403':
          description: Only OWNER/ORGANIZER can grant permissions
      x-speakeasy-name-override: grant
    get:
      tags:
        - Permissions
      summary: List permissions
      description: |
        Retrieve all permissions granted on a knowledge base.<br><br>
        <b>Required Permission:</b> ORGANIZER or higher to see all permissions, others see only their own.
      operationId: listKBPermissions
      security:
        - bearerAuth: []
      parameters:
        - name: kbId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Permissions list retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  kbId:
                    type: string
                  permissions:
                    type: array
                    items:
                      $ref: '#/components/schemas/KBPermission'
                  totalCount:
                    type: integer
        '401':
          description: Unauthorized
        '403':
          description: No access to this knowledge base
        '404':
          description: Knowledge base not found
      x-speakeasy-name-override: list
    put:
      tags:
        - Permissions
      summary: Update permissions
      description: |
        Update permission roles for users or teams.<br><br>
        <b>Required Permission:</b> OWNER or ORGANIZER
      operationId: updateKBPermissions
      security:
        - bearerAuth: []
      parameters:
        - name: kbId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        description: "Request body for Update permissions"
        content:
          application/json:
            schema:
              type: object
              properties:
                userIds:
                  type: array
                  items:
                    type: string
                teamIds:
                  type: array
                  items:
                    type: string
                role:
                  type: string
                  enum: [OWNER, ORGANIZER, FILEORGANIZER, WRITER, COMMENTER, READER]
              required:
                - role
      responses:
        '200':
          description: Permissions updated
        '400':
          description: Invalid request
        '401':
          description: Unauthorized
        '403':
          description: Insufficient permissions
      x-speakeasy-name-override: update
    delete:
      tags:
        - Permissions
      summary: Remove permissions
      description: |
        Remove access permissions from users or teams.<br><br>
        <b>Required Permission:</b> OWNER or ORGANIZER<br><br>
        <b>Note:</b> Cannot remove the last OWNER from a KB.
      operationId: deleteKBPermissions
      security:
        - bearerAuth: []
      parameters:
        - name: kbId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        description: "Request body for Remove permissions"
        content:
          application/json:
            schema:
              type: object
              properties:
                userIds:
                  type: array
                  items:
                    type: string
                teamIds:
                  type: array
                  items:
                    type: string
      responses:
        '200':
          description: Permissions removed
        '400':
          description: Invalid request or cannot remove last owner
        '401':
          description: Unauthorized
        '403':
          description: Insufficient permissions
      x-speakeasy-name-override: remove
  # -------------------- Record Move --------------------
  /knowledgeBase/{kbId}/record/{recordId}/move:
    put:
      tags:
        - Records
      summary: Move a record to another folder
      description: |
        Move a record (file or folder) to a different parent folder within the same knowledge base.<br><br>
        <b>Required Permission:</b> WRITER or higher<br><br>
        <b>Moving to Root:</b><br>
        Set <code>newParentId</code> to <code>null</code> to move the record to the root level of the knowledge base.
      operationId: moveRecord
      security:
        - bearerAuth: []
      parameters:
        - name: kbId
          in: path
          required: true
          description: Knowledge base ID
          schema:
            type: string
            format: uuid
        - name: recordId
          in: path
          required: true
          description: Record ID to move
          schema:
            type: string
      requestBody:
        required: true
        description: "Target parent folder for the record"
        content:
          application/json:
            schema:
              type: object
              required:
                - newParentId
              properties:
                newParentId:
                  type: string
                  nullable: true
                  description: ID of the new parent folder, or null to move to root level
            examples:
              moveToFolder:
                summary: Move into a folder
                value:
                  newParentId: "folder-abc123"
              moveToRoot:
                summary: Move to root level
                value:
                  newParentId: null
      responses:
        '200':
          description: Record moved successfully
        '400':
          description: Invalid request
        '401':
          description: Unauthorized
        '403':
          description: Insufficient permissions
        '404':
          description: Record or knowledge base not found
      x-speakeasy-name-override: move
  # -------------------- Knowledge Hub Browse Endpoints --------------------
  /knowledgeBase/knowledge-hub/nodes:
    get:
      tags:
        - Knowledge Bases
      summary: Get knowledge hub root nodes
      description: |
        Retrieve root-level nodes for unified knowledge hub browsing.<br><br>
        <b>Overview:</b><br>
        Provides a unified view across all knowledge sources - KBs, connectors, and apps. Use for building file browser UIs.<br><br>
        <b>Node Types:</b><br>
        <ul>
        <li><b>KB:</b> Knowledge bases</li>
        <li><b>CONNECTOR:</b> External connector instances</li>
        <li><b>APP:</b> Connected applications</li>
        </ul>
      operationId: getKnowledgeHubRootNodes
      security:
        - bearerAuth: []
      parameters:
        - name: view
          in: query
          description: View mode
          schema:
            type: string
        - name: page
          in: query
          schema:
            type: integer
        - name: limit
          in: query
          schema:
            type: integer
        - name: nodeTypes
          in: query
          description: Filter by node types (comma-separated)
          schema:
            type: string
        - name: q
          in: query
          description: Search query
          schema:
            type: string
      responses:
        '200':
          description: Root nodes retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  nodes:
                    type: array
                    items:
                      $ref: '#/components/schemas/KnowledgeHubNode'
        '401':
          description: Unauthorized
      x-speakeasy-group: knowledgeBases
      x-speakeasy-name-override: getRootNodes
  /knowledgeBase/knowledge-hub/nodes/{parentType}/{parentId}:
    get:
      tags:
        - Knowledge Bases
      summary: Get knowledge hub child nodes
      description: |
        Retrieve child nodes under a specific parent in the knowledge hub tree.<br><br>
        <b>Navigation:</b><br>
        Use this to drill down into KBs, folders, and connector hierarchies.
      operationId: getKnowledgeHubChildNodes
      security:
        - bearerAuth: []
      parameters:
        - name: parentType
          in: path
          required: true
          description: Type of parent node (KB, FOLDER, CONNECTOR, APP)
          schema:
            type: string
        - name: parentId
          in: path
          required: true
          description: ID of parent node
          schema:
            type: string
        - name: page
          in: query
          schema:
            type: integer
        - name: limit
          in: query
          schema:
            type: integer
        - name: q
          in: query
          description: Search query
          schema:
            type: string
      responses:
        '200':
          description: Child nodes retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  nodes:
                    type: array
                    items:
                      $ref: '#/components/schemas/KnowledgeHubNode'
                  parent:
                    $ref: '#/components/schemas/KnowledgeHubNode'
        '401':
          description: Unauthorized
        '404':
          description: Parent node not found
      x-speakeasy-group: knowledgeBases
      x-speakeasy-name-override: getHubChildNodes
  # ==================== ENTERPRISE SEARCH ENDPOINTS ====================

  # -------------------- Conversations --------------------
  /conversations/create:
    post:
      tags:
        - Conversations
      summary: Create a new AI conversation
      description: |
        Start a new conversation with PipesHub's AI assistant.<br><br>
        <b>Overview:</b><br>
        This endpoint creates a new conversation session and processes the initial query.
        The AI searches your organization's knowledge bases for relevant information and
        generates a response with citations to source documents.<br><br>
        <b>How It Works:</b><br>
        <ol>
        <li>Your query is analyzed and converted to semantic embeddings</li>
        <li>Relevant content is retrieved from indexed knowledge bases</li>
        <li>The AI generates a response using the retrieved context</li>
        <li>Citations link back to source documents for verification</li>
        <li>Follow-up questions are suggested based on the conversation</li>
        </ol>
        <b>Filtering Options:</b><br>
        <ul>
        <li><b>recordIds:</b> Limit search to specific documents</li>
        <li><b>filters.apps:</b> Search only specific connector apps</li>
        <li><b>filters.kb:</b> Search only specific knowledge bases</li>
        </ul>
        <b>Model Selection:</b><br>
        Use <code>modelKey</code> to select different AI models configured for your organization.
        Each model may have different capabilities, speed, and accuracy trade-offs.
      operationId: createConversation
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateConversationRequest'
            examples:
              simple:
                summary: Simple query
                value:
                  query: "What is our company's vacation policy?"
              filtered:
                summary: Query with filters
                value:
                  query: "Summarize the Q4 sales report"
                  filters:
                    kb: ["550e8400-e29b-41d4-a716-446655440000"]
                  modelKey: "gpt-4-turbo"
      responses:
        '201':
          description: Conversation created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Conversation'
        '400':
          description: |
            Invalid request. Possible reasons:<br>
            <ul>
            <li>Query is empty or exceeds 100,000 characters</li>
            <li>Invalid recordIds or filter format</li>
            <li>Invalid modelKey specified</li>
            </ul>
        '401':
          description: Unauthorized - Valid bearer token required
        '502':
          description: AI backend service unavailable
        '504':
          description: Request timeout - AI processing took too long
      x-speakeasy-name-override: create
  /conversations/stream:
    post:
      tags:
        - Conversations
      summary: Create conversation with streaming response
      description: |
        Start a new conversation with real-time streaming response using Server-Sent Events (SSE).<br><br>
        <b>Overview:</b><br>
        This endpoint works like <code>/conversations/create</code> but streams the AI response
        in real-time as it's generated, providing a more interactive user experience.<br><br>
        <b>SSE Event Types:</b><br>
        <ul>
        <li><code>connected</code> - Connection established, processing started</li>
        <li><code>chunk</code> - Partial response text (stream these to show typing effect)</li>
        <li><code>citation</code> - Citation reference found during generation</li>
        <li><code>complete</code> - Final message with full response, citations, and follow-up questions</li>
        <li><code>error</code> - Error occurred during processing</li>
        </ul>
        <b>Client Implementation:</b><br>
        <code>
        const eventSource = new EventSource('/conversations/stream');<br>
        eventSource.onmessage = (event) => {<br>
        &nbsp;&nbsp;const data = JSON.parse(event.data);<br>
        &nbsp;&nbsp;// Handle different event types<br>
        };
        </code><br><br>
        <b>Error Handling:</b><br>
        If an error occurs mid-stream, an <code>error</code> event is sent and the stream closes.
        The conversation is marked as FAILED with the error reason stored.
      operationId: streamChat
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateConversationRequest'
      responses:
        '200':
          description: SSE stream established
          content:
            text/event-stream:
              schema:
                $ref: '#/components/schemas/SSEEvent'
        '400':
          description: Invalid request parameters
        '401':
          description: Unauthorized - Valid bearer token required
        '502':
          description: AI backend service unavailable
      x-speakeasy-name-override: stream
  /conversations:
    get:
      tags:
        - Conversations
      summary: List all conversations
      description: |
        Retrieve all conversations for the authenticated user.<br><br>
        <b>Overview:</b><br>
        Returns a list of all conversations owned by or shared with the current user.
        Conversations are returned with their messages, status, and metadata.<br><br>
        <b>Filtering:</b><br>
        <ul>
        <li>Only non-archived conversations are returned by default</li>
        <li>Use <code>/conversations/show/archives</code> for archived conversations</li>
        </ul>
        <b>Sorting:</b><br>
        Conversations are sorted by last activity timestamp (most recent first).
      operationId: getAllConversations
      security:
        - bearerAuth: []
      responses:
        '200':
          description: List of conversations
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Conversation'
        '401':
          description: Unauthorized - Valid bearer token required
      x-speakeasy-name-override: list
  /conversations/show/archives:
    get:
      tags:
        - Conversations
      summary: List archived conversations
      description: |
        Retrieve all archived conversations for the authenticated user.<br><br>
        <b>Overview:</b><br>
        Archived conversations are hidden from the main list but preserved for reference.
        This endpoint returns only conversations where <code>isArchived: true</code>.<br><br>
        <b>Unarchiving:</b><br>
        Use <code>PATCH /conversations/{id}/unarchive</code> to restore a conversation
        to the active list.
      operationId: getArchivedConversations
      security:
        - bearerAuth: []
      responses:
        '200':
          description: List of archived conversations
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Conversation'
        '401':
          description: Unauthorized
      x-speakeasy-name-override: listArchived
  /conversations/{conversationId}:
    get:
      tags:
        - Conversations
      summary: Get conversation by ID
      description: |
        Retrieve a specific conversation with its full message history.<br><br>
        <b>Overview:</b><br>
        Returns the complete conversation including all messages, citations,
        feedback, and metadata. Messages can be paginated for long conversations.<br><br>
        <b>Message Pagination:</b><br>
        For conversations with many messages, use pagination parameters:
        <ul>
        <li><code>page</code>: Page number (default: 1)</li>
        <li><code>limit</code>: Messages per page (default: 10)</li>
        <li><code>sortBy</code>: Sort field (default: createdAt)</li>
        <li><code>sortOrder</code>: 'asc' or 'desc' (default: desc)</li>
        </ul>
        <b>Access Control:</b><br>
        Users can access conversations they own or that have been shared with them.
      operationId: getConversationById
      security:
        - bearerAuth: []
      parameters:
        - name: conversationId
          in: path
          required: true
          description: Unique conversation identifier
          schema:
            type: string
            format: objectId
          example: "507f1f77bcf86cd799439011"
        - name: page
          in: query
          description: Page number for message pagination
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          description: Number of messages per page
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
        - name: sortBy
          in: query
          description: Field to sort messages by
          schema:
            type: string
            default: createdAt
        - name: sortOrder
          in: query
          description: Sort direction
          schema:
            type: string
            enum: [asc, desc]
            default: desc
      responses:
        '200':
          description: Conversation with paginated messages
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/Conversation'
                  - type: object
                    properties:
                      pagination:
                        type: object
                        properties:
                          page:
                            type: integer
                          limit:
                            type: integer
                          totalMessages:
                            type: integer
                          totalPages:
                            type: integer
        '401':
          description: Unauthorized
        '403':
          description: Forbidden - No access to this conversation
        '404':
          description: Conversation not found
      x-speakeasy-name-override: get
    delete:
      tags:
        - Conversations
      summary: Delete conversation
      description: |
        Delete a conversation by its ID.<br><br>
        <b>Overview:</b><br>
        Performs a soft delete by setting <code>isDeleted: true</code>.
        The conversation is removed from listings but preserved in the database.<br><br>
        <b>Permissions:</b><br>
        Only the conversation owner (initiator) can delete it.
        Shared users cannot delete conversations.
      operationId: deleteConversationById
      security:
        - bearerAuth: []
      parameters:
        - name: conversationId
          in: path
          required: true
          description: Unique conversation identifier
          schema:
            type: string
            format: objectId
      responses:
        '200':
          description: Conversation deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Conversation deleted successfully"
        '401':
          description: Unauthorized
        '403':
          description: Forbidden - Only owner can delete
        '404':
          description: Conversation not found
      x-speakeasy-name-override: delete
  /conversations/{conversationId}/messages:
    post:
      tags:
        - Conversations
      summary: Add message to conversation
      description: |
        Add a follow-up message to an existing conversation.<br><br>
        <b>Overview:</b><br>
        Continues an existing conversation by adding a new user query.
        The AI maintains context from previous messages when generating the response.<br><br>
        <b>Context Handling:</b><br>
        <ul>
        <li>Previous messages provide context for the new query</li>
        <li>Citations from earlier messages may be referenced</li>
        <li>The AI can refer back to previous topics discussed</li>
        </ul>
        <b>Model Override:</b><br>
        You can specify a different model for this message using <code>modelKey</code>.
        This allows switching models mid-conversation if needed.
      operationId: addMessage
      security:
        - bearerAuth: []
      parameters:
        - name: conversationId
          in: path
          required: true
          description: Unique conversation identifier
          schema:
            type: string
            format: objectId
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AddMessageRequest'
      responses:
        '200':
          description: Message added and response generated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Conversation'
        '400':
          description: Invalid request - Query cannot be empty
        '401':
          description: Unauthorized
        '403':
          description: Forbidden - No write access to this conversation
        '404':
          description: Conversation not found
  /conversations/{conversationId}/messages/stream:
    post:
      tags:
        - Conversations
      summary: Add message with streaming response
      description: |
        Add a follow-up message to an existing conversation with real-time SSE streaming.<br><br>
        <b>Overview:</b><br>
        Same as <code>POST /conversations/{id}/messages</code> but with streaming response.
        Provides real-time feedback as the AI generates its response.<br><br>
        <b>SSE Events:</b><br>
        See <code>/conversations/stream</code> for event type documentation.
      operationId: addMessageStream
      security:
        - bearerAuth: []
      parameters:
        - name: conversationId
          in: path
          required: true
          schema:
            type: string
            format: objectId
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AddMessageRequest'
      responses:
        '200':
          description: SSE stream established
          content:
            text/event-stream:
              schema:
                $ref: '#/components/schemas/SSEEvent'
        '401':
          description: Unauthorized
        '404':
          description: Conversation not found
  /conversations/{conversationId}/share:
    post:
      tags:
        - Conversations
      summary: Share conversation with users
      description: |
        Share a conversation with other users in your organization.<br><br>
        <b>Overview:</b><br>
        Allows the conversation owner to grant access to other users.
        Shared users can view the conversation and optionally add messages.<br><br>
        <b>Access Levels:</b><br>
        <ul>
        <li><code>read</code> - Can view conversation and messages (default)</li>
        <li><code>write</code> - Can view and add new messages</li>
        </ul>
        <b>Permissions:</b><br>
        Only the conversation initiator (owner) can share. Users must belong
        to the same organization.
      operationId: shareConversation
      security:
        - bearerAuth: []
      parameters:
        - name: conversationId
          in: path
          required: true
          schema:
            type: string
            format: objectId
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ShareRequest'
      responses:
        '200':
          description: Conversation shared successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Conversation'
        '400':
          description: Invalid request - userIds array required
        '401':
          description: Unauthorized
        '403':
          description: Forbidden - Only owner can share
        '404':
          description: Conversation or users not found
      x-speakeasy-name-override: share
  /conversations/{conversationId}/unshare:
    post:
      tags:
        - Conversations
      summary: Revoke conversation access
      description: |
        Remove sharing access from users.<br><br>
        <b>Overview:</b><br>
        Removes specified users from the conversation's sharedWith list.
        Those users will no longer be able to access the conversation.<br><br>
        <b>Permissions:</b><br>
        Only the conversation owner can revoke access.
      operationId: unshareConversation
      security:
        - bearerAuth: []
      parameters:
        - name: conversationId
          in: path
          required: true
          schema:
            type: string
            format: objectId
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              required:
                - userIds
              properties:
                userIds:
                  type: array
                  items:
                    type: string
                    format: objectId
                  minItems: 1
                  description: User IDs to remove access from
      responses:
        '200':
          description: Access revoked successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Conversation'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden - Only owner can unshare
        '404':
          description: Conversation not found
      x-speakeasy-name-override: unshare
  /conversations/{conversationId}/title:
    patch:
      tags:
        - Conversations
      summary: Update conversation title
      description: |
        Update the title of a conversation.<br><br>
        <b>Overview:</b><br>
        Conversation titles are auto-generated from the first query by default.
        Use this endpoint to set a custom, more descriptive title.<br><br>
        <b>Title Limits:</b><br>
        <ul>
        <li>Minimum: 1 character</li>
        <li>Maximum: 200 characters</li>
        </ul>
      operationId: updateConversationTitle
      security:
        - bearerAuth: []
      parameters:
        - name: conversationId
          in: path
          required: true
          schema:
            type: string
            format: objectId
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              required:
                - title
              properties:
                title:
                  type: string
                  minLength: 1
                  maxLength: 200
                  description: New conversation title
                  example: "Q4 Sales Analysis Discussion"
      responses:
        '200':
          description: Title updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Conversation'
        '400':
          description: Invalid title - must be 1-200 characters
        '401':
          description: Unauthorized
        '404':
          description: Conversation not found
      x-speakeasy-name-override: updateTitle
  /conversations/{conversationId}/archive:
    patch:
      tags:
        - Conversations
      summary: Archive conversation
      description: |
        Archive a conversation to hide it from the main list.<br><br>
        <b>Overview:</b><br>
        Archived conversations are preserved but hidden from the default conversation list.
        Use archiving to clean up your workspace without permanently deleting conversations.<br><br>
        <b>Retrieval:</b><br>
        View archived conversations using <code>GET /conversations/show/archives</code>.
      operationId: archiveConversation
      security:
        - bearerAuth: []
      parameters:
        - name: conversationId
          in: path
          required: true
          schema:
            type: string
            format: objectId
      responses:
        '200':
          description: Conversation archived successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Conversation'
        '401':
          description: Unauthorized
        '404':
          description: Conversation not found
      x-speakeasy-name-override: patchArchive
  /conversations/{conversationId}/unarchive:
    patch:
      tags:
        - Conversations
      summary: Unarchive conversation
      description: |
        Restore an archived conversation to the active list.<br><br>
        <b>Overview:</b><br>
        Removes the archived flag, making the conversation visible in the main list again.
      operationId: unarchiveConversation
      security:
        - bearerAuth: []
      parameters:
        - name: conversationId
          in: path
          required: true
          schema:
            type: string
            format: objectId
      responses:
        '200':
          description: Conversation unarchived successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Conversation'
        '401':
          description: Unauthorized
        '404':
          description: Conversation not found
      x-speakeasy-name-override: unarchive
  /conversations/{conversationId}/message/{messageId}/regenerate:
    post:
      tags:
        - Conversations
      summary: Regenerate AI response
      description: |
        Regenerate the AI response for a specific message.<br><br>
        <b>Overview:</b><br>
        If you're not satisfied with an AI response, use this endpoint to generate
        a new answer. The AI will re-process the original query and may produce
        a different response.<br><br>
        <b>Use Cases:</b><br>
        <ul>
        <li>Response was incomplete or unclear</li>
        <li>Want to try a different AI model</li>
        <li>New documents have been indexed since original response</li>
        </ul>
        <b>Model Override:</b><br>
        Specify <code>modelKey</code> to use a different model for regeneration.
      operationId: regenerateAnswer
      security:
        - bearerAuth: []
      parameters:
        - name: conversationId
          in: path
          required: true
          schema:
            type: string
            format: objectId
        - name: messageId
          in: path
          required: true
          description: ID of the message to regenerate response for
          schema:
            type: string
            format: objectId
      requestBody:
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                filters:
                  $ref: '#/components/schemas/Filters'
                modelKey:
                  type: string
                  description: Override model for regeneration
                modelName:
                  type: string
                chatMode:
                  type: string
      responses:
        '200':
          description: Response regenerated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Conversation'
        '400':
          description: Cannot regenerate - message type not supported
        '401':
          description: Unauthorized
        '404':
          description: Conversation or message not found
  /conversations/{conversationId}/message/{messageId}/feedback:
    post:
      tags:
        - Conversations
      summary: Submit feedback on AI response
      description: |
        Provide feedback on an AI-generated response.<br><br>
        <b>Overview:</b><br>
        Feedback helps improve AI response quality over time. You can rate
        various aspects of the response and provide detailed comments.<br><br>
        <b>Feedback Options:</b><br>
        <ul>
        <li><b>isHelpful:</b> Overall thumbs up/down</li>
        <li><b>ratings:</b> 1-5 scale for accuracy, relevance, completeness, clarity</li>
        <li><b>categories:</b> Issue categories (incorrect info, too verbose, etc.)</li>
        <li><b>comments:</b> Free-text positive/negative feedback and suggestions</li>
        <li><b>citationFeedback:</b> Rate individual citations</li>
        </ul>
        <b>Restrictions:</b><br>
        Feedback can only be submitted on <code>bot_response</code> messages,
        not on user queries or system messages.
      operationId: updateMessageFeedback
      security:
        - bearerAuth: []
      parameters:
        - name: conversationId
          in: path
          required: true
          schema:
            type: string
            format: objectId
        - name: messageId
          in: path
          required: true
          schema:
            type: string
            format: objectId
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MessageFeedback'
      responses:
        '200':
          description: Feedback submitted successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Conversation'
        '400':
          description: |
            Invalid feedback. Possible reasons:<br>
            <ul>
            <li>Ratings must be 1-5</li>
            <li>Cannot add feedback to user_query messages</li>
            </ul>
        '401':
          description: Unauthorized
        '404':
          description: Conversation or message not found
  # -------------------- Semantic Search --------------------
  /search:
    post:
      tags:
        - Semantic Search
      summary: Perform semantic search
      description: |
        Execute a semantic search across your organization's knowledge base.<br><br>
        <b>Overview:</b><br>
        Semantic search uses AI embeddings to find content based on meaning,
        not just keyword matching. This enables finding relevant information
        even when the exact words differ.<br><br>
        <b>How It Works:</b><br>
        <ol>
        <li>Your query is converted to a vector embedding</li>
        <li>The system finds documents with similar semantic meaning</li>
        <li>Results are ranked by relevance score</li>
        <li>Matching chunks are returned with metadata</li>
        </ol>
        <b>Filtering:</b><br>
        Use filters to narrow your search:
        <ul>
        <li><code>filters.apps</code>: Limit to specific connector apps (Google Drive, Confluence, etc.)</li>
        <li><code>filters.kb</code>: Limit to specific knowledge bases</li>
        </ul>
        <b>Results:</b><br>
        Each result includes:
        <ul>
        <li>Matching content chunk</li>
        <li>Relevance score (0-1, higher is better)</li>
        <li>Source document metadata (name, URL, type)</li>
        </ul>
        <b>Search History:</b><br>
        All searches are saved and can be retrieved via <code>GET /search</code>.
      operationId: search
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SemanticSearchRequest'
            examples:
              simple:
                summary: Basic search
                value:
                  query: "company vacation policy"
                  limit: 10
              filtered:
                summary: Search with filters
                value:
                  query: "API documentation examples"
                  filters:
                    apps: ["drive"]
                  limit: 20
      responses:
        '200':
          description: Search results with matching documents
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SearchResult'
        '400':
          description: Invalid request - Query required
        '401':
          description: Unauthorized - Valid bearer token required
        '502':
          description: AI backend service unavailable
      x-speakeasy-group: semanticSearch
      x-speakeasy-name-override: postSearch
    get:
      tags:
        - Semantic Search
      summary: Get search history
      description: |
        Retrieve your search history with pagination.<br><br>
        <b>Overview:</b><br>
        Returns a list of all searches performed by the authenticated user.
        Each entry includes the original query, results, and metadata.<br><br>
        <b>Pagination:</b><br>
        Use <code>page</code> and <code>limit</code> to navigate through results.
      operationId: searchHistory
      security:
        - bearerAuth: []
      parameters:
        - name: limit
          in: query
          description: Number of results per page
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
        - name: page
          in: query
          description: Page number
          schema:
            type: integer
            minimum: 1
            default: 1
      responses:
        '200':
          description: Search history with pagination
          content:
            application/json:
              schema:
                type: object
                properties:
                  results:
                    type: array
                    items:
                      $ref: '#/components/schemas/SearchResult'
                  total:
                    type: integer
                    description: Total number of searches
                  page:
                    type: integer
                  limit:
                    type: integer
        '401':
          description: Unauthorized
      x-speakeasy-group: semanticSearch
      x-speakeasy-name-override: getHistory
    delete:
      tags:
        - Semantic Search
      summary: Clear all search history
      description: |
        Delete all search history for the authenticated user.<br><br>
        <b>Warning:</b><br>
        This action cannot be undone. All saved searches will be permanently removed.
      operationId: deleteAllSearchHistory
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Search history cleared
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Search history cleared successfully"
        '401':
          description: Unauthorized
      x-speakeasy-group: semanticSearch
      x-speakeasy-name-override: deleteAllHistory
  /search/{searchId}:
    get:
      tags:
        - Semantic Search
      summary: Get search by ID
      description: |
        Retrieve a specific search result by its ID.<br><br>
        <b>Overview:</b><br>
        Returns the full search record including query, all results,
        and any sharing/archive status.
      operationId: getSearchById
      security:
        - bearerAuth: []
      parameters:
        - name: searchId
          in: path
          required: true
          description: Unique search identifier
          schema:
            type: string
            format: objectId
      responses:
        '200':
          description: Search record
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SearchResult'
        '401':
          description: Unauthorized
        '404':
          description: Search not found
      x-speakeasy-group: semanticSearch
      x-speakeasy-name-override: getById
    delete:
      tags:
        - Semantic Search
      summary: Delete search
      description: |
        Delete a specific search from history.<br><br>
        <b>Overview:</b><br>
        Permanently removes the search record from your history.
      operationId: deleteSearch
      security:
        - bearerAuth: []
      parameters:
        - name: searchId
          in: path
          required: true
          schema:
            type: string
            format: objectId
      responses:
        '200':
          description: Search deleted successfully
        '401':
          description: Unauthorized
        '404':
          description: Search not found
      x-speakeasy-group: semanticSearch
      x-speakeasy-name-override: delete
  /search/{searchId}/share:
    patch:
      tags:
        - Semantic Search
      summary: Share search results
      description: |
        Share search results with other users.<br><br>
        <b>Overview:</b><br>
        Allows sharing a search and its results with colleagues.
        Useful for collaborative research or knowledge sharing.
      operationId: shareSearch
      security:
        - bearerAuth: []
      parameters:
        - name: searchId
          in: path
          required: true
          schema:
            type: string
            format: objectId
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ShareRequest'
      responses:
        '200':
          description: Search shared successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SearchResult'
        '401':
          description: Unauthorized
        '404':
          description: Search not found
      x-speakeasy-group: semanticSearch
      x-speakeasy-name-override: patchShare
  /search/{searchId}/unshare:
    patch:
      tags:
        - Semantic Search
      summary: Revoke search access
      description: Remove sharing access from specified users.
      operationId: unshareSearch
      security:
        - bearerAuth: []
      parameters:
        - name: searchId
          in: path
          required: true
          schema:
            type: string
            format: objectId
      requestBody:
        required: true
        description: "Request body for Revoke search access"
        content:
          application/json:
            schema:
              type: object
              required:
                - userIds
              properties:
                userIds:
                  type: array
                  items:
                    type: string
                    format: objectId
                  minItems: 1
      responses:
        '200':
          description: Access revoked
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SearchResult'
        '401':
          description: Unauthorized
        '404':
          description: Search not found
      x-speakeasy-group: semanticSearch
      x-speakeasy-name-override: unshare
  /search/{searchId}/archive:
    patch:
      tags:
        - Semantic Search
      summary: Archive search
      description: Archive a search to hide it from the main history list.
      operationId: archiveSearch
      security:
        - bearerAuth: []
      parameters:
        - name: searchId
          in: path
          required: true
          schema:
            type: string
            format: objectId
      responses:
        '200':
          description: Search archived
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SearchResult'
        '401':
          description: Unauthorized
        '404':
          description: Search not found
      x-speakeasy-group: semanticSearch
      x-speakeasy-name-override: archive
  /search/{searchId}/unarchive:
    patch:
      tags:
        - Semantic Search
      summary: Unarchive search
      description: Restore an archived search to the active history list.
      operationId: unarchiveSearch
      security:
        - bearerAuth: []
      parameters:
        - name: searchId
          in: path
          required: true
          schema:
            type: string
            format: objectId
      responses:
        '200':
          description: Search unarchived
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SearchResult'
        '401':
          description: Unauthorized
        '404':
          description: Search not found
      x-speakeasy-group: semanticSearch
      x-speakeasy-name-override: unarchive
  # -------------------- Agent Templates --------------------
  /agents/template:
    get:
      tags:
        - Agent Templates
      summary: List agent templates
      description: |
        Retrieve all available agent templates.<br><br>
        <b>Overview:</b><br>
        Agent templates provide pre-configured starting points for creating
        custom AI agents. Templates include system prompts, recommended tools,
        and configuration schemas.<br><br>
        <b>Template Types:</b><br>
        <ul>
        <li>Public templates available to all organization users</li>
        <li>Private templates created by individual users</li>
        </ul>
      operationId: listAgentTemplates
      security:
        - bearerAuth: []
      responses:
        '200':
          description: List of agent templates
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/AgentTemplate'
        '401':
          description: Unauthorized
      x-speakeasy-group: agentTemplates
      x-speakeasy-name-override: list
    post:
      tags:
        - Agent Templates
      summary: Create agent template
      description: |
        Create a new reusable agent template.<br><br>
        <b>Overview:</b><br>
        Templates define the base configuration for agents including
        system prompts, tool recommendations, and customization options.<br><br>
        <b>Template Components:</b><br>
        <ul>
        <li><b>System prompt:</b> Default instructions for agents</li>
        <li><b>Recommended tools:</b> Suggested tool integrations</li>
        <li><b>Config schema:</b> JSON Schema for customization options</li>
        </ul>
      operationId: createAgentTemplate
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              required:
                - name
              properties:
                name:
                  type: string
                  description: Template name
                  example: "Customer Support Agent"
                description:
                  type: string
                  description: What agents from this template do
                category:
                  type: string
                  description: Template category
                  example: "Support"
                defaultSystemPrompt:
                  type: string
                  description: Default system instructions
                recommendedTools:
                  type: array
                  items:
                    type: string
                  description: Suggested tool keys
                configSchema:
                  type: object
                  description: JSON Schema for customization
                isPublic:
                  type: boolean
                  default: false
                  description: Make template available organization-wide
      responses:
        '201':
          description: Template created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentTemplate'
        '400':
          description: Invalid template configuration
        '401':
          description: Unauthorized
      x-speakeasy-group: agentTemplates
      x-speakeasy-name-override: create
  /agents/template/{templateId}:
    get:
      tags:
        - Agent Templates
      summary: Get agent template
      description: Retrieve a specific agent template by ID.
      operationId: getAgentTemplate
      security:
        - bearerAuth: []
      parameters:
        - name: templateId
          in: path
          required: true
          description: Template identifier
          schema:
            type: string
      responses:
        '200':
          description: Template details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentTemplate'
        '401':
          description: Unauthorized
        '404':
          description: Template not found
      x-speakeasy-group: agentTemplates
      x-speakeasy-name-override: get
    put:
      tags:
        - Agent Templates
      summary: Update agent template
      description: |
        Update an existing agent template.<br><br>
        <b>Permissions:</b><br>
        Only the template creator can update it.
      operationId: updateAgentTemplate
      security:
        - bearerAuth: []
      parameters:
        - name: templateId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        description: "Request body for Update agent template"
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                description:
                  type: string
                category:
                  type: string
                defaultSystemPrompt:
                  type: string
                recommendedTools:
                  type: array
                  items:
                    type: string
                configSchema:
                  type: object
                isPublic:
                  type: boolean
      responses:
        '200':
          description: Template updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentTemplate'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden - Only creator can update
        '404':
          description: Template not found
      x-speakeasy-group: agentTemplates
      x-speakeasy-name-override: update
    delete:
      tags:
        - Agent Templates
      summary: Delete agent template
      description: |
        Delete an agent template.<br><br>
        <b>Note:</b><br>
        Existing agents created from this template are not affected.
      operationId: deleteAgentTemplate
      security:
        - bearerAuth: []
      parameters:
        - name: templateId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Template deleted
        '401':
          description: Unauthorized
        '403':
          description: Forbidden - Only creator can delete
        '404':
          description: Template not found
      x-speakeasy-group: agentTemplates
      x-speakeasy-name-override: delete
  # -------------------- Agents --------------------
  /agents:
    get:
      tags:
        - Agents
      summary: List agents
      description: |
        Retrieve all agents available to the authenticated user.<br><br>
        <b>Overview:</b><br>
        Returns agents created by the user plus public agents in the organization.
        Each agent has unique capabilities defined by its tools and knowledge scope.
      operationId: listAgents
      security:
        - bearerAuth: []
      responses:
        '200':
          description: List of agents
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Agent'
        '401':
          description: Unauthorized
      x-speakeasy-name-override: list
  /agents/create:
    post:
      tags:
        - Agents
      summary: Create agent
      description: |
        Create a new custom AI agent.<br><br>
        <b>Overview:</b><br>
        Agents are specialized AI assistants configured for specific tasks.
        They can have custom system prompts, access to specific tools, and
        be limited to certain knowledge bases.<br><br>
        <b>Agent Configuration:</b><br>
        <ul>
        <li><b>System prompt:</b> Instructions that define agent behavior</li>
        <li><b>Tools:</b> Capabilities like web search, code execution, etc.</li>
        <li><b>Knowledge bases:</b> Data sources the agent can access</li>
        <li><b>Model config:</b> AI model settings (temperature, max tokens)</li>
        </ul>
        <b>Use Cases:</b><br>
        <ul>
        <li>Customer support bot with product knowledge</li>
        <li>Code review assistant with repository access</li>
        <li>HR assistant with policy documents</li>
        </ul>
      operationId: createAgent
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              required:
                - name
              properties:
                name:
                  type: string
                  description: Agent display name
                  example: "Product Support Agent"
                description:
                  type: string
                  description: What the agent does
                systemPrompt:
                  type: string
                  description: System instructions for the agent
                tools:
                  type: array
                  items:
                    type: string
                  description: Tool keys the agent can use
                knowledgeBases:
                  type: array
                  items:
                    type: string
                    format: uuid
                  description: Knowledge base IDs to access
                llmConfig:
                  type: object
                  properties:
                    modelKey:
                      type: string
                    temperature:
                      type: number
                      minimum: 0
                      maximum: 2
                    maxTokens:
                      type: integer
                isPublic:
                  type: boolean
                  default: false
                  description: Make agent available to all org users
      responses:
        '201':
          description: Agent created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Agent'
        '400':
          description: Invalid agent configuration
        '401':
          description: Unauthorized
      x-speakeasy-name-override: create
  /agents/tools/list:
    get:
      tags:
        - Agents
      summary: List available tools
      description: |
        Get all tools that can be assigned to agents.<br><br>
        <b>Overview:</b><br>
        Tools extend agent capabilities beyond basic Q&A. Each tool
        has specific inputs and outputs defined by its schema.<br><br>
        <b>Common Tools:</b><br>
        <ul>
        <li><b>web-search:</b> Search the internet</li>
        <li><b>code-interpreter:</b> Execute code snippets</li>
        <li><b>file-reader:</b> Read uploaded files</li>
        <li><b>api-caller:</b> Make external API requests</li>
        </ul>
      operationId: listAgentTools
      security:
        - bearerAuth: []
      responses:
        '200':
          description: List of available tools
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/AgentTool'
        '401':
          description: Unauthorized
      x-speakeasy-name-override: listTools
  /agents/{agentKey}:
    get:
      tags:
        - Agents
      summary: Get agent
      description: Retrieve agent details by its unique key.
      operationId: getAgent
      security:
        - bearerAuth: []
      parameters:
        - name: agentKey
          in: path
          required: true
          description: Unique agent identifier
          schema:
            type: string
          example: "customer-support-agent"
      responses:
        '200':
          description: Agent details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Agent'
        '401':
          description: Unauthorized
        '404':
          description: Agent not found
      x-speakeasy-name-override: get
    put:
      tags:
        - Agents
      summary: Update agent
      description: |
        Update an existing agent's configuration.<br><br>
        <b>Permissions:</b><br>
        Only the agent creator can update it.
      operationId: updateAgent
      security:
        - bearerAuth: []
      parameters:
        - name: agentKey
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        description: "Request body for Update agent"
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                description:
                  type: string
                systemPrompt:
                  type: string
                tools:
                  type: array
                  items:
                    type: string
                knowledgeBases:
                  type: array
                  items:
                    type: string
                    format: uuid
                llmConfig:
                  type: object
                isPublic:
                  type: boolean
      responses:
        '200':
          description: Agent updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Agent'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden - Only creator can update
        '404':
          description: Agent not found
      x-speakeasy-name-override: update
    delete:
      tags:
        - Agents
      summary: Delete agent
      description: |
        Delete an agent.<br><br>
        <b>Warning:</b><br>
        All conversations with this agent will become inaccessible.
      operationId: deleteAgent
      security:
        - bearerAuth: []
      parameters:
        - name: agentKey
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Agent deleted
        '401':
          description: Unauthorized
        '403':
          description: Forbidden - Only creator can delete
        '404':
          description: Agent not found
      x-speakeasy-name-override: delete
  /agents/{agentKey}/permissions:
    get:
      tags:
        - Agents
      summary: Get agent permissions
      description: Get the current permission configuration for an agent.
      operationId: getAgentPermissions
      security:
        - bearerAuth: []
      parameters:
        - name: agentKey
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Permission configuration
          content:
            application/json:
              schema:
                type: object
                properties:
                  isPublic:
                    type: boolean
                  sharedWith:
                    type: array
                    items:
                      type: object
                      properties:
                        userId:
                          type: string
                        accessLevel:
                          type: string
                          enum: [read, use, edit]
        '401':
          description: Unauthorized
        '404':
          description: Agent not found
      x-speakeasy-name-override: getPermissions
    put:
      tags:
        - Agents
      summary: Update agent permissions
      description: Update who can access and use the agent.
      operationId: updateAgentPermissions
      security:
        - bearerAuth: []
      parameters:
        - name: agentKey
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        description: "Request body for Update agent permissions"
        content:
          application/json:
            schema:
              type: object
              properties:
                isPublic:
                  type: boolean
                sharedWith:
                  type: array
                  items:
                    type: object
                    properties:
                      userId:
                        type: string
                        format: objectId
                      accessLevel:
                        type: string
                        enum: [read, use, edit]
      responses:
        '200':
          description: Permissions updated
        '401':
          description: Unauthorized
        '403':
          description: Forbidden - Only owner can update permissions
        '404':
          description: Agent not found
      x-speakeasy-name-override: updatePermissions
  /agents/{agentKey}/share:
    post:
      tags:
        - Agents
      summary: Share agent
      description: Share an agent with specific users.
      operationId: shareAgent
      security:
        - bearerAuth: []
      parameters:
        - name: agentKey
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        description: "Request body for Share agent"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ShareRequest'
      responses:
        '200':
          description: Agent shared
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Agent'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden - Only owner can share
        '404':
          description: Agent not found
      x-speakeasy-name-override: share
  /agents/{agentKey}/unshare:
    post:
      tags:
        - Agents
      summary: Revoke agent access
      description: Remove sharing access from specified users.
      operationId: unshareAgent
      security:
        - bearerAuth: []
      parameters:
        - name: agentKey
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        description: "Request body for Revoke agent access"
        content:
          application/json:
            schema:
              type: object
              required:
                - userIds
              properties:
                userIds:
                  type: array
                  items:
                    type: string
                    format: objectId
                  minItems: 1
      responses:
        '200':
          description: Access revoked
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Agent'
        '401':
          description: Unauthorized
        '403':
          description: Forbidden - Only owner can unshare
        '404':
          description: Agent not found
      x-speakeasy-name-override: unshare
  # -------------------- Agent Conversations --------------------
  /agents/{agentKey}/conversations:
    get:
      tags:
        - Agent Conversations
      summary: List agent conversations
      description: |
        Get all conversations with a specific agent.<br><br>
        <b>Overview:</b><br>
        Returns conversations the user has had with this particular agent.
        Agent conversations maintain the agent's context and capabilities.
      operationId: listAgentConversations
      security:
        - bearerAuth: []
      parameters:
        - name: agentKey
          in: path
          required: true
          description: Agent identifier
          schema:
            type: string
      responses:
        '200':
          description: List of agent conversations
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/AgentConversation'
        '401':
          description: Unauthorized
        '404':
          description: Agent not found
      x-speakeasy-group: agentConversations
      x-speakeasy-name-override: list
    post:
      tags:
        - Agent Conversations
      summary: Create agent conversation
      description: |
        Start a new conversation with an agent.<br><br>
        <b>Overview:</b><br>
        Creates a conversation using the agent's configuration including
        its system prompt, tools, and knowledge base access.
      operationId: createAgentConversation
      security:
        - bearerAuth: []
      parameters:
        - name: agentKey
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateConversationRequest'
      responses:
        '201':
          description: Agent conversation created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentConversation'
        '400':
          description: Invalid request
        '401':
          description: Unauthorized
        '404':
          description: Agent not found
      x-speakeasy-group: agentConversations
      x-speakeasy-name-override: start
  /agents/{agentKey}/conversations/stream:
    post:
      tags:
        - Agent Conversations
      summary: Create agent conversation with streaming
      description: |
        Start a new agent conversation with SSE streaming response.<br><br>
        <b>Overview:</b><br>
        Same as POST /agents/{agentKey}/conversations but with real-time streaming.
      operationId: streamAgentConversation
      security:
        - bearerAuth: []
      parameters:
        - name: agentKey
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        description: "Request body for Create agent conversation with streaming"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateConversationRequest'
      responses:
        '200':
          description: SSE stream established
          content:
            text/event-stream:
              schema:
                $ref: '#/components/schemas/SSEEvent'
        '401':
          description: Unauthorized
        '404':
          description: Agent not found
      x-speakeasy-group: agentConversations
      x-speakeasy-name-override: stream
  /agents/{agentKey}/conversations/{conversationId}:
    get:
      tags:
        - Agent Conversations
      summary: Get agent conversation
      description: Retrieve a specific agent conversation by ID.
      operationId: getAgentConversation
      security:
        - bearerAuth: []
      parameters:
        - name: agentKey
          in: path
          required: true
          schema:
            type: string
        - name: conversationId
          in: path
          required: true
          schema:
            type: string
            format: objectId
      responses:
        '200':
          description: Agent conversation details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentConversation'
        '401':
          description: Unauthorized
        '404':
          description: Agent or conversation not found
      x-speakeasy-group: agentConversations
      x-speakeasy-name-override: get
    delete:
      tags:
        - Agent Conversations
      summary: Delete agent conversation
      description: Delete a conversation with an agent.
      operationId: deleteAgentConversation
      security:
        - bearerAuth: []
      parameters:
        - name: agentKey
          in: path
          required: true
          schema:
            type: string
        - name: conversationId
          in: path
          required: true
          schema:
            type: string
            format: objectId
      responses:
        '200':
          description: Conversation deleted
        '401':
          description: Unauthorized
        '404':
          description: Agent or conversation not found
      x-speakeasy-group: agentConversations
      x-speakeasy-name-override: delete
  /agents/{agentKey}/conversations/{conversationId}/messages:
    post:
      tags:
        - Agent Conversations
      summary: Add message to agent conversation
      description: Add a follow-up message to an agent conversation.
      operationId: addAgentMessage
      security:
        - bearerAuth: []
      parameters:
        - name: agentKey
          in: path
          required: true
          schema:
            type: string
        - name: conversationId
          in: path
          required: true
          schema:
            type: string
            format: objectId
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AddMessageRequest'
      responses:
        '200':
          description: Message added
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentConversation'
        '401':
          description: Unauthorized
        '404':
          description: Agent or conversation not found
      x-speakeasy-group: agentConversations
      x-speakeasy-name-override: addMessage
  /agents/{agentKey}/conversations/{conversationId}/messages/stream:
    post:
      tags:
        - Agent Conversations
      summary: Add message with streaming
      description: Add a message to agent conversation with SSE streaming response.
      operationId: streamAgentMessage
      security:
        - bearerAuth: []
      parameters:
        - name: agentKey
          in: path
          required: true
          schema:
            type: string
        - name: conversationId
          in: path
          required: true
          schema:
            type: string
            format: objectId
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AddMessageRequest'
      responses:
        '200':
          description: SSE stream established
          content:
            text/event-stream:
              schema:
                $ref: '#/components/schemas/SSEEvent'
        '401':
          description: Unauthorized
        '404':
          description: Agent or conversation not found
      x-speakeasy-group: agentConversations
      x-speakeasy-name-override: streamMessage
  /agents/{agentKey}/conversations/{conversationId}/message/{messageId}/regenerate:
    post:
      tags:
        - Agent Conversations
      summary: Regenerate agent response
      description: |
        Regenerate the agent's response for a specific message.<br><br>
        <b>Overview:</b><br>
        Similar to conversation regeneration but uses the agent's configuration.
      operationId: regenerateAgentAnswer
      security:
        - bearerAuth: []
      parameters:
        - name: agentKey
          in: path
          required: true
          schema:
            type: string
        - name: conversationId
          in: path
          required: true
          schema:
            type: string
            format: objectId
        - name: messageId
          in: path
          required: true
          schema:
            type: string
            format: objectId
      requestBody:
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                filters:
                  $ref: '#/components/schemas/Filters'
                modelKey:
                  type: string
                chatMode:
                  type: string
      responses:
        '200':
          description: Response regenerated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AgentConversation'
        '401':
          description: Unauthorized
        '404':
          description: Agent, conversation, or message not found
      x-speakeasy-group: agentConversations
      x-speakeasy-name-override: regenerate
  # ==================== CONNECTOR MANAGER ENDPOINTS ====================

  # -------------------- Connector Registry --------------------
  /connectors/registry:
    get:
      tags:
        - Connector Registry
      summary: List available connector types
      description: |
        Get all available connector types from the registry.<br><br>
        <b>Overview:</b><br>
        The registry contains all connector types that can be configured as instances.
        Each type has specific authentication requirements, supported scopes, and capabilities.<br><br>
        <b>Connector Types Include:</b><br>
        <ul>
        <li><b>Google Workspace:</b> Drive, Gmail, Calendar, etc.</li>
        <li><b>Microsoft 365:</b> OneDrive, Outlook, SharePoint, etc.</li>
        <li><b>Cloud Storage:</b> Dropbox, Box, AWS S3</li>
        <li><b>Collaboration:</b> Slack, Confluence, Notion, Jira</li>
        <li><b>Databases:</b> PostgreSQL, MySQL, MongoDB</li>
        </ul>
        <b>Filtering:</b><br>
        Use <code>scope</code> to filter by team or personal connectors.
        Use <code>search</code> for full-text search across connector names.
      operationId: getConnectorRegistry
      security:
        - bearerAuth: []
      parameters:
        - name: scope
          in: query
          description: Filter by scope type
          schema:
            $ref: '#/components/schemas/ConnectorScope'
        - name: page
          in: query
          description: Page number
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          description: Items per page
          schema:
            type: integer
            minimum: 1
            maximum: 200
            default: 20
        - name: search
          in: query
          description: Search term for connector names
          schema:
            type: string
      responses:
        '200':
          description: Connector registry retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  connectors:
                    type: array
                    items:
                      $ref: '#/components/schemas/ConnectorType'
                  pagination:
                    $ref: '#/components/schemas/ConnectorPagination'
        '401':
          description: Unauthorized
      x-speakeasy-group: connectorRegistry
      x-speakeasy-name-override: list
  /connectors/registry/{connectorType}/schema:
    get:
      tags:
        - Connector Registry
      summary: Get connector configuration schema
      description: |
        Get the configuration schema for a specific connector type.<br><br>
        <b>Overview:</b><br>
        Returns JSON Schema definitions for authentication, sync settings, and
        filter options. Use this to dynamically build configuration forms.<br><br>
        <b>Schema Sections:</b><br>
        <ul>
        <li><b>authSchema:</b> Fields for authentication (credentials, tokens)</li>
        <li><b>syncSchema:</b> Sync settings (schedule, incremental options)</li>
        <li><b>filterSchema:</b> Filter field definitions</li>
        </ul>
      operationId: getConnectorSchema
      security:
        - bearerAuth: []
      parameters:
        - name: connectorType
          in: path
          required: true
          description: Connector type identifier
          schema:
            type: string
          example: "google-drive"
      responses:
        '200':
          description: Schema retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  schema:
                    $ref: '#/components/schemas/ConnectorSchema'
        '401':
          description: Unauthorized
        '404':
          description: Connector type not found
      x-speakeasy-group: connectorRegistry
      x-speakeasy-name-override: getSchema
  # -------------------- Connector Instances --------------------
  /connectors:
    get:
      tags:
        - Connector Instances
      summary: List connector instances
      description: |
        Get all configured connector instances for your organization.<br><br>
        <b>Overview:</b><br>
        Returns instances created by users, filtered by scope and permissions.
        Team-scope connectors are visible to all org users. Personal connectors
        are only visible to their creators.<br><br>
        <b>Instance States:</b><br>
        <ul>
        <li><b>isConfigured:</b> All required settings are complete</li>
        <li><b>isAuthenticated:</b> OAuth flow complete or credentials valid</li>
        <li><b>isActive:</b> Connector is enabled for sync/agent</li>
        </ul>
      operationId: listConnectorInstances
      security:
        - bearerAuth: []
      parameters:
        - name: scope
          in: query
          description: Filter by scope (team or personal)
          schema:
            $ref: '#/components/schemas/ConnectorScope'
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 200
            default: 20
        - name: search
          in: query
          description: Search by instance name
          schema:
            type: string
      responses:
        '200':
          description: Instances retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  connectors:
                    type: array
                    items:
                      $ref: '#/components/schemas/ConnectorInstance'
                  pagination:
                    $ref: '#/components/schemas/ConnectorPagination'
        '401':
          description: Unauthorized
      x-speakeasy-group: connectorInstances
      x-speakeasy-name-override: list
    post:
      tags:
        - Connector Instances
      summary: Create connector instance
      description: |
        Create a new connector instance from a registry type.<br><br>
        <b>Overview:</b><br>
        Creates a new connector instance that can then be configured and enabled.
        The instance is created in an unconfigured state and needs authentication
        and filter setup before it can be activated.<br><br>
        <b>Scope Permissions:</b><br>
        <ul>
        <li><code>team</code> scope requires admin privileges</li>
        <li><code>personal</code> scope available to all users</li>
        </ul>
        <b>Next Steps After Creation:</b><br>
        <ol>
        <li>Configure authentication via <code>PUT /{id}/config/auth</code></li>
        <li>Complete OAuth flow if needed via <code>GET /{id}/oauth/authorize</code></li>
        <li>Set up filters via <code>POST /{id}/filters</code></li>
        <li>Enable connector via <code>POST /{id}/toggle</code></li>
        </ol>
      operationId: createConnectorInstance
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateConnectorRequest'
            examples:
              googleDrive:
                summary: Google Drive (Team)
                value:
                  connectorType: "google-drive"
                  instanceName: "Company Google Drive"
                  scope: "team"
                  authType: "OAUTH_ADMIN_CONSENT"
              confluence:
                summary: Confluence (Personal)
                value:
                  connectorType: "confluence"
                  instanceName: "My Confluence"
                  scope: "personal"
                  authType: "API_TOKEN"
      responses:
        '201':
          description: Instance created
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  connector:
                    $ref: '#/components/schemas/ConnectorInstance'
        '400':
          description: |
            Invalid request. Possible reasons:<br>
            <ul>
            <li>Invalid connector type</li>
            <li>Scope not supported by connector</li>
            <li>Duplicate instance name</li>
            </ul>
        '401':
          description: Unauthorized
        '403':
          description: Admin required for team-scope connectors
      x-speakeasy-group: connectorInstances
      x-speakeasy-name-override: create
  /connectors/active:
    get:
      tags:
        - Connector Instances
      summary: List active connector instances
      description: |
        Get all active (enabled) connector instances.<br><br>
        <b>Overview:</b><br>
        Returns only instances where <code>isActive: true</code>.
        These are connectors currently syncing data or available to AI agents.
      operationId: listActiveConnectors
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Active connectors retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  connectors:
                    type: array
                    items:
                      $ref: '#/components/schemas/ConnectorInstance'
        '401':
          description: Unauthorized
      x-speakeasy-group: connectorInstances
      x-speakeasy-name-override: listActive
  /connectors/inactive:
    get:
      tags:
        - Connector Instances
      summary: List inactive connector instances
      description: Get all inactive (disabled) connector instances.
      operationId: listInactiveConnectors
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Inactive connectors retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  connectors:
                    type: array
                    items:
                      $ref: '#/components/schemas/ConnectorInstance'
        '401':
          description: Unauthorized
      x-speakeasy-group: connectorInstances
      x-speakeasy-name-override: listInactive
  /connectors/configured:
    get:
      tags:
        - Connector Instances
      summary: List configured connector instances
      description: |
        Get all connector instances that have completed configuration.<br><br>
        <b>Overview:</b><br>
        Returns instances where <code>isConfigured: true</code>.
        These have all required settings but may not be active yet.
      operationId: listConfiguredConnectors
      security:
        - bearerAuth: []
      parameters:
        - name: scope
          in: query
          schema:
            $ref: '#/components/schemas/ConnectorScope'
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 200
            default: 20
        - name: search
          in: query
          schema:
            type: string
      responses:
        '200':
          description: Configured connectors retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  connectors:
                    type: array
                    items:
                      $ref: '#/components/schemas/ConnectorInstance'
                  pagination:
                    $ref: '#/components/schemas/ConnectorPagination'
        '401':
          description: Unauthorized
      x-speakeasy-group: connectorInstances
      x-speakeasy-name-override: listConfigured
  /connectors/agents/active:
    get:
      tags:
        - Connector Instances
      summary: List active agent connectors
      description: |
        Get connector instances enabled for AI agent integration.<br><br>
        <b>Overview:</b><br>
        Returns connectors where <code>agentEnabled: true</code>.
        These are available to AI agents for querying and actions.
      operationId: listActiveAgentConnectors
      security:
        - bearerAuth: []
      parameters:
        - name: scope
          in: query
          schema:
            $ref: '#/components/schemas/ConnectorScope'
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 200
            default: 20
        - name: search
          in: query
          schema:
            type: string
      responses:
        '200':
          description: Active agent connectors retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  connectors:
                    type: array
                    items:
                      $ref: '#/components/schemas/ConnectorInstance'
                  pagination:
                    $ref: '#/components/schemas/ConnectorPagination'
        '401':
          description: Unauthorized
      x-speakeasy-group: connectorInstances
      x-speakeasy-name-override: getActiveAgents
  /connectors/{connectorId}:
    get:
      tags:
        - Connector Instances
      summary: Get connector instance
      description: Retrieve a specific connector instance by ID.
      operationId: getConnectorInstance
      security:
        - bearerAuth: []
      parameters:
        - name: connectorId
          in: path
          required: true
          description: Connector instance ID
          schema:
            type: string
          example: "conn_abc123"
      responses:
        '200':
          description: Instance retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  connector:
                    $ref: '#/components/schemas/ConnectorInstance'
        '401':
          description: Unauthorized
        '403':
          description: No access to this connector
        '404':
          description: Connector not found
      x-speakeasy-group: connectorInstances
      x-speakeasy-name-override: get
    delete:
      tags:
        - Connector Instances
      summary: Delete connector instance
      description: |
        Delete a connector instance and all associated data.<br><br>
        <b>Warning:</b><br>
        This permanently removes the connector configuration.
        Synced records in knowledge bases are NOT deleted.<br><br>
        <b>Permissions:</b><br>
        <ul>
        <li>Team scope: Requires admin</li>
        <li>Personal scope: Only creator can delete</li>
        </ul>
      operationId: deleteConnectorInstance
      security:
        - bearerAuth: []
      parameters:
        - name: connectorId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Connector deleted
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        '401':
          description: Unauthorized
        '403':
          description: Permission denied
        '404':
          description: Connector not found
      x-speakeasy-group: connectorInstances
      x-speakeasy-name-override: delete
  /connectors/{connectorId}/name:
    put:
      tags:
        - Connector Instances
      summary: Update connector instance name
      description: |
        Update the display name of a connector instance.<br><br>
        <b>Note:</b> This only updates the display name, not the connector configuration.
      operationId: updateConnectorName
      security:
        - bearerAuth: []
      parameters:
        - name: connectorId
          in: path
          required: true
          schema:
            type: string
          description: Unique connector instance ID
      requestBody:
        required: true
        description: "Request body for Update connector instance name"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateConnectorNameRequest'
      responses:
        '200':
          description: Name updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  connector:
                    $ref: '#/components/schemas/ConnectorInstance'
        '400':
          description: Invalid name
        '401':
          description: Unauthorized
        '404':
          description: Connector not found
      x-speakeasy-group: connectorInstances
      x-speakeasy-name-override: updateName
  # -------------------- Connector Configuration --------------------
  /connectors/{connectorId}/config:
    get:
      tags:
        - Connector Configuration
      summary: Get connector configuration
      description: |
        Get the current configuration for a connector instance.<br><br>
        <b>Security:</b><br>
        Sensitive data (credentials, OAuth tokens) are redacted from the response.
        Only admins can see partial credential information.
      operationId: getConnectorConfig
      security:
        - bearerAuth: []
      parameters:
        - name: connectorId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Configuration retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  config:
                    $ref: '#/components/schemas/ConnectorConfig'
        '401':
          description: Unauthorized
        '403':
          description: No access to this connector
        '404':
          description: Connector not found
      x-speakeasy-group: connectorConfiguration
      x-speakeasy-name-override: get
    put:
      tags:
        - Connector Configuration
      summary: Update connector configuration
      description: |
        Update authentication, sync, and filter configuration.<br><br>
        <b>Prerequisites:</b><br>
        Connector must be <b>disabled</b> before updating configuration.
        Disable it first using <code>POST /{id}/toggle</code>.<br><br>
        <b>Partial Updates:</b><br>
        Only provide the sections you want to update. Omitted sections
        are not modified.
      operationId: updateConnectorConfig
      security:
        - bearerAuth: []
      parameters:
        - name: connectorId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateConnectorConfigRequest'
      responses:
        '200':
          description: Configuration updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  config:
                    $ref: '#/components/schemas/ConnectorConfig'
        '400':
          description: |
            Invalid configuration or connector is active.
            Disable connector before updating.
        '401':
          description: Unauthorized
        '404':
          description: Connector not found
      x-speakeasy-group: connectorConfiguration
      x-speakeasy-name-override: update
  /connectors/{connectorId}/config/auth:
    put:
      tags:
        - Connector Configuration
      summary: Update authentication configuration
      description: |
        Update only the authentication configuration.<br><br>
        <b>Use Case:</b><br>
        Use this when you need to update credentials without changing
        sync or filter settings. Useful for credential rotation.<br><br>
        <b>Prerequisites:</b><br>
        Connector must be disabled. This endpoint clears OAuth state,
        requiring re-authentication for OAuth connectors.
      operationId: updateConnectorAuthConfig
      security:
        - bearerAuth: []
      parameters:
        - name: connectorId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateConnectorAuthRequest'
      responses:
        '200':
          description: Auth configuration updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  config:
                    $ref: '#/components/schemas/ConnectorConfig'
        '400':
          description: Connector must be disabled first
        '401':
          description: Unauthorized
        '404':
          description: Connector not found
      x-speakeasy-group: connectorConfigurations
      x-speakeasy-name-override: updateAuth
  /connectors/{connectorId}/config/filters-sync:
    put:
      tags:
        - Connector Configuration
      summary: Update filters and sync configuration
      description: |
        Update filter selections and sync settings without touching auth.<br><br>
        <b>Use Case:</b><br>
        Use this to change what data is synced or adjust sync schedule
        without re-authenticating.
      operationId: updateConnectorFiltersSyncConfig
      security:
        - bearerAuth: []
      parameters:
        - name: connectorId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateConnectorFiltersSyncRequest'
      responses:
        '200':
          description: Configuration updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  config:
                    $ref: '#/components/schemas/ConnectorConfig'
        '401':
          description: Unauthorized
        '404':
          description: Connector not found
      x-speakeasy-group: connectorConfiguration
      x-speakeasy-name-override: updateFiltersSync
  # -------------------- Connector Control --------------------
  /connectors/{connectorId}/toggle:
    post:
      tags:
        - Connector Control
      summary: Toggle connector sync or agent
      description: |
        Enable or disable a connector for sync or agent functionality.<br><br>
        <b>Toggle Types:</b><br>
        <ul>
        <li><code>sync</code> - Enable/disable data synchronization</li>
        <li><code>agent</code> - Enable/disable AI agent integration</li>
        </ul>
        <b>Prerequisites for Enabling:</b><br>
        <ul>
        <li>Connector must be configured (<code>isConfigured: true</code>)</li>
        <li>For OAuth connectors: Must be authenticated (<code>isAuthenticated: true</code>)</li>
        <li>For agent: Connector must support agent (<code>supportsAgent: true</code>)</li>
        </ul>
        <b>Permissions:</b><br>
        <ul>
        <li>Team scope: Requires admin</li>
        <li>Personal scope: Only creator can toggle</li>
        </ul>
      operationId: toggleConnector
      security:
        - bearerAuth: []
      parameters:
        - name: connectorId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ConnectorToggleRequest'
      responses:
        '200':
          description: Connector toggled
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                    example: "Sync enabled successfully"
                  connector:
                    $ref: '#/components/schemas/ConnectorInstance'
        '400':
          description: |
            Cannot toggle. Possible reasons:<br>
            <ul>
            <li>Connector not configured</li>
            <li>OAuth not authenticated</li>
            <li>Agent not supported</li>
            </ul>
        '401':
          description: Unauthorized
        '403':
          description: Permission denied
        '404':
          description: Connector not found
      x-speakeasy-group: connectorControl
      x-speakeasy-name-override: toggle
  # -------------------- Legacy Token Exchange --------------------
  /connectors/getTokenFromCode:
    post:
      tags:
        - Connector OAuth
      summary: Exchange authorization code for tokens (legacy)
      description: |
        Exchange a Google Workspace authorization code for access and refresh tokens.<br><br>
        <b>Note:</b> This is a legacy endpoint specific to Google Workspace connectors.
        For new integrations, use the standard OAuth flow via
        <code>/connectors/{connectorId}/oauth/authorize</code> and the callback.<br><br>
        <b>Flow:</b><br>
        <ol>
        <li>User completes Google Workspace OAuth consent in the browser</li>
        <li>Browser receives authorization code</li>
        <li>Frontend sends the code to this endpoint</li>
        <li>Backend exchanges code for tokens and stores them</li>
        </ol>
        <b>Admin Only:</b> Requires admin privileges.
      operationId: getTokenFromCode
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Authorization code from Google OAuth consent"
        content:
          application/json:
            schema:
              type: object
              required:
                - code
              properties:
                code:
                  type: string
                  description: Authorization code from Google OAuth consent flow
      responses:
        '200':
          description: Tokens exchanged and stored successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        '400':
          description: Invalid or expired authorization code
        '401':
          description: Unauthorized
        '403':
          description: Admin access required
        '404':
          description: Google Workspace configuration not found
      x-speakeasy-group: connectorOAuth
  # -------------------- Connector OAuth --------------------
  /connectors/{connectorId}/oauth/authorize:
    get:
      tags:
        - Connector OAuth
      summary: Get OAuth authorization URL
      description: |
        Generate an OAuth authorization URL to start the OAuth flow.<br><br>
        <b>Flow:</b><br>
        <ol>
        <li>Call this endpoint to get the authorization URL</li>
        <li>Redirect user's browser to the URL</li>
        <li>User authenticates with the provider</li>
        <li>Provider redirects to callback with authorization code</li>
        <li>Callback exchanges code for tokens automatically</li>
        </ol>
        <b>State Parameter:</b><br>
        The response includes a <code>state</code> value that encodes the
        connector ID. This is validated in the callback.
      operationId: getOAuthAuthorizationUrl
      security:
        - bearerAuth: []
      parameters:
        - name: connectorId
          in: path
          required: true
          schema:
            type: string
        - name: baseUrl
          in: query
          description: Base URL for self-hosted instances
          schema:
            type: string
      responses:
        '200':
          description: Authorization URL generated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  authorizationUrl:
                    type: string
                    description: Redirect user to this URL
                  state:
                    type: string
                    description: State parameter for validation
        '400':
          description: Connector doesn't support OAuth
        '401':
          description: Unauthorized
        '404':
          description: Connector not found
      x-speakeasy-group: connectorOAuth
      x-speakeasy-name-override: getAuthorizationUrl
  /connectors/oauth/callback:
    get:
      tags:
        - Connector OAuth
      summary: OAuth callback handler
      description: |
        Handle the OAuth callback from the identity provider.<br><br>
        <b>Note:</b><br>
        This endpoint is called by the OAuth provider after user authentication.
        The state parameter contains the encoded connector ID.<br><br>
        <b>Success:</b><br>
        On success, tokens are stored and the connector becomes authenticated.
        User is redirected to the frontend success page.<br><br>
        <b>Error:</b><br>
        If the provider returns an error (e.g., user denied access),
        user is redirected with error information.
      operationId: handleOAuthCallback
      security: []
      parameters:
        - name: code
          in: query
          description: Authorization code from provider
          schema:
            type: string
        - name: state
          in: query
          description: State parameter (contains connector ID)
          schema:
            type: string
        - name: error
          in: query
          description: Error code if authorization failed
          schema:
            type: string
        - name: baseUrl
          in: query
          description: Base URL for redirect
          schema:
            type: string
      responses:
        '302':
          description: Redirect to frontend with result
          headers:
            Location:
              description: Frontend URL with success/error params
              schema:
                type: string
        '400':
          description: Invalid or missing state parameter
      x-speakeasy-group: connectorOAuth
      x-speakeasy-name-override: handleCallback
  # -------------------- Connector Filters --------------------
  /connectors/{connectorId}/filters:
    get:
      tags:
        - Connector Filters
      summary: Get filter options
      description: |
        Get available filter options for a connector.<br><br>
        <b>Overview:</b><br>
        Returns filter fields that can be used to limit what data is synced.
        For example, a Google Drive connector might offer filters for
        specific folders or file types.<br><br>
        <b>Dynamic Filters:</b><br>
        Some filter fields have <code>dynamic: true</code>, meaning their
        options are loaded separately via the filter options endpoint.
      operationId: getConnectorFilters
      security:
        - bearerAuth: []
      parameters:
        - name: connectorId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Filter options retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  filterOptions:
                    $ref: '#/components/schemas/FilterOptions'
        '401':
          description: Unauthorized
        '404':
          description: Connector not found
      x-speakeasy-group: connectorFilters
      x-speakeasy-name-override: getOptions
    post:
      tags:
        - Connector Filters
      summary: Save filter selections
      description: |
        Save the user's filter selections for a connector.<br><br>
        <b>Overview:</b><br>
        After viewing filter options, use this endpoint to save the
        selected values. These determine what data will be synced.
      operationId: saveConnectorFilters
      security:
        - bearerAuth: []
      parameters:
        - name: connectorId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SaveConnectorFiltersRequest'
      responses:
        '200':
          description: Filters saved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        '401':
          description: Unauthorized
        '404':
          description: Connector not found
      x-speakeasy-group: connectorFilters
      x-speakeasy-name-override: save
  /connectors/{connectorId}/filters/{filterKey}/options:
    get:
      tags:
        - Connector Filters
      summary: Get dynamic filter options
      description: |
        Get options for a dynamic filter field with pagination.<br><br>
        <b>Overview:</b><br>
        For filters with <code>dynamic: true</code>, options are loaded
        from the connected service. This supports pagination and search.<br><br>
        <b>Examples:</b><br>
        <ul>
        <li>Google Drive folders list</li>
        <li>Slack channels list</li>
        <li>Confluence spaces list</li>
        </ul>
      operationId: getFilterFieldOptions
      security:
        - bearerAuth: []
      parameters:
        - name: connectorId
          in: path
          required: true
          schema:
            type: string
        - name: filterKey
          in: path
          required: true
          description: Filter field key
          schema:
            type: string
          example: "folders"
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
        - name: search
          in: query
          description: Search term for filtering options
          schema:
            type: string
        - name: cursor
          in: query
          description: Cursor for cursor-based pagination
          schema:
            type: string
      responses:
        '200':
          description: Options retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  options:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                        value:
                          type: string
                        label:
                          type: string
                  pagination:
                    type: object
                    properties:
                      page:
                        type: integer
                      limit:
                        type: integer
                      hasMore:
                        type: boolean
                      cursor:
                        type: string
        '401':
          description: Unauthorized
        '404':
          description: Connector or filter not found
      x-speakeasy-group: connectorFilters
      x-speakeasy-name-override: getFieldOptions
  # -------------------- OAuth Configuration (Admin) --------------------
  /oauth/registry:
    get:
      tags:
        - OAuth Configuration
      summary: List OAuth-capable connector types
      description: |
        Get all connector types that support OAuth authentication.<br><br>
        <b>Admin Use:</b><br>
        Admins use this to see which connector types need OAuth credentials
        to be configured before users can authenticate.
      operationId: getOAuthRegistry
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 200
            default: 20
        - name: search
          in: query
          schema:
            type: string
      responses:
        '200':
          description: OAuth connector types retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  connectors:
                    type: array
                    items:
                      $ref: '#/components/schemas/ConnectorType'
                  pagination:
                    $ref: '#/components/schemas/ConnectorPagination'
        '401':
          description: Unauthorized
      x-speakeasy-group: oauthConfiguration
      x-speakeasy-name-override: getRegistry
  /oauth/registry/{connectorType}:
    get:
      tags:
        - OAuth Configuration
      summary: Get OAuth connector type details
      description: Get details for a specific OAuth-capable connector type.
      operationId: getOAuthConnectorType
      security:
        - bearerAuth: []
      parameters:
        - name: connectorType
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Connector type retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  connector:
                    $ref: '#/components/schemas/ConnectorType'
        '401':
          description: Unauthorized
        '404':
          description: Connector type not found
      x-speakeasy-group: oauthConfigurations
      x-speakeasy-name-override: getConnectorType
  /oauth:
    get:
      tags:
        - OAuth Configuration
      summary: List OAuth configurations
      description: |
        List all OAuth configurations for the organization.<br><br>
        <b>Security:</b><br>
        <ul>
        <li>Admins see full configuration including credentials</li>
        <li>Non-admins see only essential fields (client ID, not secret)</li>
        </ul>
      operationId: listOAuthConfigs
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 200
            default: 20
        - name: search
          in: query
          schema:
            type: string
      responses:
        '200':
          description: OAuth configurations retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  oauthConfigs:
                    type: array
                    items:
                      $ref: '#/components/schemas/OAuthConfig'
                  pagination:
                    $ref: '#/components/schemas/ConnectorPagination'
        '401':
          description: Unauthorized
      x-speakeasy-group: oauthConfiguration
      x-speakeasy-name-override: list
  /oauth/{connectorType}:
    get:
      tags:
        - OAuth Configuration
      summary: List OAuth configs for connector type
      description: Get all OAuth configurations for a specific connector type.
      operationId: listOAuthConfigsByType
      security:
        - bearerAuth: []
      parameters:
        - name: connectorType
          in: path
          required: true
          schema:
            type: string
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 200
            default: 20
        - name: search
          in: query
          schema:
            type: string
      responses:
        '200':
          description: OAuth configurations retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  oauthConfigs:
                    type: array
                    items:
                      $ref: '#/components/schemas/OAuthConfig'
                  pagination:
                    $ref: '#/components/schemas/ConnectorPagination'
        '401':
          description: Unauthorized
        '404':
          description: Connector type not found
      x-speakeasy-group: oauthConfiguration
      x-speakeasy-name-override: listConfigsByType
    post:
      tags:
        - OAuth Configuration
      summary: Create OAuth configuration
      description: |
        Create a new OAuth configuration for a connector type.<br><br>
        <b>Admin Only:</b><br>
        Only admins can create OAuth configurations. These provide the
        OAuth credentials needed for users to authenticate connectors.<br><br>
        <b>Use Case:</b><br>
        Before users can create Google Drive connectors with OAuth,
        an admin must create an OAuth configuration with the Google
        OAuth client ID and secret.
      operationId: createOAuthConfig
      security:
        - bearerAuth: []
      parameters:
        - name: connectorType
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateOAuthConfigRequest'
      responses:
        '201':
          description: OAuth configuration created
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  oauthConfig:
                    $ref: '#/components/schemas/OAuthConfig'
                  message:
                    type: string
        '400':
          description: Invalid configuration or duplicate name
        '401':
          description: Unauthorized
        '403':
          description: Admin access required
        '404':
          description: Connector type not found
      x-speakeasy-group: oAuthConfiguration
      x-speakeasy-name-override: create
  /oauth/{connectorType}/{configId}:
    get:
      tags:
        - OAuth Configuration
      summary: Get OAuth configuration
      description: Get a specific OAuth configuration by ID.
      operationId: getOAuthConfig
      security:
        - bearerAuth: []
      parameters:
        - name: connectorType
          in: path
          required: true
          schema:
            type: string
        - name: configId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: OAuth configuration retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  oauthConfig:
                    $ref: '#/components/schemas/OAuthConfig'
        '401':
          description: Unauthorized
        '404':
          description: Configuration not found
      x-speakeasy-group: oauthConfiguration
      x-speakeasy-name-override: get
    put:
      tags:
        - OAuth Configuration
      summary: Update OAuth configuration
      description: |
        Update an OAuth configuration.<br><br>
        <b>Admin Only:</b><br>
        Only the creator or another admin can update.
      operationId: updateOAuthConfig
      security:
        - bearerAuth: []
      parameters:
        - name: connectorType
          in: path
          required: true
          schema:
            type: string
        - name: configId
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                oauthInstanceName:
                  type: string
                config:
                  type: object
                  properties:
                    clientId:
                      type: string
                    clientSecret:
                      type: string
                    tenantId:
                      type: string
      responses:
        '200':
          description: OAuth configuration updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  oauthConfig:
                    $ref: '#/components/schemas/OAuthConfig'
        '400':
          description: Invalid configuration
        '401':
          description: Unauthorized
        '403':
          description: Admin access required
        '404':
          description: Configuration not found
      x-speakeasy-group: oauthConfiguration
      x-speakeasy-name-override: update
    delete:
      tags:
        - OAuth Configuration
      summary: Delete OAuth configuration
      description: |
        Delete an OAuth configuration.<br><br>
        <b>Warning:</b><br>
        Cannot delete if the configuration is used by active connectors.
        Disable or delete dependent connectors first.
      operationId: deleteOAuthConfig
      security:
        - bearerAuth: []
      parameters:
        - name: connectorType
          in: path
          required: true
          schema:
            type: string
        - name: configId
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: OAuth configuration deleted
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        '400':
          description: Cannot delete - used by active connectors
        '401':
          description: Unauthorized
        '403':
          description: Admin access required
        '404':
          description: Configuration not found
      x-speakeasy-group: oauthConfigurations
      x-speakeasy-name-override: deleteConfiguration
  # ==================== CONFIGURATION MANAGER ENDPOINTS ====================

  # -------------------- Storage Configuration --------------------
  # Local Storage
  /configurationManager/storageConfig#local:
    post:
      tags:
        - Storage Configuration
      summary: Configure Local Storage
      description: Configure local filesystem as the storage backend for file uploads and document storage. Suitable for development or on-premise deployments.
      operationId: createLocalStorageConfig
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request body for Configure Local Storage"
        content:
          application/json:
            schema:
              type: object
              required:
                - storageType
              properties:
                storageType:
                  type: string
                  enum: [local]
                  description: Storage type identifier
                  example: local
                mountName:
                  type: string
                  description: Mount point name for local storage directory
                  default: PipesHub
                  example: PipesHub
                baseUrl:
                  type: string
                  format: uri
                  description: Base URL for accessing locally stored files
                  example: http://localhost:3000/storage
      responses:
        '200':
          description: Local storage configuration saved successfully
        '400':
          description: Invalid configuration
        '401':
          description: Unauthorized
        '403':
          description: Admin access required
      x-speakeasy-group: storageConfiguration
      x-speakeasy-name-override: configureLocal
  # AWS S3 Storage
  /configurationManager/storageConfig#s3:
    post:
      tags:
        - Storage Configuration
      summary: Configure AWS S3 Storage
      description: Configure AWS S3 as the storage backend for file uploads and document storage. Requires an S3 bucket and IAM credentials with appropriate permissions.
      operationId: createS3StorageConfig
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request body for Configure AWS S3 Storage"
        content:
          application/json:
            schema:
              type: object
              required:
                - storageType
                - s3AccessKeyId
                - s3SecretAccessKey
                - s3Region
                - s3BucketName
              properties:
                storageType:
                  type: string
                  enum: [s3]
                  description: Storage type identifier
                  example: s3
                s3AccessKeyId:
                  type: string
                  description: AWS IAM access key ID with S3 permissions
                  example: AKIAIOSFODNN7EXAMPLE
                s3SecretAccessKey:
                  type: string
                  description: AWS IAM secret access key
                  example: wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY
                s3Region:
                  type: string
                  description: AWS region where the S3 bucket is located
                  example: us-east-1
                s3BucketName:
                  type: string
                  description: Name of the S3 bucket for storing files
                  example: my-pipeshub-bucket
      responses:
        '200':
          description: S3 storage configuration saved successfully
        '400':
          description: Invalid configuration
        '401':
          description: Unauthorized
        '403':
          description: Admin access required
      x-speakeasy-group: storageConfiguration
  # Azure Blob Storage
  /configurationManager/storageConfig#azureBlob:
    post:
      tags:
        - Storage Configuration
      summary: Configure Azure Blob Storage
      description: |
        Configure Azure Blob Storage as the storage backend. You can provide either:
        - A full connection string (azureBlobConnectionString), OR
        - Individual credentials (accountName, accountKey, endpointProtocol, endpointSuffix)
      operationId: createAzureBlobStorageConfig
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request body for Configure Azure Blob Storage"
        content:
          application/json:
            schema:
              type: object
              required:
                - storageType
                - containerName
              properties:
                storageType:
                  type: string
                  enum: [azureBlob]
                  description: Storage type identifier
                  example: azureBlob
                containerName:
                  type: string
                  description: Azure Blob container name for storing files
                  example: pipeshub-files
                azureBlobConnectionString:
                  type: string
                  description: Full Azure Blob connection string. If provided, accountName and accountKey are not required.
                  example: "DefaultEndpointsProtocol=https;AccountName=myaccount;AccountKey=mykey;EndpointSuffix=core.windows.net"
                accountName:
                  type: string
                  description: Azure storage account name. Required if not using connection string.
                  example: mystorageaccount
                accountKey:
                  type: string
                  description: Azure storage account access key. Required if not using connection string.
                  example: base64encodedaccountkey==
                endpointProtocol:
                  type: string
                  description: Protocol for Azure Blob endpoint
                  default: https
                  example: https
                endpointSuffix:
                  type: string
                  description: Azure endpoint suffix
                  default: core.windows.net
                  example: core.windows.net
      responses:
        '200':
          description: Azure Blob storage configuration saved successfully
        '400':
          description: Invalid configuration
        '401':
          description: Unauthorized
        '403':
          description: Admin access required
      x-speakeasy-group: storageConfiguration
      x-speakeasy-name-override: createAzureBlob
  # Get Storage Configuration
  /configurationManager/storageConfig:
    get:
      tags:
        - Storage Configuration
      summary: Get current storage configuration
      description: Retrieve the current storage backend configuration. Returns the configuration for whichever storage type is currently active (Local, S3, or Azure Blob).
      operationId: getStorageConfig
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Storage configuration retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  storageType:
                    type: string
                    enum: [local, s3, azureBlob]
                    description: Currently configured storage type
                  mountName:
                    type: string
                    description: Mount point name (Local)
                  baseUrl:
                    type: string
                    description: Base URL for files (Local)
                  accessKeyId:
                    type: string
                    description: AWS access key ID (S3)
                  secretAccessKey:
                    type: string
                    description: AWS secret access key (S3)
                  region:
                    type: string
                    description: AWS region (S3)
                  bucketName:
                    type: string
                    description: S3 bucket name (S3)
                  containerName:
                    type: string
                    description: Container name (Azure Blob)
                  accountName:
                    type: string
                    description: Storage account name (Azure Blob)
        '404':
          description: Storage configuration not found
        '401':
          description: Unauthorized
      x-speakeasy-group: storageConfiguration
      x-speakeasy-name-override: get
  # -------------------- SMTP Configuration --------------------
  /configurationManager/smtpConfig:
    post:
      tags:
        - SMTP Configuration
      summary: Create or update SMTP configuration
      description: |
        Configure SMTP email server for sending system emails including user invitations, notifications, and password resets.

        Common SMTP providers and their settings:
        - Gmail: host=smtp.gmail.com, port=587 (requires App Password)
        - SendGrid: host=smtp.sendgrid.net, port=587
        - Amazon SES: host=email-smtp.{region}.amazonaws.com, port=587
        - Microsoft 365: host=smtp.office365.com, port=587

        Configuration is encrypted before storage.
      operationId: createSMTPConfig
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request body for Create or update SMTP configuration"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SMTPConfig'
            examples:
              gmail:
                summary: Gmail SMTP
                value:
                  host: smtp.gmail.com
                  port: 587
                  username: notifications@yourcompany.com
                  password: your-app-password
                  fromEmail: noreply@yourcompany.com
              sendgrid:
                summary: SendGrid SMTP
                value:
                  host: smtp.sendgrid.net
                  port: 587
                  username: apikey
                  password: SG.your-sendgrid-api-key
                  fromEmail: noreply@yourcompany.com
              amazonSes:
                summary: Amazon SES SMTP
                value:
                  host: email-smtp.us-east-1.amazonaws.com
                  port: 587
                  username: AKIAIOSFODNN7EXAMPLE
                  password: your-ses-smtp-password
                  fromEmail: noreply@yourcompany.com
              office365:
                summary: Microsoft 365 SMTP
                value:
                  host: smtp.office365.com
                  port: 587
                  username: notifications@yourcompany.onmicrosoft.com
                  password: your-password
                  fromEmail: notifications@yourcompany.onmicrosoft.com
      responses:
        '200':
          description: SMTP configuration saved successfully
        '400':
          description: Invalid configuration
        '401':
          description: Unauthorized
        '403':
          description: Admin access required
      x-speakeasy-group: smtpConfiguration
      x-speakeasy-name-override: createOrUpdate
    get:
      tags:
        - SMTP Configuration
      summary: Get SMTP configuration
      description: Retrieve the current SMTP server configuration. Password is included in the response for admin users.
      operationId: getSMTPConfig
      security:
        - bearerAuth: []
      responses:
        '200':
          description: SMTP configuration retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SMTPConfig'
        '401':
          description: Unauthorized
      x-speakeasy-group: smtpConfiguration
      x-speakeasy-name-override: get
  # -------------------- Authentication Configuration --------------------
  /configurationManager/authConfig/azureAd:
    post:
      tags:
        - Authentication Configuration
      summary: Configure Azure AD authentication
      description: Set up Azure Active Directory as an authentication provider for user login.
      operationId: setAzureAdAuthConfig
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request body for Configure Azure AD authentication"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AzureAdAuthConfig'
      responses:
        '200':
          description: Azure AD configuration saved
        '400':
          description: Invalid configuration
        '401':
          description: Unauthorized
        '403':
          description: Admin access required
      x-speakeasy-group: authenticationConfiguration
    get:
      tags:
        - Authentication Configuration
      summary: Get Azure AD configuration
      description: Retrieve Azure AD authentication configuration.
      operationId: getAzureAdAuthConfig
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Azure AD configuration retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AzureAdAuthConfig'
        '401':
          description: Unauthorized
      x-speakeasy-group: authenticationConfiguration
      x-speakeasy-name-override: getAzureAd
  /configurationManager/authConfig/microsoft:
    post:
      tags:
        - Authentication Configuration
      summary: Configure Microsoft authentication
      description: Set up Microsoft account as an authentication provider.
      operationId: setMicrosoftAuthConfig
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request body for Configure Microsoft authentication"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MicrosoftAuthConfig'
      responses:
        '200':
          description: Microsoft auth configuration saved
        '400':
          description: Invalid configuration
        '401':
          description: Unauthorized
        '403':
          description: Admin access required
      x-speakeasy-group: authenticationConfigurations
      x-speakeasy-name-override: configureMicrosoft
    get:
      tags:
        - Authentication Configuration
      summary: Get Microsoft authentication configuration
      description: "Get Microsoft authentication configuration."
      operationId: getMicrosoftAuthConfig
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Microsoft auth configuration retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MicrosoftAuthConfig'
        '401':
          description: Unauthorized
      x-speakeasy-group: authConfig
      x-speakeasy-name-override: getMicrosoft
  /configurationManager/authConfig/google:
    post:
      tags:
        - Authentication Configuration
      summary: Configure Google authentication
      description: Set up Google OAuth as an authentication provider.
      operationId: setGoogleAuthConfig
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request body for Configure Google authentication"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GoogleAuthConfig'
      responses:
        '200':
          description: Google auth configuration saved
        '400':
          description: Invalid configuration
        '401':
          description: Unauthorized
        '403':
          description: Admin access required
      x-speakeasy-group: authenticationConfiguration
    get:
      tags:
        - Authentication Configuration
      summary: Get Google authentication configuration
      description: "Get Google authentication configuration."
      operationId: getGoogleAuthConfig
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Google auth configuration retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GoogleAuthConfig'
        '401':
          description: Unauthorized
      x-speakeasy-group: authenticationConfiguration
      x-speakeasy-name-override: getGoogle
  /configurationManager/authConfig/sso:
    post:
      tags:
        - Authentication Configuration
      summary: Configure SAML SSO authentication
      description: Set up SAML 2.0 Single Sign-On with your identity provider (Okta, OneLogin, etc.).
      operationId: setSsoAuthConfig
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request body for Configure SAML SSO authentication"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SSOAuthConfig'
      responses:
        '200':
          description: SSO configuration saved
        '400':
          description: Invalid configuration
        '401':
          description: Unauthorized
        '403':
          description: Admin access required
      x-speakeasy-group: authenticationConfiguration
      x-speakeasy-name-override: setupSso
    get:
      tags:
        - Authentication Configuration
      summary: Get SAML SSO configuration
      description: "Get SAML SSO configuration."
      operationId: getSsoAuthConfig
      security:
        - bearerAuth: []
      responses:
        '200':
          description: SSO configuration retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SSOAuthConfig'
        '401':
          description: Unauthorized
      x-speakeasy-group: authenticationConfiguration
      x-speakeasy-name-override: getSsoConfig
  /configurationManager/authConfig/oauth:
    post:
      tags:
        - Authentication Configuration
      summary: Configure generic OAuth provider
      description: Set up a custom OAuth 2.0 authentication provider.
      operationId: setOAuthConfig
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request body for Configure generic OAuth provider"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GenericOAuthConfig'
      responses:
        '200':
          description: OAuth configuration saved
        '400':
          description: Invalid configuration
        '401':
          description: Unauthorized
        '403':
          description: Admin access required
      x-speakeasy-group: authenticationConfiguration
      x-speakeasy-name-override: setupOAuth
    get:
      tags:
        - Authentication Configuration
      summary: Get generic OAuth configuration
      description: "Get generic OAuth configuration."
      operationId: getGenericOAuthConfig
      security:
        - bearerAuth: []
      responses:
        '200':
          description: OAuth configuration retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericOAuthConfig'
        '401':
          description: Unauthorized
      x-speakeasy-group: authenticationConfiguration
      x-speakeasy-name-override: getOAuth
  # -------------------- AI Models Configuration --------------------
  /configurationManager/aiModelsConfig:
    post:
      tags:
        - AI Models Configuration
      summary: Bulk create AI models configuration
      description: "Configure multiple AI model providers at once. Performs health checks on each model before saving. Use this for initial setup - for individual model management, use /ai-models/providers endpoints."
      operationId: createAIModelsConfig
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request body for Bulk create AI models configuration"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AIModelsConfig'
      responses:
        '200':
          description: AI models configuration saved (includes health check results)
        '400':
          description: Invalid configuration or health check failed
        '401':
          description: Unauthorized
        '403':
          description: Admin access required
      x-speakeasy-group: aiModelsConfiguration
      x-speakeasy-name-override: create
    get:
      tags:
        - AI Models Configuration
      summary: Get all AI models configuration
      description: Retrieve all configured AI model providers grouped by type.
      operationId: getAIModelsConfig
      security:
        - bearerAuth: []
      responses:
        '200':
          description: AI models configuration retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AIModelsConfig'
        '401':
          description: Unauthorized
      x-speakeasy-group: aiModelsConfiguration
      x-speakeasy-name-override: getAll
  # -------------------- AI Models Provider Management --------------------
  /configurationManager/ai-models:
    get:
      tags:
        - AI Models Providers
      summary: Get all AI model providers
      description: List all configured AI model providers with their configurations.
      operationId: getAIModelsProviders
      security:
        - bearerAuth: []
      responses:
        '200':
          description: AI model providers retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AIModelsConfig'
        '401':
          description: Unauthorized
      x-speakeasy-group: aiModelsProviders
      x-speakeasy-name-override: list
  /configurationManager/ai-models/{modelType}:
    get:
      tags:
        - AI Models Providers
      summary: Get models by type
      description: Get all configured models of a specific type.
      operationId: getModelsByType
      security:
        - bearerAuth: []
      parameters:
        - name: modelType
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/ModelType'
          description: Type of AI model
      responses:
        '200':
          description: Models retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  models:
                    type: array
                    items:
                      $ref: '#/components/schemas/AIModelProviderConfig'
        '401':
          description: Unauthorized
      x-speakeasy-group: aiModelsProviders
      x-speakeasy-name-override: getByType
  /configurationManager/ai-models/available/{modelType}:
    get:
      tags:
        - AI Models Providers
      summary: Get available models for selection
      description: Get available models in a flattened format for UI selection dropdowns.
      operationId: getAvailableModelsByType
      security:
        - bearerAuth: []
      parameters:
        - name: modelType
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/ModelType'
      responses:
        '200':
          description: Available models retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  models:
                    type: array
                    items:
                      type: object
                      properties:
                        modelKey:
                          type: string
                        provider:
                          type: string
                        model:
                          type: string
                        isDefault:
                          type: boolean
        '401':
          description: Unauthorized
      x-speakeasy-group: aiModelsProviders
  /configurationManager/ai-models/providers:
    post:
      tags:
        - AI Models Providers
      summary: Add new AI model provider
      description: "Add a new AI model provider configuration. Performs a health check before saving to verify connectivity. Supported providers: openai, anthropic, azure-openai, aws-bedrock, google-vertex, ollama, huggingface."
      operationId: addAIModelProvider
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request body for Add new AI model provider"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AddAIModelProviderRequest'
      responses:
        '201':
          description: AI model provider added successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AIModelProviderResponse'
        '400':
          description: Invalid configuration or health check failed
        '401':
          description: Unauthorized
        '403':
          description: Admin access required
      x-speakeasy-group: aiModelsProviders
      x-speakeasy-name-override: add
  /configurationManager/ai-models/providers/{modelType}/{modelKey}:
    put:
      tags:
        - AI Models Providers
      summary: Update AI model provider
      description: Update an existing AI model provider configuration.
      operationId: updateAIModelProvider
      security:
        - bearerAuth: []
      parameters:
        - name: modelType
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/ModelType'
        - name: modelKey
          in: path
          required: true
          schema:
            type: string
          description: Unique model key (UUID)
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateAIModelProviderRequest'
      responses:
        '200':
          description: AI model provider updated
        '400':
          description: Invalid configuration
        '401':
          description: Unauthorized
        '403':
          description: Admin access required
        '404':
          description: Model provider not found
      x-speakeasy-group: aiModelsProviders
      x-speakeasy-name-override: update
    delete:
      tags:
        - AI Models Providers
      summary: Delete AI model provider
      description: Remove an AI model provider configuration. Cannot delete the default model if it's the only one.
      operationId: deleteAIModelProvider
      security:
        - bearerAuth: []
      parameters:
        - name: modelType
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/ModelType'
        - name: modelKey
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: AI model provider deleted
        '400':
          description: Cannot delete default model
        '401':
          description: Unauthorized
        '403':
          description: Admin access required
        '404':
          description: Model provider not found
      x-speakeasy-group: aiModelsProviders
      x-speakeasy-name-override: delete
  /configurationManager/ai-models/default/{modelType}/{modelKey}:
    put:
      tags:
        - AI Models Providers
      summary: Set default AI model
      description: Set a model as the default for its type.
      operationId: setDefaultAIModel
      security:
        - bearerAuth: []
      parameters:
        - name: modelType
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/ModelType'
        - name: modelKey
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Default model updated
        '401':
          description: Unauthorized
        '403':
          description: Admin access required
        '404':
          description: Model not found
      x-speakeasy-group: aiModelsProviders
      x-speakeasy-name-override: setDefault
  # -------------------- Connector Configuration --------------------
  /configurationManager/connectors/googleWorkspaceCredentials:
    post:
      tags:
        - Connector OAuth Configuration
      summary: Upload Google Workspace credentials
      description: "Upload Google Workspace credentials (service account JSON for business, or OAuth tokens for individual users). File must be valid JSON."
      operationId: createGoogleWorkspaceCredentials
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request body for Upload Google Workspace credentials"
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - userType
                - googleWorkspaceCredentials
              properties:
                userType:
                  type: string
                  enum: [individual, business]
                  description: "Type: 'business' for service account, 'individual' for user OAuth"
                googleWorkspaceCredentials:
                  type: string
                  format: binary
                  description: JSON credentials file
      responses:
        '200':
          description: Credentials uploaded successfully
        '400':
          description: Invalid credentials file
        '401':
          description: Unauthorized
        '403':
          description: Admin access required
      x-speakeasy-group: connectorOAuthConfiguration
    get:
      tags:
        - Connector Configuration
      summary: Get Google Workspace credentials status
      description: Check if Google Workspace credentials are configured.
      operationId: getGoogleWorkspaceCredentials
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Credentials status retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GoogleWorkspaceCredentials'
        '401':
          description: Unauthorized
      x-speakeasy-group: connectorConfigurations
  /configurationManager/connectors/googleWorkspaceOauthConfig:
    post:
      tags:
        - Connector OAuth Configuration
      summary: Configure Google Workspace OAuth
      description: Set up OAuth credentials for Google Workspace connector. Required for user authentication with Google Drive, Gmail, etc.
      operationId: setGoogleWorkspaceOauthConfig
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request body for Configure Google Workspace OAuth"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GoogleWorkspaceOAuthConfig'
      responses:
        '200':
          description: OAuth configuration saved
        '400':
          description: Invalid configuration
        '401':
          description: Unauthorized
        '403':
          description: Admin access required
      x-speakeasy-group: connectorOAuthConfigurations
      x-speakeasy-name-override: setGoogleWorkspaceOauth
    get:
      tags:
        - Connector OAuth Configuration
      summary: Get Google Workspace OAuth configuration
      description: "Get Google Workspace OAuth configuration."
      operationId: getGoogleWorkspaceOauthConfig
      security:
        - bearerAuth: []
      responses:
        '200':
          description: OAuth configuration retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GoogleWorkspaceOAuthConfig'
        '401':
          description: Unauthorized
      x-speakeasy-group: connectorOAuthConfiguration
      x-speakeasy-name-override: getGoogleWorkspace
  /configurationManager/connectors/atlassian/config:
    post:
      tags:
        - Connector OAuth Configuration
      summary: Configure Atlassian OAuth
      description: Set up OAuth credentials for Atlassian (Confluence/Jira) connector.
      operationId: setAtlassianConfig
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request body for Configure Atlassian OAuth"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AtlassianConfig'
      responses:
        '200':
          description: Atlassian configuration saved
        '400':
          description: Invalid configuration
        '401':
          description: Unauthorized
        '403':
          description: Admin access required
      x-speakeasy-group: connectorOAuthConfiguration
    get:
      tags:
        - Connector OAuth Configuration
      summary: Get Atlassian OAuth configuration
      description: "Get Atlassian OAuth configuration."
      operationId: getAtlassianConfig
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Atlassian configuration retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AtlassianConfig'
        '401':
          description: Unauthorized
      x-speakeasy-group: connectorOauthConfiguration
  /configurationManager/connectors/onedrive/config:
    post:
      tags:
        - Connector OAuth Configuration
      summary: Configure OneDrive connector
      description: Set up Microsoft credentials for OneDrive connector.
      operationId: setOneDriveConfig
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request body for Configure OneDrive connector"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OneDriveConfig'
      responses:
        '200':
          description: OneDrive configuration saved
        '400':
          description: Invalid configuration
        '401':
          description: Unauthorized
        '403':
          description: Admin access required
      x-speakeasy-group: connectorOAuthConfigurations
      x-speakeasy-name-override: configureOneDrive
    get:
      tags:
        - Connector OAuth Configuration
      summary: Get OneDrive configuration
      description: "Get OneDrive configuration."
      operationId: getOneDriveConfig
      security:
        - bearerAuth: []
      responses:
        '200':
          description: OneDrive configuration retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OneDriveConfig'
        '401':
          description: Unauthorized
      x-speakeasy-group: connectorOauthConfiguration
  /configurationManager/connectors/sharepoint/config:
    post:
      tags:
        - Connector OAuth Configuration
      summary: Configure SharePoint connector
      description: Set up Microsoft credentials for SharePoint connector.
      operationId: setSharePointConfig
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request body for Configure SharePoint connector"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SharePointConfig'
      responses:
        '200':
          description: SharePoint configuration saved
        '400':
          description: Invalid configuration
        '401':
          description: Unauthorized
        '403':
          description: Admin access required
      x-speakeasy-group: connectorOAuthConfigurations
    get:
      tags:
        - Connector OAuth Configuration
      summary: Get SharePoint configuration
      description: "Get SharePoint configuration."
      operationId: getSharePointConfig
      security:
        - bearerAuth: []
      responses:
        '200':
          description: SharePoint configuration retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SharePointConfig'
        '401':
          description: Unauthorized
      x-speakeasy-group: connectorOAuthConfiguration
  # -------------------- Public URLs --------------------
  /configurationManager/frontendPublicUrl:
    post:
      tags:
        - Public URLs
      summary: Set frontend public URL
      description: Configure the public URL where the frontend application is accessible. Used for OAuth redirects and email links.
      operationId: setFrontendPublicUrl
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request body for Set frontend public URL"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/URLConfig'
      responses:
        '200':
          description: Frontend URL saved
        '400':
          description: Invalid URL
        '401':
          description: Unauthorized
        '403':
          description: Admin access required
      x-speakeasy-group: publicUrls
      x-speakeasy-name-override: setFrontendUrl
    get:
      tags:
        - Public URLs
      summary: Get frontend public URL
      description: "Get frontend public URL."
      operationId: getFrontendPublicUrl
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Frontend URL retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/URLConfig'
        '401':
          description: Unauthorized
      x-speakeasy-group: publicUrls
      x-speakeasy-name-override: getFrontend
  /configurationManager/connectorPublicUrl:
    post:
      tags:
        - Public URLs
      summary: Set connector public URL
      description: Configure the public URL for connector OAuth callbacks.
      operationId: setConnectorPublicUrl
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request body for Set connector public URL"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/URLConfig'
      responses:
        '200':
          description: Connector URL saved
        '400':
          description: Invalid URL
        '401':
          description: Unauthorized
        '403':
          description: Admin access required
      x-speakeasy-group: publicUrls
      x-speakeasy-name-override: setConnector
    get:
      tags:
        - Public URLs
      summary: Get connector public URL
      description: "Get connector public URL."
      operationId: getConnectorPublicUrl
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Connector URL retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/URLConfig'
        '401':
          description: Unauthorized
      x-speakeasy-group: publicUrls
      x-speakeasy-name-override: getConnector
  # -------------------- Platform Settings --------------------
  /configurationManager/platform/settings:
    post:
      tags:
        - Platform Settings
      summary: Update platform settings
      description: |
        Configure platform-wide settings including file upload limits and feature flags.

        **File Upload Limits:**
        - Default: 30MB (31457280 bytes)
        - Maximum: 1GB (1073741824 bytes)

        **Available Feature Flags:**
        - ENABLE_BETA_CONNECTORS: Enable beta connector integrations (default: false)
      operationId: setPlatformSettings
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request body for Update platform settings"
        content:
          application/json:
            schema:
              type: object
              required:
                - fileUploadMaxSizeBytes
                - featureFlags
              properties:
                fileUploadMaxSizeBytes:
                  type: integer
                  minimum: 1
                  maximum: 1073741824
                  description: Maximum file upload size in bytes
                  example: 31457280
                featureFlags:
                  type: object
                  additionalProperties:
                    type: boolean
                  description: Key-value map of feature flags. Set to true to enable, false to disable.
                  example:
                    ENABLE_BETA_CONNECTORS: false
            examples:
              default30MB:
                summary: Default settings (30MB limit)
                value:
                  fileUploadMaxSizeBytes: 31457280
                  featureFlags:
                    ENABLE_BETA_CONNECTORS: false
              increased100MB:
                summary: Increased limit (100MB)
                value:
                  fileUploadMaxSizeBytes: 104857600
                  featureFlags:
                    ENABLE_BETA_CONNECTORS: false
              enableBetaFeatures:
                summary: Enable beta connectors
                value:
                  fileUploadMaxSizeBytes: 31457280
                  featureFlags:
                    ENABLE_BETA_CONNECTORS: true
      responses:
        '200':
          description: Platform settings saved successfully
        '400':
          description: Invalid settings
        '401':
          description: Unauthorized
        '403':
          description: Admin access required
      x-speakeasy-group: platformSettings
      x-speakeasy-name-override: update
    get:
      tags:
        - Platform Settings
      summary: Get platform settings
      description: Retrieve current platform settings including file upload limits and feature flag states.
      operationId: getPlatformSettings
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Platform settings retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlatformSettings'
              example:
                fileUploadMaxSizeBytes: 31457280
                featureFlags:
                  ENABLE_BETA_CONNECTORS: false
                updatedAt: "2024-01-15T10:30:00Z"
        '401':
          description: Unauthorized
      x-speakeasy-group: platformSettings
      x-speakeasy-name-override: get
  /configurationManager/platform/feature-flags/available:
    get:
      tags:
        - Platform Settings
      summary: Get available feature flags
      description: List all available feature flags with their descriptions and default values.
      operationId: getAvailableFeatureFlags
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Feature flags retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  featureFlags:
                    type: array
                    items:
                      $ref: '#/components/schemas/FeatureFlag'
        '401':
          description: Unauthorized
      x-speakeasy-group: platformSettings
      x-speakeasy-name-override: getFeatureFlags
  /configurationManager/prompts/system:
    put:
      tags:
        - Platform Settings
      summary: Update custom system prompt
      description: Set a custom system prompt that will be used by AI models.
      operationId: setCustomSystemPrompt
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request body for Update custom system prompt"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CustomSystemPrompt'
      responses:
        '200':
          description: System prompt updated
        '400':
          description: Invalid prompt
        '401':
          description: Unauthorized
        '403':
          description: Admin access required
      x-speakeasy-group: platformSettings
      x-speakeasy-name-override: updateSystemPrompt
    get:
      tags:
        - Platform Settings
      summary: Get custom system prompt
      description: "Get custom system prompt."
      operationId: getCustomSystemPrompt
      security:
        - bearerAuth: []
      responses:
        '200':
          description: System prompt retrieved
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CustomSystemPrompt'
        '401':
          description: Unauthorized
      x-speakeasy-group: platformSettings
  # -------------------- Metrics Collection --------------------
  /configurationManager/metricsCollection:
    get:
      tags:
        - Metrics Collection
      summary: Get metrics collection configuration
      description: |
        Retrieve the current metrics collection configuration including:
        - Whether collection is enabled
        - Push interval settings
        - Server URL configuration
        - Instance identification

        **Admin Access Required:** This endpoint requires administrator privileges.
      operationId: getMetricsCollection
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Metrics configuration retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MetricsCollectionConfig'
              example:
                enableMetricCollection: true
                pushIntervalMs: 60000
                serverUrl: "https://metrics-collector.example.com/collect-metrics"
                apiKey: "54523f794e23d96e"
                instanceId: "638bc1b45c03e03d"
                appVersion: "1.0.0"
        '401':
          description: Unauthorized - Valid authentication required
        '403':
          description: Forbidden - Admin access required
      x-speakeasy-group: metricsCollection
      x-speakeasy-name-override: getConfiguration
  /configurationManager/metricsCollection/toggle:
    put:
      tags:
        - Metrics Collection
      summary: Enable or disable metrics collection
      description: |
        Toggle the master switch for metrics collection.

        **When Enabled:**
        - Application metrics are collected in the background
        - Metrics are pushed to the configured server at regular intervals
        - Activity counters track API usage patterns

        **When Disabled:**
        - No metrics are collected or stored
        - No data is sent to the metrics server
        - Existing scheduled push jobs are stopped

        **Admin Access Required:** This endpoint requires administrator privileges.
      operationId: toggleMetricsCollection
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              required:
                - enableMetricCollection
              properties:
                enableMetricCollection:
                  type: boolean
                  description: Set to true to enable metrics collection, false to disable
                  example: true
            examples:
              enable:
                summary: Enable metrics collection
                value:
                  enableMetricCollection: true
              disable:
                summary: Disable metrics collection
                value:
                  enableMetricCollection: false
      responses:
        '200':
          description: Metrics collection toggled successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Metrics collection toggled successfully"
        '400':
          description: Bad Request - Invalid request body
        '401':
          description: Unauthorized - Valid authentication required
        '403':
          description: Forbidden - Admin access required
      x-speakeasy-group: metricsCollections
      x-speakeasy-name-override: toggle
  /configurationManager/metricsCollection/pushInterval:
    patch:
      tags:
        - Metrics Collection
      summary: Configure metrics push interval
      description: |
        Set how frequently collected metrics are pushed to the remote server.

        **Interval Guidelines:**
        - Minimum: 1000ms (1 second) - for real-time monitoring
        - Recommended: 60000ms (1 minute) - balanced performance
        - Maximum: No hard limit, but longer intervals may delay insights

        **Performance Considerations:**
        - Shorter intervals provide more real-time data but increase network traffic
        - Longer intervals reduce overhead but delay metric visibility
        - Changes take effect on the next push cycle

        **Admin Access Required:** This endpoint requires administrator privileges.
      operationId: setMetricsPushInterval
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              required:
                - pushIntervalMs
              properties:
                pushIntervalMs:
                  type: integer
                  minimum: 1000
                  description: Push interval in milliseconds (minimum 1000ms)
                  example: 60000
            examples:
              default:
                summary: Default interval (1 minute)
                value:
                  pushIntervalMs: 60000
              realtime:
                summary: Near real-time (10 seconds)
                value:
                  pushIntervalMs: 10000
              lowFrequency:
                summary: Low frequency (5 minutes)
                value:
                  pushIntervalMs: 300000
      responses:
        '200':
          description: Push interval updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Metrics collection push interval set successfully"
        '400':
          description: Bad Request - Invalid interval value (must be >= 1000ms)
        '401':
          description: Unauthorized - Valid authentication required
        '403':
          description: Forbidden - Admin access required
      x-speakeasy-group: metricsCollection
      x-speakeasy-name-override: setPushInterval
  /configurationManager/metricsCollection/serverUrl:
    patch:
      tags:
        - Metrics Collection
      summary: Configure metrics server URL
      description: |
        Set the remote server URL where metrics will be pushed.

        **Use Cases:**
        - Self-hosted analytics: Point to your own Prometheus-compatible endpoint
        - Custom monitoring: Integrate with your organization's monitoring stack
        - Development: Use a local endpoint for testing

        **URL Requirements:**
        - Must be a valid URL (http or https)
        - Server must accept POST requests with JSON payload
        - Server should return 2xx status for successful pushes

        **Admin Access Required:** This endpoint requires administrator privileges.
      operationId: setMetricsServerUrl
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              required:
                - serverUrl
              properties:
                serverUrl:
                  type: string
                  format: uri
                  description: Full URL of the metrics collection server
                  example: "https://metrics.mycompany.com/collect"
            examples:
              selfHosted:
                summary: Self-hosted metrics server
                value:
                  serverUrl: "https://metrics.mycompany.com/collect"
              localDev:
                summary: Local development server
                value:
                  serverUrl: "http://localhost:9090/metrics"
      responses:
        '200':
          description: Server URL updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Metrics collection remote server set successfully"
        '400':
          description: Bad Request - Invalid URL format
        '401':
          description: Unauthorized - Valid authentication required
        '403':
          description: Forbidden - Admin access required
      x-speakeasy-group: metricsCollection
      x-speakeasy-name-override: setServerUrl
  # ==================== CRAWLING MANAGER ENDPOINTS ====================
  /crawlingManager/{connector}/{connectorId}/schedule:
    post:
      tags:
        - Crawling Jobs
      summary: Schedule a crawling job
      description: |
        Schedule a new crawling job for a specific connector instance.<br><br>

        <b>Overview:</b><br>
        Creates a scheduled crawling job that will sync data from the specified connector into
        PipesHub's search index. The job is added to a BullMQ queue and will execute according
        to the specified schedule configuration.<br><br>

        <b>Schedule Types:</b><br>
        <ul>
        <li><b>hourly:</b> Run every X hours at specified minute (e.g., every 2 hours at :30)</li>
        <li><b>daily:</b> Run once per day at specified time (e.g., 2:00 AM daily)</li>
        <li><b>weekly:</b> Run on specific days of the week (e.g., Mon/Wed/Fri at 3:00 AM)</li>
        <li><b>monthly:</b> Run on specific day of month (e.g., 1st of each month at 4:00 AM)</li>
        <li><b>custom:</b> Use cron expression for complex schedules</li>
        <li><b>once:</b> Run once at a specific future datetime</li>
        </ul>

        <b>Access Control:</b><br>
        <ul>
        <li>Team-scoped connectors: Requires admin privileges</li>
        <li>Personal-scoped connectors: Only the creator can schedule jobs</li>
        </ul>

        <b>Job Behavior:</b><br>
        <ul>
        <li>If a job already exists for this connector, it will be replaced</li>
        <li>Disabled schedules (<code>isEnabled: false</code>) will throw an error</li>
        <li>Jobs use exponential backoff for retries (5s, 10s, 20s, etc.)</li>
        <li>Only last 10 completed/failed jobs are retained per connector</li>
        </ul>

        <b>Related Endpoints:</b><br>
        <ul>
        <li><code>GET /crawlingManager/{connector}/{connectorId}/schedule</code> - Get job status</li>
        <li><code>POST /crawlingManager/{connector}/{connectorId}/pause</code> - Pause job</li>
        <li><code>DELETE /crawlingManager/{connector}/{connectorId}/remove</code> - Remove job</li>
        </ul>
      operationId: scheduleCrawlingJob
      security:
        - bearerAuth: []
      parameters:
        - name: connector
          in: path
          required: true
          description: Connector type identifier (e.g., "drive", "onedrive", "slack", "jira")
          schema:
            type: string
          example: "drive"
        - name: connectorId
          in: path
          required: true
          description: Unique identifier of the connector instance (MongoDB ObjectId)
          schema:
            type: string
          example: "507f1f77bcf86cd799439011"
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                scheduleConfig:
                  $ref: '#/components/schemas/ScheduleConfig'
                priority:
                  type: integer
                  minimum: 1
                  maximum: 10
                  default: 5
                  description: Job priority (1=highest, 10=lowest). Higher priority jobs are processed first.
                maxRetries:
                  type: integer
                  minimum: 0
                  maximum: 10
                  default: 3
                  description: Maximum number of retry attempts on failure
                timeout:
                  type: integer
                  minimum: 1000
                  maximum: 600000
                  default: 300000
                  description: Job timeout in milliseconds (default 5 minutes)
              required:
                - scheduleConfig
            examples:
              dailySync:
                summary: Daily sync at 2 AM
                description: Schedule daily crawling at 2:00 AM UTC
                value:
                  scheduleConfig:
                    scheduleType: "daily"
                    isEnabled: true
                    timezone: "UTC"
                    hour: 2
                    minute: 0
                  priority: 5
                  maxRetries: 3
              hourlySync:
                summary: Hourly sync every 4 hours
                description: Schedule crawling every 4 hours at minute 30
                value:
                  scheduleConfig:
                    scheduleType: "hourly"
                    isEnabled: true
                    timezone: "America/New_York"
                    minute: 30
                    interval: 4
                  priority: 3
                  maxRetries: 5
              weeklySync:
                summary: Weekly sync on weekdays
                description: Schedule crawling on Monday, Wednesday, Friday at 3 AM
                value:
                  scheduleConfig:
                    scheduleType: "weekly"
                    isEnabled: true
                    timezone: "Europe/London"
                    daysOfWeek: [1, 3, 5]
                    hour: 3
                    minute: 0
                  priority: 5
              customCron:
                summary: Custom cron schedule
                description: Schedule using a custom cron expression
                value:
                  scheduleConfig:
                    scheduleType: "custom"
                    isEnabled: true
                    timezone: "UTC"
                    cronExpression: "0 */6 * * *"
                    description: "Every 6 hours"
                  priority: 5
              oneTimeSync:
                summary: One-time immediate sync
                description: Schedule a one-time crawling job
                value:
                  scheduleConfig:
                    scheduleType: "once"
                    isEnabled: true
                    scheduledTime: "2024-12-25T10:00:00Z"
                  priority: 1
      responses:
        '201':
          description: Crawling job scheduled successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Crawling job scheduled successfully"
                  data:
                    type: object
                    properties:
                      jobId:
                        type: string
                        description: Unique job ID assigned by BullMQ
                        example: "crawl-drive-507f1f77bcf86cd799439011-507f1f77bcf86cd799439012"
                      connector:
                        type: string
                        example: "drive"
                      connectorId:
                        type: string
                        example: "507f1f77bcf86cd799439011"
                      scheduleConfig:
                        $ref: '#/components/schemas/ScheduleConfig'
                      scheduledAt:
                        type: string
                        format: date-time
                        example: "2024-01-15T10:30:00Z"
        '400':
          description: |
            Bad request. Possible reasons:<br>
            <ul>
            <li>Missing or invalid <code>scheduleConfig</code></li>
            <li>Schedule is disabled (<code>isEnabled: false</code>)</li>
            <li>Invalid cron expression for custom schedule</li>
            <li>Scheduled time is in the past for one-time jobs</li>
            <li>Missing connector ID</li>
            </ul>
        '401':
          description: Unauthorized - Valid JWT token required
        '403':
          description: |
            Forbidden. Possible reasons:<br>
            <ul>
            <li>Team-scoped connector requires admin privileges</li>
            <li>Personal-scoped connector can only be managed by creator</li>
            </ul>
        '404':
          description: Connector instance not found
      x-speakeasy-group: crawlingJobs
      x-speakeasy-name-override: schedule
    get:
      tags:
        - Crawling Jobs
      summary: Get crawling job status
      description: |
        Retrieve the current status of a scheduled crawling job for a specific connector.<br><br>

        <b>Overview:</b><br>
        Returns detailed information about the most recent crawling job for the specified connector,
        including its current state, progress, timing information, and any error details.<br><br>

        <b>Job States:</b><br>
        <ul>
        <li><b>waiting:</b> Job is queued and waiting to be processed</li>
        <li><b>active:</b> Job is currently being processed by a worker</li>
        <li><b>completed:</b> Job finished successfully</li>
        <li><b>failed:</b> Job failed after exhausting retry attempts</li>
        <li><b>delayed:</b> Job is scheduled for future execution</li>
        <li><b>paused:</b> Job has been manually paused</li>
        </ul>

        <b>Access Control:</b><br>
        Same as scheduling - team connectors require admin, personal connectors require creator.
      operationId: getCrawlingJobStatus
      security:
        - bearerAuth: []
      parameters:
        - name: connector
          in: path
          required: true
          description: Connector type identifier
          schema:
            type: string
          example: "drive"
        - name: connectorId
          in: path
          required: true
          description: Unique identifier of the connector instance
          schema:
            type: string
          example: "507f1f77bcf86cd799439011"
      responses:
        '200':
          description: Job status retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Job status retrieved successfully"
                  data:
                    $ref: '#/components/schemas/JobStatus'
        '401':
          description: Unauthorized - Valid JWT token required
        '403':
          description: Forbidden - Insufficient permissions for this connector
        '404':
          description: No scheduled job found for this connector
      x-speakeasy-group: crawlingJobs
      x-speakeasy-name-override: getStatus
  /crawlingManager/{connector}/{connectorId}/remove:
    delete:
      tags:
        - Crawling Jobs
      summary: Remove a crawling job
      description: |
        Permanently remove a scheduled crawling job for a specific connector.<br><br>

        <b>Overview:</b><br>
        Removes the crawling job and all associated data from the queue. This includes
        removing repeatable job configurations and cleaning up job history.<br><br>

        <b>What Gets Removed:</b><br>
        <ul>
        <li>Active or waiting job instances</li>
        <li>Repeatable job configuration (for recurring schedules)</li>
        <li>Paused job information</li>
        <li>Job mappings and metadata</li>
        </ul>

        <b>Note:</b> Completed and failed job records may be retained for audit purposes.

        <b>Related Endpoints:</b><br>
        <ul>
        <li><code>DELETE /crawlingManager/schedule/all</code> - Remove all jobs for organization</li>
        </ul>
      operationId: removeCrawlingJob
      security:
        - bearerAuth: []
      parameters:
        - name: connector
          in: path
          required: true
          description: Connector type identifier
          schema:
            type: string
          example: "drive"
        - name: connectorId
          in: path
          required: true
          description: Unique identifier of the connector instance
          schema:
            type: string
          example: "507f1f77bcf86cd799439011"
      responses:
        '200':
          description: Crawling job removed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Crawling job removed successfully"
        '401':
          description: Unauthorized - Valid JWT token required
        '403':
          description: Forbidden - Insufficient permissions for this connector
        '404':
          description: Job not found for this connector
      x-speakeasy-group: crawlingJobs
      x-speakeasy-name-override: remove
  /crawlingManager/{connector}/{connectorId}/pause:
    post:
      tags:
        - Crawling Jobs
      summary: Pause a crawling job
      description: |
        Pause a running or scheduled crawling job without losing its configuration.<br><br>

        <b>Overview:</b><br>
        Pausing a job stores its complete configuration and removes it from the active queue.
        The job can be resumed later with <code>POST /crawlingManager/{connector}/{connectorId}/resume</code>,
        which will restore the exact same schedule configuration.<br><br>

        <b>How Pausing Works:</b><br>
        <ol>
        <li>Current job configuration is stored in memory</li>
        <li>Active/repeatable job is removed from BullMQ queue</li>
        <li>Job state changes to "paused"</li>
        <li>No new job executions will occur until resumed</li>
        </ol>

        <b>Use Cases:</b><br>
        <ul>
        <li>Temporarily stop crawling during maintenance</li>
        <li>Pause data sync while investigating issues</li>
        <li>Stop crawling for a connector being reconfigured</li>
        </ul>

        <b>Note:</b> If a job is currently active (processing), it will complete before pausing.
      operationId: pauseCrawlingJob
      security:
        - bearerAuth: []
      parameters:
        - name: connector
          in: path
          required: true
          description: Connector type identifier
          schema:
            type: string
          example: "drive"
        - name: connectorId
          in: path
          required: true
          description: Unique identifier of the connector instance
          schema:
            type: string
          example: "507f1f77bcf86cd799439011"
      responses:
        '200':
          description: Crawling job paused successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Crawling job paused successfully"
                  data:
                    type: object
                    properties:
                      connector:
                        type: string
                        example: "drive"
                      orgId:
                        type: string
                        example: "507f1f77bcf86cd799439012"
                      pausedAt:
                        type: string
                        format: date-time
                        example: "2024-01-15T10:30:00Z"
        '400':
          description: |
            Bad request. Possible reasons:<br>
            <ul>
            <li>No active job found to pause</li>
            <li>Job is already paused</li>
            </ul>
        '401':
          description: Unauthorized - Valid JWT token required
        '403':
          description: Forbidden - Insufficient permissions for this connector
        '404':
          description: Job not found for this connector
      x-speakeasy-group: crawlingJobs
      x-speakeasy-name-override: pause
  /crawlingManager/{connector}/{connectorId}/resume:
    post:
      tags:
        - Crawling Jobs
      summary: Resume a paused crawling job
      description: |
        Resume a previously paused crawling job using its stored configuration.<br><br>

        <b>Overview:</b><br>
        Restores a paused job to active state using the exact configuration it had when paused.
        A new job is created in BullMQ with the same schedule settings.<br><br>

        <b>How Resuming Works:</b><br>
        <ol>
        <li>Retrieve stored job configuration from pause state</li>
        <li>Create new scheduled job with same configuration</li>
        <li>Remove from paused jobs tracking</li>
        <li>Job will execute according to its original schedule</li>
        </ol>

        <b>Note:</b> The job will resume according to its schedule, not immediately execute
        (unless it's a one-time job that hasn't run yet).
      operationId: resumeCrawlingJob
      security:
        - bearerAuth: []
      parameters:
        - name: connector
          in: path
          required: true
          description: Connector type identifier
          schema:
            type: string
          example: "drive"
        - name: connectorId
          in: path
          required: true
          description: Unique identifier of the connector instance
          schema:
            type: string
          example: "507f1f77bcf86cd799439011"
      responses:
        '200':
          description: Crawling job resumed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Crawling job resumed successfully"
                  data:
                    type: object
                    properties:
                      connector:
                        type: string
                        example: "drive"
                      orgId:
                        type: string
                        example: "507f1f77bcf86cd799439012"
                      resumedAt:
                        type: string
                        format: date-time
                        example: "2024-01-15T11:00:00Z"
        '400':
          description: No paused job found to resume
        '401':
          description: Unauthorized - Valid JWT token required
        '403':
          description: Forbidden - Insufficient permissions for this connector
        '404':
          description: No paused job found for this connector
      x-speakeasy-group: crawlingJobs
      x-speakeasy-name-override: resume
  /crawlingManager/schedule/all:
    get:
      tags:
        - Crawling Jobs
      summary: Get all crawling job statuses
      description: |
        Retrieve the status of all scheduled crawling jobs for the current organization.<br><br>

        <b>Overview:</b><br>
        Returns a list of all crawling jobs across all connectors for the authenticated user's
        organization. This includes active, waiting, paused, completed, and failed jobs.<br><br>

        <b>Response Details:</b><br>
        <ul>
        <li>Jobs are grouped by connector type</li>
        <li>Last 10 jobs per connector type are returned</li>
        <li>Includes both active queue jobs and paused jobs</li>
        </ul>

        <b>Use Cases:</b><br>
        <ul>
        <li>Dashboard overview of all crawling activities</li>
        <li>Monitoring job health across connectors</li>
        <li>Identifying failed or stuck jobs</li>
        </ul>
      operationId: getAllCrawlingJobStatus
      security:
        - bearerAuth: []
      responses:
        '200':
          description: All job statuses retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "All job statuses retrieved successfully"
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/JobStatus'
        '401':
          description: Unauthorized - Valid JWT token required
      x-speakeasy-group: crawlingJobs
      x-speakeasy-name-override: list
    delete:
      tags:
        - Crawling Jobs
      summary: Remove all crawling jobs
      description: |
        Remove all scheduled crawling jobs for the current organization.<br><br>

        <b>Overview:</b><br>
        Bulk operation to remove all crawling jobs across all connectors for the organization.
        This is useful when decommissioning an organization or doing a complete reset.<br><br>

        <b>What Gets Removed:</b><br>
        <ul>
        <li>All active and waiting jobs</li>
        <li>All repeatable job configurations</li>
        <li>All paused jobs</li>
        <li>All job mappings for the organization</li>
        </ul>

        <b>Warning:</b> This operation cannot be undone. All job configurations will need
        to be recreated manually.
      operationId: removeAllCrawlingJobs
      security:
        - bearerAuth: []
      responses:
        '200':
          description: All crawling jobs removed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "All crawling jobs removed successfully"
        '401':
          description: Unauthorized - Valid JWT token required
      x-speakeasy-group: crawlingJobs
      x-speakeasy-name-override: removeAll
  /crawlingManager/stats:
    get:
      tags:
        - Queue Management
      summary: Get queue statistics
      description: |
        Retrieve aggregate statistics about the crawling job queue.<br><br>

        <b>Overview:</b><br>
        Returns real-time statistics about the BullMQ queue including job counts by state,
        paused jobs, and repeatable job configurations. Useful for monitoring system health
        and capacity planning.<br><br>

        <b>Statistics Included:</b><br>
        <ul>
        <li><b>waiting:</b> Jobs queued and waiting to be processed</li>
        <li><b>active:</b> Jobs currently being processed by workers</li>
        <li><b>completed:</b> Successfully completed jobs (limited retention)</li>
        <li><b>failed:</b> Failed jobs (limited retention)</li>
        <li><b>delayed:</b> Jobs scheduled for future execution</li>
        <li><b>paused:</b> Manually paused jobs</li>
        <li><b>repeatable:</b> Number of repeatable job configurations</li>
        <li><b>total:</b> Sum of all job counts</li>
        </ul>

        <b>Use Cases:</b><br>
        <ul>
        <li>Monitor queue health and throughput</li>
        <li>Identify processing bottlenecks</li>
        <li>Track failed job counts for alerting</li>
        <li>Capacity planning based on queue depth</li>
        </ul>
      operationId: getQueueStats
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Queue statistics retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Queue statistics retrieved successfully"
                  data:
                    $ref: '#/components/schemas/QueueStats'
              example:
                success: true
                message: "Queue statistics retrieved successfully"
                data:
                  waiting: 5
                  active: 2
                  completed: 150
                  failed: 3
                  delayed: 10
                  paused: 1
                  repeatable: 8
                  total: 171
        '401':
          description: Unauthorized - Valid JWT token required
      x-speakeasy-group: queueManagement
      x-speakeasy-name-override: getStats
  # ==================== MAIL SERVICE ENDPOINTS ====================
  /mail/emails/sendEmail:
    post:
      tags:
        - Email Operations
      summary: Send a transactional email
      description: |
        Send a transactional email using the configured SMTP server with a pre-defined template.<br><br>

        <b>Overview:</b><br>
        This is an internal service endpoint used by other PipesHub services to send transactional emails.
        It uses Handlebars templates to generate HTML emails with dynamic content. All sent emails are
        logged to the database for audit purposes.<br><br>

        <b>Authentication:</b><br>
        Requires a scoped token with <code>mail:send</code> scope. This endpoint is not accessible
        with regular user JWT tokens - it is designed for service-to-service communication only.<br><br>

        <b>Available Templates:</b><br>
        <ul>
        <li><b>loginWithOTP</b> - Send OTP code for user authentication. Requires: <code>name</code>, <code>otp</code></li>
        <li><b>resetPassword</b> - Password reset link. Requires: <code>name</code>, <code>link</code></li>
        <li><b>accountCreation</b> - Welcome email for new organizations. Requires: <code>orgName</code>, <code>link</code></li>
        <li><b>appuserInvite</b> - Invitation to join organization. Requires: <code>invitee</code>, <code>orgName</code>, <code>link</code></li>
        <li><b>suspiciousLoginAttempt</b> - Security alert. Requires: <code>link</code></li>
        </ul>

        <b>Email Delivery Flow:</b><br>
        <ol>
        <li>Validate SMTP configuration exists (middleware check)</li>
        <li>Validate scoped token has <code>mail:send</code> scope</li>
        <li>Select and compile Handlebars template with provided data</li>
        <li>Send email via nodemailer using SMTP configuration</li>
        <li>Log email metadata to MongoDB (subject, from, to, cc, templateType)</li>
        </ol>

        <b>Important Notes:</b><br>
        <ul>
        <li>The "From" address is always taken from SMTP config, not the request body</li>
        <li>Failed email sends return 500 with error details</li>
        <li>Template mismatches throw "Unknown Template" error</li>
        <li>SMTP must be configured before using this endpoint</li>
        </ul>

        <b>Related Endpoints:</b><br>
        <ul>
        <li><code>POST /configurationManager/smtpConfig</code> - Configure SMTP server</li>
        <li><code>POST /mail/updateSmtpConfig</code> - Reload SMTP configuration at runtime</li>
        </ul>
      operationId: sendEmail
      security:
        - scopedToken: []
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MailBody'
            examples:
              loginOTP:
                summary: Send OTP for login
                description: Send a 6-digit OTP code to user for authentication
                value:
                  emailTemplateType: "loginWithOTP"
                  sendEmailTo: ["user@example.com"]
                  subject: "Your OTP Code for PipesHub"
                  templateData:
                    name: "John Doe"
                    otp: "123456"
                  isAutoEmail: true
              passwordReset:
                summary: Send password reset link
                description: Send password reset email with secure link
                value:
                  emailTemplateType: "resetPassword"
                  sendEmailTo: ["user@example.com"]
                  subject: "Reset Your PipesHub Password"
                  templateData:
                    name: "John Doe"
                    link: "https://app.pipeshub.com/reset-password?token=abc123xyz"
              userInvitation:
                summary: Invite user to organization
                description: Send invitation email to join an organization
                value:
                  emailTemplateType: "appuserInvite"
                  sendEmailTo: ["newuser@example.com"]
                  subject: "You've been invited to join Acme Corp on PipesHub"
                  templateData:
                    invitee: "Admin User"
                    orgName: "Acme Corp"
                    link: "https://app.pipeshub.com/invite?token=invite123"
              accountCreation:
                summary: Welcome new organization
                description: Send welcome email after organization account creation
                value:
                  emailTemplateType: "accountCreation"
                  sendEmailTo: ["admin@neworg.com"]
                  subject: "Welcome to PipesHub!"
                  templateData:
                    orgName: "New Organization Inc"
                    link: "https://app.pipeshub.com/login"
              securityAlert:
                summary: Suspicious login alert
                description: Alert user about suspicious login activity
                value:
                  emailTemplateType: "suspiciousLoginAttempt"
                  sendEmailTo: ["user@example.com"]
                  subject: "Security Alert: Suspicious Login Attempt"
                  templateData:
                    link: "https://app.pipeshub.com/support"
      responses:
        '200':
          description: Email sent successfully and logged to database
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    properties:
                      status:
                        type: boolean
                        description: Whether the email was sent successfully
                        example: true
                      data:
                        type: string
                        description: Success message
                        example: "Email sent"
              example:
                data:
                  status: true
                  data: "Email sent"
        '400':
          description: |
            Bad request. Possible reasons:<br>
            <ul>
            <li>SMTP not configured properly (missing host, port, or fromEmail)</li>
            <li>Invalid or unknown email template type</li>
            <li>Missing required templateData fields for the selected template</li>
            <li>Invalid email format in sendEmailTo or sendCcTo</li>
            </ul>
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Smtp not configured properly"
        '401':
          description: |
            Unauthorized. Possible reasons:<br>
            <ul>
            <li>Missing scoped token in Authorization header</li>
            <li>Invalid or expired scoped token</li>
            <li>Token does not have <code>mail:send</code> scope</li>
            </ul>
        '404':
          description: SMTP configuration not found in application config
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Smtp Configuration not set"
        '500':
          description: |
            Internal server error. Email sending failed due to:<br>
            <ul>
            <li>SMTP server connection failure</li>
            <li>Authentication failure with SMTP server</li>
            <li>Template compilation error</li>
            <li>Network issues</li>
            </ul>
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Failed to send email"
      x-speakeasy-group: emailOperations
      x-speakeasy-name-override: send
  /mail/updateSmtpConfig:
    post:
      tags:
        - Mail Configuration
      summary: Reload SMTP configuration
      description: |
        Dynamically reload the SMTP configuration from the application config file without restarting the service.<br><br>

        <b>Overview:</b><br>
        This internal endpoint allows the mail service to pick up SMTP configuration changes at runtime.
        When SMTP settings are updated via <code>/configurationManager/smtpConfig</code>, this endpoint
        should be called to apply the changes to the running mail service.<br><br>

        <b>Authentication:</b><br>
        Requires a scoped token with <code>fetch:config</code> scope. This endpoint is designed for
        internal service communication only.<br><br>

        <b>How It Works:</b><br>
        <ol>
        <li>Reads the latest configuration from the config file/etcd</li>
        <li>Rebinds the AppConfig in the dependency injection container</li>
        <li>Creates a new MailController instance with updated config</li>
        <li>Returns the new SMTP configuration (excluding password)</li>
        </ol>

        <b>Use Cases:</b><br>
        <ul>
        <li>Apply SMTP configuration changes without service restart</li>
        <li>Switch SMTP providers at runtime</li>
        <li>Update SMTP credentials</li>
        <li>Change sender email address</li>
        </ul>

        <b>Related Endpoints:</b><br>
        <ul>
        <li><code>POST /configurationManager/smtpConfig</code> - Create/update SMTP configuration</li>
        <li><code>GET /configurationManager/smtpConfig</code> - Get current SMTP configuration</li>
        </ul>
      operationId: updateSmtpConfig
      security:
        - scopedToken: []
      responses:
        '200':
          description: SMTP configuration reloaded successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    description: Success message
                    example: "SMTP configuration updated successfully"
                  smtp:
                    $ref: '#/components/schemas/SMTPConfig'
              example:
                message: "SMTP configuration updated successfully"
                smtp:
                  host: "smtp.gmail.com"
                  port: 587
                  username: "notifications@company.com"
                  fromEmail: "noreply@company.com"
        '401':
          description: |
            Unauthorized. Possible reasons:<br>
            <ul>
            <li>Missing scoped token in Authorization header</li>
            <li>Invalid or expired scoped token</li>
            <li>Token does not have <code>fetch:config</code> scope</li>
            </ul>
        '500':
          description: |
            Internal server error. Configuration reload failed due to:<br>
            <ul>
            <li>Config file read error</li>
            <li>etcd connection failure</li>
            <li>Invalid configuration format</li>
            </ul>
      x-speakeasy-group: mailConfiguration
      x-speakeasy-name-override: updateSmtp
  # ==================== INTERNAL PYTHON MICROSERVICE ENDPOINTS ====================
  #
  # ⚠️ IMPORTANT: These endpoints are INTERNAL to PipesHub services.
  #
  # These endpoints are served by independent Python FastAPI microservices that run
  # on different ports. They communicate with the main Node.js API via HTTP and Kafka.
  #
  # AUTHENTICATION REQUIREMENTS:
  # - Internal service calls: Require SCOPED SERVICE TOKEN (not available externally)
  # - User-facing endpoints: Accept user JWT token (proxied through main Node.js API)
  # - Webhook endpoints: No auth (verified by provider signatures like Google, Microsoft)
  #
  # For external API access, use the main Node.js API endpoints (/api/v1/...) instead.
  #
  # ==============================================================================

  # -------------------- QUERY SERVICE (Port 8000) --------------------
  # Base URL: http://localhost:8000
  # Authentication: User JWT or Scoped Token (depending on endpoint)
  /query/health:
    get:
      tags:
        - Query Service
      summary: "[Query Service] Health check"
      description: |
        ⚠️ <b>INTERNAL SERVICE ENDPOINT</b><br><br>

        Health check endpoint for the Query Service (Python FastAPI).<br><br>

        <b>Service:</b> Query Service<br>
        <b>Port:</b> 8000<br>
        <b>Base URL:</b> <code>http://localhost:8000</code><br><br>

        <b>Authentication:</b> None required for health check<br><br>

        <b>Note:</b> This is an internal service health endpoint. It also verifies
        connectivity to the Connector Service as a dependency check.
      operationId: queryServiceHealth
      security: []
      servers:
        - url: http://localhost:8000
          description: Query Service (Internal)
      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    enum: [healthy]
                  timestamp:
                    type: integer
                    description: Unix timestamp in milliseconds
              example:
                status: "healthy"
                timestamp: 1703520000000
        '500':
          description: Service is unhealthy or dependency check failed
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    enum: [fail]
                  error:
                    type: string
                  timestamp:
                    type: integer
      x-speakeasy-group: queryServices
      x-speakeasy-name-override: getHealth
  /query/api/v1/search:
    post:
      tags:
        - Query Service
      summary: "[Query Service] Semantic search"
      description: |
        ⚠️ <b>INTERNAL SERVICE ENDPOINT</b><br><br>

        Perform semantic search across indexed documents using vector embeddings.<br><br>

        <b>Service:</b> Query Service<br>
        <b>Port:</b> 8000<br>
        <b>Base URL:</b> <code>http://localhost:8000</code><br><br>

        <b>Authentication:</b> Requires user JWT token (proxied from main API) or scoped service token<br><br>

        <b>How It Works:</b><br>
        <ol>
        <li>Query is transformed and expanded using LLM</li>
        <li>Embeddings are generated for search queries</li>
        <li>Vector similarity search in Qdrant</li>
        <li>Results filtered by user permissions</li>
        <li>Optional knowledge base filtering</li>
        </ol>
      operationId: queryServiceSearch
      servers:
        - url: http://localhost:8000
          description: Query Service (Internal)
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                query:
                  type: string
                  description: Search query text
                  example: "How do I configure SSO?"
                limit:
                  type: integer
                  default: 5
                  description: Maximum number of results
                filters:
                  type: object
                  description: Optional filters (e.g., kb IDs)
                  properties:
                    kb:
                      type: array
                      items:
                        type: string
                      description: Knowledge base IDs to filter
              required:
                - query
      responses:
        '200':
          description: Search results retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  searchResults:
                    type: array
                    items:
                      type: object
                  status_code:
                    type: integer
        '401':
          description: Unauthorized
        '403':
          description: Access denied to specified knowledge bases
        '500':
          description: Search failed
      x-speakeasy-group: queryService
      x-speakeasy-name-override: search
  /query/api/v1/chat:
    post:
      tags:
        - Query Service
      summary: "[Query Service] Chat with knowledge base"
      description: |
        ⚠️ <b>INTERNAL SERVICE ENDPOINT</b><br><br>

        Conversational AI endpoint with RAG (Retrieval-Augmented Generation).<br><br>

        <b>Service:</b> Query Service<br>
        <b>Port:</b> 8000<br>
        <b>Base URL:</b> <code>http://localhost:8000</code><br><br>

        <b>Authentication:</b> Requires user JWT token (proxied from main API) or scoped service token<br><br>

        <b>Features:</b><br>
        <ul>
        <li>Multi-turn conversation support</li>
        <li>Context from knowledge base</li>
        <li>Citation of source documents</li>
        <li>Multiple chat modes (quick, analysis, deep_research, creative, precise)</li>
        <li>Multi-model support (OpenAI, Anthropic, Ollama, etc.)</li>
        </ul>
      operationId: queryServiceChat
      servers:
        - url: http://localhost:8000
          description: Query Service (Internal)
      security:
        - bearerAuth: []
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                query:
                  type: string
                  description: User's question
                limit:
                  type: integer
                  default: 50
                previousConversations:
                  type: array
                  items:
                    type: object
                    properties:
                      role:
                        type: string
                        enum: [user_query, bot_response]
                      content:
                        type: string
                filters:
                  type: object
                retrievalMode:
                  type: string
                  enum: [HYBRID, VECTOR, KEYWORD]
                  default: HYBRID
                quickMode:
                  type: boolean
                  default: false
                modelKey:
                  type: string
                  description: UUID of the model configuration
                modelName:
                  type: string
                  description: Model name (e.g., gpt-4o-mini, claude-3-5-sonnet)
                chatMode:
                  type: string
                  enum: [quick, analysis, deep_research, creative, precise, standard]
                  default: standard
              required:
                - query
      responses:
        '200':
          description: Chat response with citations
        '401':
          description: Unauthorized
        '500':
          description: Chat failed
      x-speakeasy-group: queryService
      x-speakeasy-name-override: chat
  /query/api/v1/chat/stream:
    post:
      tags:
        - Query Service
      summary: "[Query Service] Streaming chat with knowledge base"
      description: |
        ⚠️ <b>INTERNAL SERVICE ENDPOINT</b><br><br>

        Streaming conversational AI endpoint with real-time token delivery.<br><br>

        <b>Service:</b> Query Service<br>
        <b>Port:</b> 8000<br>
        <b>Base URL:</b> <code>http://localhost:8000</code><br><br>

        <b>Authentication:</b> Requires user JWT token (proxied from main API) or scoped service token<br><br>

        <b>SSE Events:</b><br>
        <ul>
        <li><code>status</code>: Processing status updates</li>
        <li><code>chunk</code>: Token/text chunks</li>
        <li><code>citations</code>: Source citations</li>
        <li><code>done</code>: Stream complete</li>
        <li><code>error</code>: Error occurred</li>
        </ul>
      operationId: queryServiceChatStream
      servers:
        - url: http://localhost:8000
          description: Query Service (Internal)
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Server-Sent Events stream
          content:
            text/event-stream:
              schema:
                type: string
        '401':
          description: Unauthorized
      x-speakeasy-group: queryService
      x-speakeasy-name-override: chatStream
  /query/api/v1/health-check/{model_type}:
    post:
      tags:
        - Query Service
      summary: "[Query Service] AI model health check"
      description: |
        ⚠️ <b>INTERNAL SERVICE ENDPOINT</b><br><br>

        Validate LLM or embedding model configuration.<br><br>

        <b>Service:</b> Query Service<br>
        <b>Port:</b> 8000<br>
        <b>Base URL:</b> <code>http://localhost:8000</code><br><br>

        <b>Authentication:</b> Requires scoped service token<br><br>

        <b>Model Types:</b>
        <ul>
        <li><code>llm</code> - Test LLM configuration (text generation)</li>
        <li><code>embedding</code> - Test embedding model configuration</li>
        </ul>
      operationId: queryServiceHealthCheck
      servers:
        - url: http://localhost:8000
          description: Query Service (Internal)
      security:
        - scopedToken: []
      parameters:
        - name: model_type
          in: path
          required: true
          schema:
            type: string
            enum: [llm, embedding]
          description: Type of model to health check
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                provider:
                  type: string
                  description: Model provider (openai, anthropic, ollama, etc.)
                configuration:
                  type: object
                  properties:
                    model:
                      type: string
                      description: Model name(s), comma-separated
                    apiKey:
                      type: string
                isMultimodal:
                  type: boolean
                  description: Whether model supports vision/images
              required:
                - provider
                - configuration
      responses:
        '200':
          description: Model is healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    enum: [healthy]
                  message:
                    type: string
                  timestamp:
                    type: integer
        '500':
          description: Model health check failed
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    enum: [error, not healthy]
                  message:
                    type: string
                  details:
                    type: object
      x-speakeasy-group: queryService
      x-speakeasy-name-override: healthCheck
  /query/api/v1/tools:
    get:
      tags:
        - Query Service
      summary: "[Query Service] List available agent tools"
      description: |
        Retrieve all available tools that can be used by AI agents.<br><br>

        <b>Service:</b> Query Service<br>
        <b>Port:</b> 8000<br>
        <b>Base URL:</b> <code>http://localhost:8000</code><br><br>

        <b>Overview:</b><br>
        Returns a list of tools registered in the system, including their parameters,
        descriptions, and tags. Tools are loaded from ArangoDB.<br><br>

        <b>Use Cases:</b><br>
        <ul>
        <li>Agent configuration UI - show available tools to assign to agents</li>
        <li>Tool discovery for building custom agent workflows</li>
        </ul>
      operationId: queryListTools
      servers:
        - url: http://localhost:8000
          description: Query Service
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Tools retrieved successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    name:
                      type: string
                      description: Tool name identifier
                    description:
                      type: string
                      description: Human-readable tool description
                    parameters:
                      type: object
                      description: Tool parameter definitions
                    tags:
                      type: array
                      items:
                        type: string
                      description: Tool categorization tags
        '401':
          description: Unauthorized
        '500':
          description: Failed to retrieve tools from database
      x-speakeasy-group: queryService
      x-speakeasy-name-override: listTools
  # -------------------- INDEXING SERVICE (Port 8091) --------------------
  # Base URL: http://localhost:8091
  # Authentication: Internal only (Kafka consumer)
  /indexing/health:
    get:
      tags:
        - Indexing Service
      summary: "[Indexing Service] Health check"
      description: |
        ⚠️ <b>INTERNAL SERVICE ENDPOINT</b><br><br>

        Health check endpoint for the Indexing Service (Python FastAPI).<br><br>

        <b>Service:</b> Indexing Service<br>
        <b>Port:</b> 8091<br>
        <b>Base URL:</b> <code>http://localhost:8091</code><br><br>

        <b>Authentication:</b> None required for health check<br><br>

        <b>Note:</b> This is an internal service. It processes Kafka messages
        for document indexing and does not expose user-facing endpoints.
        Health check also verifies Connector Service connectivity.
      operationId: indexingServiceHealth
      security: []
      servers:
        - url: http://localhost:8091
          description: Indexing Service (Internal)
      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    enum: [healthy]
                  timestamp:
                    type: integer
              example:
                status: "healthy"
                timestamp: 1703520000000
        '500':
          description: Service is unhealthy
      x-speakeasy-group: indexingService
      x-speakeasy-name-override: health
  # -------------------- CONNECTOR SERVICE (Port 8088) --------------------
  # Base URL: http://localhost:8088
  # Authentication: Scoped Token or User JWT (depending on endpoint)
  /connector/health:
    get:
      tags:
        - Connector Service
      summary: "[Connector Service] Health check"
      description: |
        ⚠️ <b>INTERNAL SERVICE ENDPOINT</b><br><br>

        Health check endpoint for the Connector Service (Python FastAPI).<br><br>

        <b>Service:</b> Connector Service<br>
        <b>Port:</b> 8088<br>
        <b>Base URL:</b> <code>http://localhost:8088</code><br><br>

        <b>Authentication:</b> None required for health check<br><br>

        <b>Note:</b> This is the core internal service that manages all
        data source connectors and OAuth flows.
      operationId: connectorServiceHealth
      security: []
      servers:
        - url: http://localhost:8088
          description: Connector Service (Internal)
      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    enum: [healthy]
                  timestamp:
                    type: integer
              example:
                status: "healthy"
                timestamp: 1703520000000
        '500':
          description: Service is unhealthy
      x-speakeasy-group: connectorService
      x-speakeasy-name-override: checkHealth
  /connector/drive/webhook:
    post:
      tags:
        - Connector Service
      summary: "[Connector Service] Google Drive webhook"
      description: |
        ⚠️ <b>INTERNAL SERVICE ENDPOINT</b><br><br>

        Webhook endpoint for Google Drive push notifications.<br><br>

        <b>Service:</b> Connector Service<br>
        <b>Port:</b> 8088<br>
        <b>Base URL:</b> <code>http://localhost:8088</code><br><br>

        <b>Authentication:</b> None required - uses Google's push notification verification<br><br>

        <b>Note:</b> This endpoint receives real-time change notifications from
        Google Drive when files are created, modified, or deleted.
      operationId: driveWebhook
      security: []
      servers:
        - url: http://localhost:8088
          description: Connector Service (Internal)
      responses:
        '200':
          description: Webhook processed
        '400':
          description: Invalid webhook payload
      x-speakeasy-group: connectorService
      x-speakeasy-name-override: postDrive
  /connector/gmail/webhook:
    get:
      tags:
        - Webhooks
      summary: "[Connector Service] Gmail webhook verification"
      description: |
        ⚠️ <b>INTERNAL SERVICE ENDPOINT</b><br><br>

        GET handler for Gmail Pub/Sub webhook verification.<br><br>

        <b>Service:</b> Connector Service<br>
        <b>Port:</b> 8088<br>
        <b>Base URL:</b> <code>http://localhost:8088</code><br><br>

        <b>Authentication:</b> None required - uses Google Pub/Sub verification<br><br>

        <b>Note:</b> Google Pub/Sub may send GET requests for subscription verification.
      operationId: gmailWebhookVerify
      security: []
      servers:
        - url: http://localhost:8088
          description: Connector Service (Internal)
      responses:
        '200':
          description: Verification acknowledged
      x-speakeasy-name-override: verifyGmail
    post:
      tags:
        - Webhooks
      summary: "[Connector Service] Gmail webhook"
      description: |
        ⚠️ <b>INTERNAL SERVICE ENDPOINT</b><br><br>

        Webhook endpoint for Gmail Pub/Sub notifications.<br><br>

        <b>Service:</b> Connector Service<br>
        <b>Port:</b> 8088<br>
        <b>Base URL:</b> <code>http://localhost:8088</code><br><br>

        <b>Authentication:</b> None required - uses Google Pub/Sub verification<br><br>

        <b>Note:</b> This endpoint receives notifications when new emails arrive
        or email labels change.
      operationId: gmailWebhook
      security: []
      servers:
        - url: http://localhost:8088
          description: Connector Service (Internal)
      responses:
        '200':
          description: Webhook processed
      x-speakeasy-name-override: postGmail
  /connector/admin/webhook:
    post:
      tags:
        - Webhooks
      summary: "[Connector Service] Google Workspace Admin webhook"
      description: |
        ⚠️ <b>INTERNAL SERVICE ENDPOINT</b><br><br>

        Webhook endpoint for Google Workspace Admin push notifications.<br><br>

        <b>Service:</b> Connector Service<br>
        <b>Port:</b> 8088<br>
        <b>Base URL:</b> <code>http://localhost:8088</code><br><br>

        <b>Authentication:</b> Verified via Google Workspace webhook signature<br><br>

        <b>Note:</b> This endpoint receives notifications about user and group
        changes from Google Workspace Admin directory (e.g., user created,
        deleted, suspended, group membership changes).
      operationId: adminWebhook
      security: []
      servers:
        - url: http://localhost:8088
          description: Connector Service (Internal)
      responses:
        '200':
          description: Webhook processed
        '401':
          description: Unauthorized webhook request
      x-speakeasy-name-override: handle
  /connector/api/v1/internal/stream/record/{record_id}:
    get:
      tags:
        - Connector Service
      summary: "[Connector Service] Internal stream record"
      description: |
        ⚠️ <b>INTERNAL SERVICE ENDPOINT</b><br><br>

        Internal endpoint for streaming record content (service-to-service).<br><br>

        <b>Service:</b> Connector Service<br>
        <b>Port:</b> 8088<br>
        <b>Base URL:</b> <code>http://localhost:8088</code><br><br>

        <b>Authentication:</b> Requires scoped service token<br><br>

        <b>Use Case:</b> Used by Indexing Service to fetch file content for processing.
      operationId: connectorInternalStreamRecord
      servers:
        - url: http://localhost:8088
          description: Connector Service (Internal)
      security:
        - scopedToken: []
      parameters:
        - name: record_id
          in: path
          required: true
          schema:
            type: string
          description: Record ID to stream
      responses:
        '200':
          description: File content stream
          content:
            application/octet-stream:
              schema:
                type: string
                format: binary
        '404':
          description: Record not found
      x-speakeasy-group: connectorService
      x-speakeasy-name-override: internalStreamRecord
  /connector/api/v1/record/buffer/convert:
    post:
      tags:
        - Connector Service
      summary: "[Connector Service] Convert record buffer"
      description: |
        ⚠️ <b>INTERNAL SERVICE ENDPOINT</b><br><br>

        Convert a record buffer to a different format.<br><br>

        <b>Service:</b> Connector Service<br>
        <b>Port:</b> 8088<br>
        <b>Base URL:</b> <code>http://localhost:8088</code><br><br>

        <b>Authentication:</b> Requires scoped service token<br><br>

        <b>Supported Conversions:</b> PDF to text, DOCX to text, etc.
      operationId: connectorConvertRecordBuffer
      servers:
        - url: http://localhost:8088
          description: Connector Service (Internal)
      security:
        - scopedToken: []
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                buffer:
                  type: string
                  format: byte
                  description: Base64 encoded file content
                convertTo:
                  type: string
                  description: Target format (e.g., 'text', 'markdown')
                mimeType:
                  type: string
                  description: Original MIME type of the file
              required:
                - buffer
                - convertTo
      responses:
        '200':
          description: Conversion successful
          content:
            application/octet-stream:
              schema:
                type: string
                format: binary
        '400':
          description: Invalid request or unsupported conversion
      x-speakeasy-group: connectorService
      x-speakeasy-name-override: convertRecordBuffer
  /connector/api/v1/stats:
    get:
      tags:
        - Connector Service
      summary: "[Connector Service] Get connector statistics"
      description: |
        ⚠️ <b>INTERNAL SERVICE ENDPOINT</b><br><br>

        Get statistics for a specific connector.<br><br>

        <b>Service:</b> Connector Service<br>
        <b>Port:</b> 8088<br>
        <b>Base URL:</b> <code>http://localhost:8088</code><br><br>

        <b>Authentication:</b> Requires scoped service token
      operationId: connectorGetStats
      servers:
        - url: http://localhost:8088
          description: Connector Service (Internal)
      security:
        - scopedToken: []
      parameters:
        - name: org_id
          in: query
          required: true
          schema:
            type: string
          description: Organization ID
        - name: connector
          in: query
          required: true
          schema:
            type: string
          description: Connector name (e.g., GOOGLE_DRIVE, ONEDRIVE)
      responses:
        '200':
          description: Connector statistics
          content:
            application/json:
              schema:
                type: object
                properties:
                  totalRecords:
                    type: integer
                    description: Total number of records
                  indexedRecords:
                    type: integer
                    description: Number of successfully indexed records
                  failedRecords:
                    type: integer
                    description: Number of failed records
                  pendingRecords:
                    type: integer
                    description: Number of pending records
                  lastSyncTimestamp:
                    type: integer
                    format: int64
                    description: Last sync timestamp
      x-speakeasy-group: connectorService
      x-speakeasy-name-override: getStats
  /connector/api/v1/records/reindex-failed:
    post:
      tags:
        - Connector Service
      summary: "[Connector Service] Reindex all failed records"
      description: |
        ⚠️ <b>INTERNAL SERVICE ENDPOINT</b><br><br>

        Trigger reindexing of all failed records for a specific connector.<br><br>

        <b>Service:</b> Connector Service<br>
        <b>Port:</b> 8088<br>
        <b>Base URL:</b> <code>http://localhost:8088</code><br><br>

        <b>Authentication:</b> Requires scoped service token
      operationId: connectorReindexFailedRecords
      servers:
        - url: http://localhost:8088
          description: Connector Service (Internal)
      security:
        - scopedToken: []
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                connector:
                  type: string
                  description: Connector name to reindex failed records for
      responses:
        '200':
          description: Reindexing triggered
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  count:
                    type: integer
                    description: Number of records queued for reindexing
      x-speakeasy-group: connectorServices
      x-speakeasy-name-override: reindexFailedRecords
  /connector/api/v1/{org_id}/{user_id}/{connector}/record/{record_id}/signedUrl:
    get:
      tags:
        - Connector Service
      summary: "[Connector Service] Get signed URL for record"
      description: |
        ⚠️ <b>INTERNAL SERVICE ENDPOINT</b><br><br>

        Get a signed URL for direct file access from the connector source.<br><br>

        <b>Service:</b> Connector Service<br>
        <b>Port:</b> 8088<br>
        <b>Base URL:</b> <code>http://localhost:8088</code><br><br>

        <b>Authentication:</b> Requires scoped service token<br><br>

        <b>Use Case:</b> Generate temporary signed URLs for file downloads from
        Google Drive, OneDrive, SharePoint, etc.
      operationId: connectorGetSignedUrl
      servers:
        - url: http://localhost:8088
          description: Connector Service (Internal)
      security:
        - scopedToken: []
      parameters:
        - name: org_id
          in: path
          required: true
          schema:
            type: string
          description: Organization ID
        - name: user_id
          in: path
          required: true
          schema:
            type: string
          description: User ID
        - name: connector
          in: path
          required: true
          schema:
            type: string
          description: Connector name
        - name: record_id
          in: path
          required: true
          schema:
            type: string
          description: Record ID
      responses:
        '200':
          description: Signed URL generated
          content:
            application/json:
              schema:
                type: object
                properties:
                  signedUrl:
                    type: string
                    description: Temporary signed URL for file access
                  expiresAt:
                    type: integer
                    format: int64
                    description: URL expiration timestamp
        '404':
          description: Record not found
        '403':
          description: Access denied
      x-speakeasy-group: connectorService
      x-speakeasy-name-override: getSignedUrl
  # -------------------- DOCLING SERVICE (Port 8081) --------------------
  # Base URL: http://localhost:8081
  # Authentication: Internal only (called by Indexing Service)
  /docling/health:
    get:
      tags:
        - Docling Service
      summary: "[Docling Service] Health check"
      description: |
        ⚠️ <b>INTERNAL SERVICE ENDPOINT</b><br><br>

        Health check endpoint for the Docling Service (Python FastAPI).<br><br>

        <b>Service:</b> Docling Service<br>
        <b>Port:</b> 8081<br>
        <b>Base URL:</b> <code>http://localhost:8081</code><br><br>

        <b>Authentication:</b> None required for health check<br><br>

        <b>Note:</b> This is an internal service used by the Indexing Service
        for advanced document parsing. No user-facing endpoints.
      operationId: doclingServiceHealth
      security: []
      servers:
        - url: http://localhost:8081
          description: Docling Service (Internal)
      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    enum: [healthy]
                  service:
                    type: string
                    example: "docling"
        '503':
          description: Service is unhealthy or not initialized
      x-speakeasy-group: doclingService
      x-speakeasy-name-override: healthCheck
  /docling/process-pdf:
    post:
      tags:
        - Docling Service
      summary: "[Docling Service] Process PDF document"
      description: |
        ⚠️ <b>INTERNAL SERVICE ENDPOINT</b><br><br>

        Full PDF processing endpoint - parses PDF and creates content blocks.<br><br>

        <b>Service:</b> Docling Service<br>
        <b>Port:</b> 8081<br>
        <b>Base URL:</b> <code>http://localhost:8081</code><br><br>

        <b>Authentication:</b> Internal only - called by Indexing Service<br><br>

        <b>Processing Steps:</b>
        <ol>
        <li>Decode base64 PDF binary</li>
        <li>Parse document structure using Docling library</li>
        <li>Extract text, tables, and images</li>
        <li>Create content blocks for indexing</li>
        </ol>

        <b>Timeout:</b> 40 minutes (for large documents)
      operationId: doclingProcessPdf
      security: []
      servers:
        - url: http://localhost:8081
          description: Docling Service (Internal)
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                record_name:
                  type: string
                  description: Name/identifier of the document
                pdf_binary:
                  type: string
                  description: Base64 encoded PDF binary data
                org_id:
                  type: string
                  description: Organization ID (optional)
              required:
                - record_name
                - pdf_binary
      responses:
        '200':
          description: PDF processed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  block_containers:
                    type: object
                    description: Extracted content blocks
        '400':
          description: Invalid base64 PDF data
        '500':
          description: Processing failed or service not available
        '504':
          description: Processing timed out
      x-speakeasy-group: doclingService
      x-speakeasy-name-override: processPdf
  /docling/parse-pdf:
    post:
      tags:
        - Docling Service
      summary: "[Docling Service] Parse PDF (Phase 1)"
      description: |
        ⚠️ <b>INTERNAL SERVICE ENDPOINT</b><br><br>

        Phase 1 of two-phase PDF processing - parse PDF without block creation.<br><br>

        <b>Service:</b> Docling Service<br>
        <b>Port:</b> 8081<br>
        <b>Base URL:</b> <code>http://localhost:8081</code><br><br>

        <b>Authentication:</b> Internal only - called by Indexing Service<br><br>

        <b>Note:</b> This endpoint only parses the PDF structure without making
        LLM calls for table processing. Use <code>/create-blocks</code> for Phase 2.
      operationId: doclingParsePdf
      security: []
      servers:
        - url: http://localhost:8081
          description: Docling Service (Internal)
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                record_name:
                  type: string
                  description: Name/identifier of the document
                pdf_binary:
                  type: string
                  description: Base64 encoded PDF binary data
              required:
                - record_name
                - pdf_binary
      responses:
        '200':
          description: PDF parsed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  parse_result:
                    type: string
                    description: JSON-encoded DoclingDocument
        '400':
          description: Invalid base64 PDF data
        '500':
          description: Parsing failed
      x-speakeasy-group: doclingService
      x-speakeasy-name-override: parsePdf
  /docling/create-blocks:
    post:
      tags:
        - Docling Service
      summary: "[Docling Service] Create blocks from parse result (Phase 2)"
      description: |
        ⚠️ <b>INTERNAL SERVICE ENDPOINT</b><br><br>

        Phase 2 of two-phase PDF processing - create blocks from parse result.<br><br>

        <b>Service:</b> Docling Service<br>
        <b>Port:</b> 8081<br>
        <b>Base URL:</b> <code>http://localhost:8081</code><br><br>

        <b>Authentication:</b> Internal only - called by Indexing Service<br><br>

        <b>Note:</b> This endpoint creates content blocks from a previously parsed
        PDF document. It may involve LLM calls for table processing.
      operationId: doclingCreateBlocks
      security: []
      servers:
        - url: http://localhost:8081
          description: Docling Service (Internal)
      requestBody:
        required: true
        description: "Request payload"
        content:
          application/json:
            schema:
              type: object
              properties:
                parse_result:
                  type: string
                  description: JSON-encoded DoclingDocument from /parse-pdf
                page_number:
                  type: integer
                  description: Optional - process specific page only
              required:
                - parse_result
      responses:
        '200':
          description: Blocks created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  block_containers:
                    type: object
                    description: Extracted content blocks
        '400':
          description: Invalid parse_result data
        '500':
          description: Block creation failed
      x-speakeasy-group: doclingService
      x-speakeasy-name-override: createBlocks
