/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import * as z from "zod/v4-mini";
import { safeParse } from "../lib/schemas.js";
import * as openEnums from "../types/enums.js";
import { OpenEnum } from "../types/enums.js";
import { Result as SafeParseResult } from "../types/fp.js";
import * as types from "../types/primitives.js";
import {
  AuthProviders,
  AuthProviders$inboundSchema,
} from "./auth-providers.js";
import { SDKValidationError } from "./errors/sdk-validation-error.js";

export const InitAuthResponseAllowedMethod = {
  SamlSso: "samlSso",
  Otp: "otp",
  Password: "password",
  Google: "google",
  Microsoft: "microsoft",
  AzureAd: "azureAd",
  Oauth: "oauth",
} as const;
export type InitAuthResponseAllowedMethod = OpenEnum<
  typeof InitAuthResponseAllowedMethod
>;

/**
 * Response containing available authentication methods and session info
 */
export type InitAuthResponse = {
  /**
   * Current authentication step (0-indexed). Always 0 for initial response.
   */
  currentStep?: number | undefined;
  /**
   * List of allowed authentication methods for the current step
   */
  allowedMethods?: Array<InitAuthResponseAllowedMethod> | undefined;
  /**
   * Response message
   */
  message?: string | undefined;
  /**
   * Configuration for external authentication providers (returned when those methods are allowed)
   */
  authProviders?: AuthProviders | undefined;
};

/** @internal */
export const InitAuthResponseAllowedMethod$inboundSchema: z.ZodMiniType<
  InitAuthResponseAllowedMethod,
  unknown
> = openEnums.inboundSchema(InitAuthResponseAllowedMethod);

/** @internal */
export const InitAuthResponse$inboundSchema: z.ZodMiniType<
  InitAuthResponse,
  unknown
> = z.object({
  currentStep: types.optional(types.number()),
  allowedMethods: types.optional(
    z.array(InitAuthResponseAllowedMethod$inboundSchema),
  ),
  message: types.optional(types.string()),
  authProviders: types.optional(AuthProviders$inboundSchema),
});

export function initAuthResponseFromJSON(
  jsonString: string,
): SafeParseResult<InitAuthResponse, SDKValidationError> {
  return safeParse(
    jsonString,
    (x) => InitAuthResponse$inboundSchema.parse(JSON.parse(x)),
    `Failed to parse 'InitAuthResponse' from JSON`,
  );
}
