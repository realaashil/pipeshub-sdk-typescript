/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import * as z from "zod/v4-mini";
import { safeParse } from "../lib/schemas.js";
import { Result as SafeParseResult } from "../types/fp.js";
import * as types from "../types/primitives.js";
import { SDKValidationError } from "./errors/sdk-validation-error.js";

/**
 * JSON Web Key (RFC 7517).
 *
 * @remarks
 * Public key for verifying JWT signatures.
 */
export type Jwk = {
  /**
   * Key type
   */
  kty?: string | undefined;
  /**
   * Key use (sig = signature)
   */
  use?: string | undefined;
  /**
   * Algorithm
   */
  alg?: string | undefined;
  /**
   * Key ID
   */
  kid?: string | undefined;
  /**
   * RSA modulus (base64url encoded)
   */
  n?: string | undefined;
  /**
   * RSA exponent (base64url encoded)
   */
  e?: string | undefined;
};

/** @internal */
export const Jwk$inboundSchema: z.ZodMiniType<Jwk, unknown> = z.object({
  kty: types.optional(types.string()),
  use: types.optional(types.string()),
  alg: types.optional(types.string()),
  kid: types.optional(types.string()),
  n: types.optional(types.string()),
  e: types.optional(types.string()),
});

export function jwkFromJSON(
  jsonString: string,
): SafeParseResult<Jwk, SDKValidationError> {
  return safeParse(
    jsonString,
    (x) => Jwk$inboundSchema.parse(JSON.parse(x)),
    `Failed to parse 'Jwk' from JSON`,
  );
}
