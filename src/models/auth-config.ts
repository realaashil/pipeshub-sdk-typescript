/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import * as z from "zod/v4-mini";
import { safeParse } from "../lib/schemas.js";
import { Result as SafeParseResult } from "../types/fp.js";
import {
  AuthStep,
  AuthStep$inboundSchema,
  AuthStep$Outbound,
  AuthStep$outboundSchema,
} from "./auth-step.js";
import { SDKValidationError } from "./errors/sdk-validation-error.js";

/**
 * Organization authentication configuration. Supports 1-3 authentication steps for multi-factor authentication.
 *
 * @remarks
 * **Validation Rules:**
 * - Minimum 1 step, maximum 3 steps
 * - Each step must have unique order
 * - No duplicate methods within the same step
 * - No method can appear in multiple steps
 */
export type AuthConfig = {
  /**
   * List of authentication steps in order
   */
  authMethods: Array<AuthStep>;
};

/** @internal */
export const AuthConfig$inboundSchema: z.ZodMiniType<AuthConfig, unknown> = z
  .object({
    authMethods: z.array(AuthStep$inboundSchema),
  });
/** @internal */
export type AuthConfig$Outbound = {
  authMethods: Array<AuthStep$Outbound>;
};

/** @internal */
export const AuthConfig$outboundSchema: z.ZodMiniType<
  AuthConfig$Outbound,
  AuthConfig
> = z.object({
  authMethods: z.array(AuthStep$outboundSchema),
});

export function authConfigToJSON(authConfig: AuthConfig): string {
  return JSON.stringify(AuthConfig$outboundSchema.parse(authConfig));
}
export function authConfigFromJSON(
  jsonString: string,
): SafeParseResult<AuthConfig, SDKValidationError> {
  return safeParse(
    jsonString,
    (x) => AuthConfig$inboundSchema.parse(JSON.parse(x)),
    `Failed to parse 'AuthConfig' from JSON`,
  );
}
