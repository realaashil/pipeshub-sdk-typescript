/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import * as z from "zod/v4-mini";
import { ClosedEnum } from "../types/enums.js";

export const CreateOAuthAppRequestAllowedGrantType = {
  AuthorizationCode: "authorization_code",
  ClientCredentials: "client_credentials",
  RefreshToken: "refresh_token",
} as const;
export type CreateOAuthAppRequestAllowedGrantType = ClosedEnum<
  typeof CreateOAuthAppRequestAllowedGrantType
>;

/**
 * Request to create a new OAuth app
 */
export type CreateOAuthAppRequest = {
  /**
   * App name (displayed to users during authorization)
   */
  name: string;
  /**
   * App description
   */
  description?: string | undefined;
  /**
   * Allowed redirect URIs (1-10 URIs)
   */
  redirectUris: Array<string>;
  /**
   * Allowed grant types. Defaults to all if not specified.
   *
   * @remarks
   */
  allowedGrantTypes?: Array<CreateOAuthAppRequestAllowedGrantType> | undefined;
  /**
   * Scopes the app can request
   */
  allowedScopes: Array<string>;
  /**
   * App homepage URL (shown during authorization)
   */
  homepageUrl?: string | undefined;
  /**
   * Privacy policy URL
   */
  privacyPolicyUrl?: string | undefined;
  /**
   * Terms of service URL
   */
  termsOfServiceUrl?: string | undefined;
  /**
   * Whether the app can securely store secrets.
   *
   * @remarks
   * - `true`: Server-side app (secret required for token requests)
   * - `false`: Browser/mobile app (must use PKCE)
   */
  isConfidential?: boolean | undefined;
  /**
   * Access token lifetime in seconds (300-86400)
   */
  accessTokenLifetime?: number | undefined;
  /**
   * Refresh token lifetime in seconds (3600-31536000)
   */
  refreshTokenLifetime?: number | undefined;
};

/** @internal */
export const CreateOAuthAppRequestAllowedGrantType$outboundSchema:
  z.ZodMiniEnum<typeof CreateOAuthAppRequestAllowedGrantType> = z.enum(
    CreateOAuthAppRequestAllowedGrantType,
  );

/** @internal */
export type CreateOAuthAppRequest$Outbound = {
  name: string;
  description?: string | undefined;
  redirectUris: Array<string>;
  allowedGrantTypes?: Array<string> | undefined;
  allowedScopes: Array<string>;
  homepageUrl?: string | undefined;
  privacyPolicyUrl?: string | undefined;
  termsOfServiceUrl?: string | undefined;
  isConfidential: boolean;
  accessTokenLifetime: number;
  refreshTokenLifetime: number;
};

/** @internal */
export const CreateOAuthAppRequest$outboundSchema: z.ZodMiniType<
  CreateOAuthAppRequest$Outbound,
  CreateOAuthAppRequest
> = z.object({
  name: z.string(),
  description: z.optional(z.string()),
  redirectUris: z.array(z.string()),
  allowedGrantTypes: z.optional(
    z.array(CreateOAuthAppRequestAllowedGrantType$outboundSchema),
  ),
  allowedScopes: z.array(z.string()),
  homepageUrl: z.optional(z.string()),
  privacyPolicyUrl: z.optional(z.string()),
  termsOfServiceUrl: z.optional(z.string()),
  isConfidential: z._default(z.boolean(), true),
  accessTokenLifetime: z._default(z.int(), 3600),
  refreshTokenLifetime: z._default(z.int(), 604800),
});

export function createOAuthAppRequestToJSON(
  createOAuthAppRequest: CreateOAuthAppRequest,
): string {
  return JSON.stringify(
    CreateOAuthAppRequest$outboundSchema.parse(createOAuthAppRequest),
  );
}
