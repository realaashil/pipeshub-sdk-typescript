/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import * as z from "zod/v4-mini";
import { remap as remap$ } from "../lib/primitives.js";
import { ClosedEnum } from "../types/enums.js";
import { smartUnion } from "../types/smart-union.js";
import {
  OAuthCredentials,
  OAuthCredentials$Outbound,
  OAuthCredentials$outboundSchema,
} from "./o-auth-credentials.js";
import {
  OtpCredentials,
  OtpCredentials$Outbound,
  OtpCredentials$outboundSchema,
} from "./otp-credentials.js";
import {
  PasswordCredentials,
  PasswordCredentials$Outbound,
  PasswordCredentials$outboundSchema,
} from "./password-credentials.js";

/**
 * Authentication method to use
 */
export const Method = {
  SamlSso: "samlSso",
  Otp: "otp",
  Password: "password",
  Google: "google",
  Microsoft: "microsoft",
  AzureAd: "azureAd",
  Oauth: "oauth",
} as const;
/**
 * Authentication method to use
 */
export type Method = ClosedEnum<typeof Method>;

/**
 * Credentials based on the authentication method
 */
export type Credentials =
  | PasswordCredentials
  | OtpCredentials
  | OAuthCredentials
  | string;

/**
 * Request to authenticate using specified method.
 *
 * @remarks
 * **Credential format varies by method:**
 * - `password`: `{ password: "string" }`
 * - `otp`: `{ otp: "123456" }` (6-digit code)
 * - `google`: `"google-id-token-string"`
 * - `microsoft`: `{ accessToken: "...", idToken: "..." }`
 * - `azureAd`: `{ accessToken: "...", idToken: "..." }`
 * - `oauth`: `{ accessToken: "...", idToken: "..." }`
 * - `samlSso`: handled via redirect flow
 */
export type AuthenticateRequest = {
  /**
   * Authentication method to use
   */
  method: Method;
  /**
   * Credentials based on the authentication method
   */
  credentials: PasswordCredentials | OtpCredentials | OAuthCredentials | string;
  /**
   * Optional email for verification (used with some OAuth methods)
   */
  email?: string | undefined;
  /**
   * Cloudflare Turnstile CAPTCHA token (optional, if CAPTCHA is enabled)
   */
  cfTurnstileResponse?: string | undefined;
};

/** @internal */
export const Method$outboundSchema: z.ZodMiniEnum<typeof Method> = z.enum(
  Method,
);

/** @internal */
export type Credentials$Outbound =
  | PasswordCredentials$Outbound
  | OtpCredentials$Outbound
  | OAuthCredentials$Outbound
  | string;

/** @internal */
export const Credentials$outboundSchema: z.ZodMiniType<
  Credentials$Outbound,
  Credentials
> = smartUnion([
  PasswordCredentials$outboundSchema,
  OtpCredentials$outboundSchema,
  OAuthCredentials$outboundSchema,
  z.string(),
]);

export function credentialsToJSON(credentials: Credentials): string {
  return JSON.stringify(Credentials$outboundSchema.parse(credentials));
}

/** @internal */
export type AuthenticateRequest$Outbound = {
  method: string;
  credentials:
    | PasswordCredentials$Outbound
    | OtpCredentials$Outbound
    | OAuthCredentials$Outbound
    | string;
  email?: string | undefined;
  "cf-turnstile-response"?: string | undefined;
};

/** @internal */
export const AuthenticateRequest$outboundSchema: z.ZodMiniType<
  AuthenticateRequest$Outbound,
  AuthenticateRequest
> = z.pipe(
  z.object({
    method: Method$outboundSchema,
    credentials: smartUnion([
      PasswordCredentials$outboundSchema,
      OtpCredentials$outboundSchema,
      OAuthCredentials$outboundSchema,
      z.string(),
    ]),
    email: z.optional(z.string()),
    cfTurnstileResponse: z.optional(z.string()),
  }),
  z.transform((v) => {
    return remap$(v, {
      cfTurnstileResponse: "cf-turnstile-response",
    });
  }),
);

export function authenticateRequestToJSON(
  authenticateRequest: AuthenticateRequest,
): string {
  return JSON.stringify(
    AuthenticateRequest$outboundSchema.parse(authenticateRequest),
  );
}
