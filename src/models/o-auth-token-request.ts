/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import * as z from "zod/v4-mini";
import { remap as remap$ } from "../lib/primitives.js";
import { ClosedEnum } from "../types/enums.js";

/**
 * OAuth grant type:
 *
 * @remarks
 * - `authorization_code`: Exchange auth code for tokens
 * - `client_credentials`: Machine-to-machine auth
 * - `refresh_token`: Get new access token using refresh token
 */
export const GrantType = {
  AuthorizationCode: "authorization_code",
  ClientCredentials: "client_credentials",
  RefreshToken: "refresh_token",
} as const;
/**
 * OAuth grant type:
 *
 * @remarks
 * - `authorization_code`: Exchange auth code for tokens
 * - `client_credentials`: Machine-to-machine auth
 * - `refresh_token`: Get new access token using refresh token
 */
export type GrantType = ClosedEnum<typeof GrantType>;

/**
 * OAuth 2.0 Token Request (RFC 6749 Section 4.1.3).
 *
 * @remarks
 * Request body for exchanging authorization code or credentials for tokens.
 */
export type OAuthTokenRequest = {
  /**
   * OAuth grant type:
   *
   * @remarks
   * - `authorization_code`: Exchange auth code for tokens
   * - `client_credentials`: Machine-to-machine auth
   * - `refresh_token`: Get new access token using refresh token
   */
  grantType: GrantType;
  /**
   * Authorization code (required for authorization_code grant)
   */
  code?: string | undefined;
  /**
   * Redirect URI (required for authorization_code grant)
   */
  redirectUri?: string | undefined;
  /**
   * Client ID (can also be sent via Basic auth header)
   */
  clientId?: string | undefined;
  /**
   * Client secret (can also be sent via Basic auth header)
   */
  clientSecret?: string | undefined;
  /**
   * Refresh token (required for refresh_token grant)
   */
  refreshToken?: string | undefined;
  /**
   * Requested scopes (optional, defaults to original grant scopes)
   */
  scope?: string | undefined;
  /**
   * PKCE code verifier (RFC 7636). Required if code_challenge was used.
   *
   * @remarks
   * Must be 43-128 characters from [A-Za-z0-9-._~]
   */
  codeVerifier?: string | undefined;
};

/** @internal */
export const GrantType$outboundSchema: z.ZodMiniEnum<typeof GrantType> = z.enum(
  GrantType,
);

/** @internal */
export type OAuthTokenRequest$Outbound = {
  grant_type: string;
  code?: string | undefined;
  redirect_uri?: string | undefined;
  client_id?: string | undefined;
  client_secret?: string | undefined;
  refresh_token?: string | undefined;
  scope?: string | undefined;
  code_verifier?: string | undefined;
};

/** @internal */
export const OAuthTokenRequest$outboundSchema: z.ZodMiniType<
  OAuthTokenRequest$Outbound,
  OAuthTokenRequest
> = z.pipe(
  z.object({
    grantType: GrantType$outboundSchema,
    code: z.optional(z.string()),
    redirectUri: z.optional(z.string()),
    clientId: z.optional(z.string()),
    clientSecret: z.optional(z.string()),
    refreshToken: z.optional(z.string()),
    scope: z.optional(z.string()),
    codeVerifier: z.optional(z.string()),
  }),
  z.transform((v) => {
    return remap$(v, {
      grantType: "grant_type",
      redirectUri: "redirect_uri",
      clientId: "client_id",
      clientSecret: "client_secret",
      refreshToken: "refresh_token",
      codeVerifier: "code_verifier",
    });
  }),
);

export function oAuthTokenRequestToJSON(
  oAuthTokenRequest: OAuthTokenRequest,
): string {
  return JSON.stringify(
    OAuthTokenRequest$outboundSchema.parse(oAuthTokenRequest),
  );
}
