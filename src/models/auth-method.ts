/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import * as z from "zod/v4-mini";
import { safeParse } from "../lib/schemas.js";
import * as openEnums from "../types/enums.js";
import { OpenEnum } from "../types/enums.js";
import { Result as SafeParseResult } from "../types/fp.js";
import { SDKValidationError } from "./errors/sdk-validation-error.js";

/**
 * Type of authentication method:
 *
 * @remarks
 * - `password`: Email/password authentication
 * - `otp`: One-time password via email (6-digit, expires in 10 minutes)
 * - `google`: Google OAuth 2.0
 * - `microsoft`: Microsoft OAuth 2.0
 * - `azureAd`: Azure Active Directory
 * - `samlSso`: SAML 2.0 Single Sign-On
 * - `oauth`: Generic OAuth 2.0 provider
 */
export const AuthMethodType = {
  SamlSso: "samlSso",
  Otp: "otp",
  Password: "password",
  Google: "google",
  Microsoft: "microsoft",
  AzureAd: "azureAd",
  Oauth: "oauth",
} as const;
/**
 * Type of authentication method:
 *
 * @remarks
 * - `password`: Email/password authentication
 * - `otp`: One-time password via email (6-digit, expires in 10 minutes)
 * - `google`: Google OAuth 2.0
 * - `microsoft`: Microsoft OAuth 2.0
 * - `azureAd`: Azure Active Directory
 * - `samlSso`: SAML 2.0 Single Sign-On
 * - `oauth`: Generic OAuth 2.0 provider
 */
export type AuthMethodType = OpenEnum<typeof AuthMethodType>;

/**
 * Authentication method configuration
 */
export type AuthMethod = {
  /**
   * Type of authentication method:
   *
   * @remarks
   * - `password`: Email/password authentication
   * - `otp`: One-time password via email (6-digit, expires in 10 minutes)
   * - `google`: Google OAuth 2.0
   * - `microsoft`: Microsoft OAuth 2.0
   * - `azureAd`: Azure Active Directory
   * - `samlSso`: SAML 2.0 Single Sign-On
   * - `oauth`: Generic OAuth 2.0 provider
   */
  type: AuthMethodType;
};

/** @internal */
export const AuthMethodType$inboundSchema: z.ZodMiniType<
  AuthMethodType,
  unknown
> = openEnums.inboundSchema(AuthMethodType);
/** @internal */
export const AuthMethodType$outboundSchema: z.ZodMiniType<
  string,
  AuthMethodType
> = openEnums.outboundSchema(AuthMethodType);

/** @internal */
export const AuthMethod$inboundSchema: z.ZodMiniType<AuthMethod, unknown> = z
  .object({
    type: AuthMethodType$inboundSchema,
  });
/** @internal */
export type AuthMethod$Outbound = {
  type: string;
};

/** @internal */
export const AuthMethod$outboundSchema: z.ZodMiniType<
  AuthMethod$Outbound,
  AuthMethod
> = z.object({
  type: AuthMethodType$outboundSchema,
});

export function authMethodToJSON(authMethod: AuthMethod): string {
  return JSON.stringify(AuthMethod$outboundSchema.parse(authMethod));
}
export function authMethodFromJSON(
  jsonString: string,
): SafeParseResult<AuthMethod, SDKValidationError> {
  return safeParse(
    jsonString,
    (x) => AuthMethod$inboundSchema.parse(JSON.parse(x)),
    `Failed to parse 'AuthMethod' from JSON`,
  );
}
