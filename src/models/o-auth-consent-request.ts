/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import * as z from "zod/v4-mini";
import { remap as remap$ } from "../lib/primitives.js";
import { ClosedEnum } from "../types/enums.js";

/**
 * User's consent decision
 */
export const Consent = {
  Granted: "granted",
  Denied: "denied",
} as const;
/**
 * User's consent decision
 */
export type Consent = ClosedEnum<typeof Consent>;

/**
 * PKCE challenge method
 */
export const CodeChallengeMethod = {
  S256: "S256",
  Plain: "plain",
} as const;
/**
 * PKCE challenge method
 */
export type CodeChallengeMethod = ClosedEnum<typeof CodeChallengeMethod>;

/**
 * Request to submit user consent for OAuth authorization
 */
export type OAuthConsentRequest = {
  /**
   * The OAuth app's client ID
   */
  clientId: string;
  /**
   * Redirect URI (must match authorization request)
   */
  redirectUri: string;
  /**
   * Requested scopes
   */
  scope: string;
  /**
   * State parameter from authorization request
   */
  state: string;
  /**
   * User's consent decision
   */
  consent: Consent;
  /**
   * PKCE code challenge (if used in authorization request)
   */
  codeChallenge?: string | undefined;
  /**
   * PKCE challenge method
   */
  codeChallengeMethod?: CodeChallengeMethod | undefined;
};

/** @internal */
export const Consent$outboundSchema: z.ZodMiniEnum<typeof Consent> = z.enum(
  Consent,
);

/** @internal */
export const CodeChallengeMethod$outboundSchema: z.ZodMiniEnum<
  typeof CodeChallengeMethod
> = z.enum(CodeChallengeMethod);

/** @internal */
export type OAuthConsentRequest$Outbound = {
  client_id: string;
  redirect_uri: string;
  scope: string;
  state: string;
  consent: string;
  code_challenge?: string | undefined;
  code_challenge_method?: string | undefined;
};

/** @internal */
export const OAuthConsentRequest$outboundSchema: z.ZodMiniType<
  OAuthConsentRequest$Outbound,
  OAuthConsentRequest
> = z.pipe(
  z.object({
    clientId: z.string(),
    redirectUri: z.string(),
    scope: z.string(),
    state: z.string(),
    consent: Consent$outboundSchema,
    codeChallenge: z.optional(z.string()),
    codeChallengeMethod: z.optional(CodeChallengeMethod$outboundSchema),
  }),
  z.transform((v) => {
    return remap$(v, {
      clientId: "client_id",
      redirectUri: "redirect_uri",
      codeChallenge: "code_challenge",
      codeChallengeMethod: "code_challenge_method",
    });
  }),
);

export function oAuthConsentRequestToJSON(
  oAuthConsentRequest: OAuthConsentRequest,
): string {
  return JSON.stringify(
    OAuthConsentRequest$outboundSchema.parse(oAuthConsentRequest),
  );
}
