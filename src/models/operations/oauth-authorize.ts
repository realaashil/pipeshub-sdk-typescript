/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import * as z from "zod/v4-mini";
import { remap as remap$ } from "../../lib/primitives.js";
import { safeParse } from "../../lib/schemas.js";
import { ClosedEnum } from "../../types/enums.js";
import { Result as SafeParseResult } from "../../types/fp.js";
import { SDKValidationError } from "../errors/sdk-validation-error.js";

/**
 * Must be "code" for authorization code grant
 */
export const ResponseType = {
  Code: "code",
} as const;
/**
 * Must be "code" for authorization code grant
 */
export type ResponseType = ClosedEnum<typeof ResponseType>;

/**
 * PKCE method (S256 recommended)
 */
export const CodeChallengeMethod = {
  S256: "S256",
  Plain: "plain",
} as const;
/**
 * PKCE method (S256 recommended)
 */
export type CodeChallengeMethod = ClosedEnum<typeof CodeChallengeMethod>;

export type OauthAuthorizeRequest = {
  /**
   * Must be "code" for authorization code grant
   */
  responseType: ResponseType;
  /**
   * OAuth app client ID
   */
  clientId: string;
  /**
   * Callback URI (must match registered URI)
   */
  redirectUri: string;
  /**
   * Space-separated list of requested scopes
   */
  scope: string;
  /**
   * Random string for CSRF protection
   */
  state: string;
  /**
   * PKCE code challenge (base64url-encoded)
   */
  codeChallenge?: string | undefined;
  /**
   * PKCE method (S256 recommended)
   */
  codeChallengeMethod?: CodeChallengeMethod | undefined;
  /**
   * Nonce for ID token binding
   */
  nonce?: string | undefined;
};

export type OauthAuthorizeResponse = {
  headers: { [k: string]: Array<string> };
};

/** @internal */
export const ResponseType$outboundSchema: z.ZodMiniEnum<typeof ResponseType> = z
  .enum(ResponseType);

/** @internal */
export const CodeChallengeMethod$outboundSchema: z.ZodMiniEnum<
  typeof CodeChallengeMethod
> = z.enum(CodeChallengeMethod);

/** @internal */
export type OauthAuthorizeRequest$Outbound = {
  response_type: string;
  client_id: string;
  redirect_uri: string;
  scope: string;
  state: string;
  code_challenge?: string | undefined;
  code_challenge_method?: string | undefined;
  nonce?: string | undefined;
};

/** @internal */
export const OauthAuthorizeRequest$outboundSchema: z.ZodMiniType<
  OauthAuthorizeRequest$Outbound,
  OauthAuthorizeRequest
> = z.pipe(
  z.object({
    responseType: ResponseType$outboundSchema,
    clientId: z.string(),
    redirectUri: z.string(),
    scope: z.string(),
    state: z.string(),
    codeChallenge: z.optional(z.string()),
    codeChallengeMethod: z.optional(CodeChallengeMethod$outboundSchema),
    nonce: z.optional(z.string()),
  }),
  z.transform((v) => {
    return remap$(v, {
      responseType: "response_type",
      clientId: "client_id",
      redirectUri: "redirect_uri",
      codeChallenge: "code_challenge",
      codeChallengeMethod: "code_challenge_method",
    });
  }),
);

export function oauthAuthorizeRequestToJSON(
  oauthAuthorizeRequest: OauthAuthorizeRequest,
): string {
  return JSON.stringify(
    OauthAuthorizeRequest$outboundSchema.parse(oauthAuthorizeRequest),
  );
}

/** @internal */
export const OauthAuthorizeResponse$inboundSchema: z.ZodMiniType<
  OauthAuthorizeResponse,
  unknown
> = z.pipe(
  z.object({
    Headers: z._default(z.record(z.string(), z.array(z.string())), {}),
  }),
  z.transform((v) => {
    return remap$(v, {
      "Headers": "headers",
    });
  }),
);

export function oauthAuthorizeResponseFromJSON(
  jsonString: string,
): SafeParseResult<OauthAuthorizeResponse, SDKValidationError> {
  return safeParse(
    jsonString,
    (x) => OauthAuthorizeResponse$inboundSchema.parse(JSON.parse(x)),
    `Failed to parse 'OauthAuthorizeResponse' from JSON`,
  );
}
