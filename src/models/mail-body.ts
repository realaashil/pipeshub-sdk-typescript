/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import * as z from "zod/v4-mini";
import { ClosedEnum } from "../types/enums.js";
import { smartUnion } from "../types/smart-union.js";
import {
  AccountCreationTemplateData,
  AccountCreationTemplateData$Outbound,
  AccountCreationTemplateData$outboundSchema,
} from "./account-creation-template-data.js";
import {
  AppUserInviteTemplateData,
  AppUserInviteTemplateData$Outbound,
  AppUserInviteTemplateData$outboundSchema,
} from "./app-user-invite-template-data.js";
import {
  LoginWithOTPTemplateData,
  LoginWithOTPTemplateData$Outbound,
  LoginWithOTPTemplateData$outboundSchema,
} from "./login-with-otp-template-data.js";
import {
  ResetPasswordTemplateData,
  ResetPasswordTemplateData$Outbound,
  ResetPasswordTemplateData$outboundSchema,
} from "./reset-password-template-data.js";
import {
  SuspiciousLoginTemplateData,
  SuspiciousLoginTemplateData$Outbound,
  SuspiciousLoginTemplateData$outboundSchema,
} from "./suspicious-login-template-data.js";

/**
 * Type of email template to use. Each template has specific `templateData` requirements:
 *
 * @remarks
 * - `loginWithOTP`: OTP authentication email
 * - `resetPassword`: Password reset link email
 * - `accountCreation`: Welcome email for new organizations
 * - `appuserInvite`: Invitation email to join an organization
 * - `suspiciousLoginAttempt`: Security alert for multiple failed OTP attempts
 */
export const EmailTemplateType = {
  LoginWithOTP: "loginWithOTP",
  ResetPassword: "resetPassword",
  AccountCreation: "accountCreation",
  AppuserInvite: "appuserInvite",
  SuspiciousLoginAttempt: "suspiciousLoginAttempt",
} as const;
/**
 * Type of email template to use. Each template has specific `templateData` requirements:
 *
 * @remarks
 * - `loginWithOTP`: OTP authentication email
 * - `resetPassword`: Password reset link email
 * - `accountCreation`: Welcome email for new organizations
 * - `appuserInvite`: Invitation email to join an organization
 * - `suspiciousLoginAttempt`: Security alert for multiple failed OTP attempts
 */
export type EmailTemplateType = ClosedEnum<typeof EmailTemplateType>;

/**
 * Dynamic data to populate the email template. Required fields depend on <code>emailTemplateType</code>.<br><br>
 *
 * @remarks
 * <b>Template Data Requirements:</b><br>
 * <ul>
 * <li><b>loginWithOTP:</b> See <code>LoginWithOTPTemplateData</code> - requires <code>name</code>, <code>otp</code></li>
 * <li><b>resetPassword:</b> See <code>ResetPasswordTemplateData</code> - requires <code>name</code>, <code>link</code></li>
 * <li><b>accountCreation:</b> See <code>AccountCreationTemplateData</code> - requires <code>orgName</code>, <code>link</code></li>
 * <li><b>appuserInvite:</b> See <code>AppUserInviteTemplateData</code> - requires <code>invitee</code>, <code>orgName</code>, <code>link</code></li>
 * <li><b>suspiciousLoginAttempt:</b> See <code>SuspiciousLoginTemplateData</code> - requires <code>link</code></li>
 * </ul>
 */
export type TemplateData =
  | AppUserInviteTemplateData
  | LoginWithOTPTemplateData
  | ResetPasswordTemplateData
  | AccountCreationTemplateData
  | SuspiciousLoginTemplateData;

export type Attachment = {
  /**
   * Name of the attachment file
   */
  filename?: string | undefined;
  /**
   * Base64-encoded file content or raw string content
   */
  content?: string | undefined;
  /**
   * MIME type of the attachment
   */
  contentType?: string | undefined;
};

/**
 * Request body for sending transactional emails via pre-defined templates.
 *
 * @remarks
 *
 * **Template-specific templateData requirements:**
 *
 * | Template | Required Fields | Description |
 * |----------|----------------|-------------|
 * | `loginWithOTP` | `name`, `otp` | User's name and 6-digit OTP code |
 * | `resetPassword` | `name`, `link` | User's name and password reset URL |
 * | `accountCreation` | `orgName`, `link` | Organization name and login URL |
 * | `appuserInvite` | `invitee`, `orgName`, `link` | Inviter name, org name, and invitation URL |
 * | `suspiciousLoginAttempt` | `link` | Support contact URL |
 *
 * **Note:** The actual "From" address is taken from the SMTP configuration, not from `fromEmailDomain`.
 * The `fromEmailDomain` field is stored for audit purposes only.
 */
export type MailBody = {
  /**
   * Name of the product sending the email (used in templates for branding)
   */
  productName?: string | undefined;
  /**
   * Type of email template to use. Each template has specific `templateData` requirements:
   *
   * @remarks
   * - `loginWithOTP`: OTP authentication email
   * - `resetPassword`: Password reset link email
   * - `accountCreation`: Welcome email for new organizations
   * - `appuserInvite`: Invitation email to join an organization
   * - `suspiciousLoginAttempt`: Security alert for multiple failed OTP attempts
   */
  emailTemplateType: EmailTemplateType;
  /**
   * Flag indicating if this is an automated system email (for tracking/filtering purposes)
   */
  isAutoEmail?: boolean | undefined;
  /**
   * Sender email address for audit logging. **Note:** The actual "From" address used
   *
   * @remarks
   * in the email is taken from the SMTP server configuration (`smtpConfig.fromEmail`),
   * not this field. This field is stored in the database for record-keeping.
   */
  fromEmailDomain?: string | undefined;
  /**
   * List of recipient email addresses (at least one required)
   */
  sendEmailTo: Array<string>;
  /**
   * Email subject line
   */
  subject?: string | undefined;
  /**
   * Dynamic data to populate the email template. Required fields depend on <code>emailTemplateType</code>.<br><br>
   *
   * @remarks
   * <b>Template Data Requirements:</b><br>
   * <ul>
   * <li><b>loginWithOTP:</b> See <code>LoginWithOTPTemplateData</code> - requires <code>name</code>, <code>otp</code></li>
   * <li><b>resetPassword:</b> See <code>ResetPasswordTemplateData</code> - requires <code>name</code>, <code>link</code></li>
   * <li><b>accountCreation:</b> See <code>AccountCreationTemplateData</code> - requires <code>orgName</code>, <code>link</code></li>
   * <li><b>appuserInvite:</b> See <code>AppUserInviteTemplateData</code> - requires <code>invitee</code>, <code>orgName</code>, <code>link</code></li>
   * <li><b>suspiciousLoginAttempt:</b> See <code>SuspiciousLoginTemplateData</code> - requires <code>link</code></li>
   * </ul>
   */
  templateData?:
    | AppUserInviteTemplateData
    | LoginWithOTPTemplateData
    | ResetPasswordTemplateData
    | AccountCreationTemplateData
    | SuspiciousLoginTemplateData
    | undefined;
  /**
   * Optional list of CC recipient email addresses
   */
  sendCcTo?: Array<string> | undefined;
  /**
   * Optional email attachments (uses nodemailer attachment format)
   */
  attachments?: Array<Attachment> | undefined;
};

/** @internal */
export const EmailTemplateType$outboundSchema: z.ZodMiniEnum<
  typeof EmailTemplateType
> = z.enum(EmailTemplateType);

/** @internal */
export type TemplateData$Outbound =
  | AppUserInviteTemplateData$Outbound
  | LoginWithOTPTemplateData$Outbound
  | ResetPasswordTemplateData$Outbound
  | AccountCreationTemplateData$Outbound
  | SuspiciousLoginTemplateData$Outbound;

/** @internal */
export const TemplateData$outboundSchema: z.ZodMiniType<
  TemplateData$Outbound,
  TemplateData
> = smartUnion([
  AppUserInviteTemplateData$outboundSchema,
  LoginWithOTPTemplateData$outboundSchema,
  ResetPasswordTemplateData$outboundSchema,
  AccountCreationTemplateData$outboundSchema,
  SuspiciousLoginTemplateData$outboundSchema,
]);

export function templateDataToJSON(templateData: TemplateData): string {
  return JSON.stringify(TemplateData$outboundSchema.parse(templateData));
}

/** @internal */
export type Attachment$Outbound = {
  filename?: string | undefined;
  content?: string | undefined;
  contentType?: string | undefined;
};

/** @internal */
export const Attachment$outboundSchema: z.ZodMiniType<
  Attachment$Outbound,
  Attachment
> = z.object({
  filename: z.optional(z.string()),
  content: z.optional(z.string()),
  contentType: z.optional(z.string()),
});

export function attachmentToJSON(attachment: Attachment): string {
  return JSON.stringify(Attachment$outboundSchema.parse(attachment));
}

/** @internal */
export type MailBody$Outbound = {
  productName?: string | undefined;
  emailTemplateType: string;
  isAutoEmail: boolean;
  fromEmailDomain?: string | undefined;
  sendEmailTo: Array<string>;
  subject?: string | undefined;
  templateData?:
    | AppUserInviteTemplateData$Outbound
    | LoginWithOTPTemplateData$Outbound
    | ResetPasswordTemplateData$Outbound
    | AccountCreationTemplateData$Outbound
    | SuspiciousLoginTemplateData$Outbound
    | undefined;
  sendCcTo?: Array<string> | undefined;
  attachments?: Array<Attachment$Outbound> | undefined;
};

/** @internal */
export const MailBody$outboundSchema: z.ZodMiniType<
  MailBody$Outbound,
  MailBody
> = z.object({
  productName: z.optional(z.string()),
  emailTemplateType: EmailTemplateType$outboundSchema,
  isAutoEmail: z._default(z.boolean(), false),
  fromEmailDomain: z.optional(z.string()),
  sendEmailTo: z.array(z.string()),
  subject: z.optional(z.string()),
  templateData: z.optional(
    smartUnion([
      AppUserInviteTemplateData$outboundSchema,
      LoginWithOTPTemplateData$outboundSchema,
      ResetPasswordTemplateData$outboundSchema,
      AccountCreationTemplateData$outboundSchema,
      SuspiciousLoginTemplateData$outboundSchema,
    ]),
  ),
  sendCcTo: z.optional(z.array(z.string())),
  attachments: z.optional(z.array(z.lazy(() => Attachment$outboundSchema))),
});

export function mailBodyToJSON(mailBody: MailBody): string {
  return JSON.stringify(MailBody$outboundSchema.parse(mailBody));
}
