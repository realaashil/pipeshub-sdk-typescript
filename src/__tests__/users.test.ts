/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import { expect, test } from "vitest";
import { Pipeshub } from "../index.js";
import { filesToByteArray, filesToStream, streamToByteArray } from "./files.js";
import { createTestHTTPClient } from "./test-client.js";

test("Users Get All Users", async () => {
  const testHttpClient = createTestHTTPClient("getAllUsers");

  const pipeshub = new Pipeshub({
    serverURL: process.env["TEST_SERVER_URL"] ?? "http://localhost:18080",
    httpClient: testHttpClient,
    security: {
      bearerAuth: "<YOUR_BEARER_TOKEN_HERE>",
    },
  });

  const result = await pipeshub.users.getAllUsers({});
  expect(result).toBeDefined();
  expect(result).toEqual([
    {
      orgId: "<value>",
      email: "Beaulah94@yahoo.com",
      hasLoggedIn: false,
      isDeleted: false,
    },
  ]);
});

test("Users Create User", async () => {
  const testHttpClient = createTestHTTPClient("createUser");

  const pipeshub = new Pipeshub({
    serverURL: process.env["TEST_SERVER_URL"] ?? "http://localhost:18080",
    httpClient: testHttpClient,
    security: {
      bearerAuth: "<YOUR_BEARER_TOKEN_HERE>",
    },
  });

  const result = await pipeshub.users.createUser({
    fullName: "John Smith",
    email: "john.smith@company.com",
    mobile: "+15551234567",
    designation: "Software Engineer",
  });
  expect(result).toBeDefined();
  expect(result).toEqual({
    success: true,
    message: "User created successfully",
  });
});

test("Users Get User By Id", async () => {
  const testHttpClient = createTestHTTPClient("getUserById");

  const pipeshub = new Pipeshub({
    serverURL: process.env["TEST_SERVER_URL"] ?? "http://localhost:18080",
    httpClient: testHttpClient,
    security: {
      bearerAuth: "<YOUR_BEARER_TOKEN_HERE>",
    },
  });

  const result = await pipeshub.users.getUserById({
    id: "507f1f77bcf86cd799439011",
  });
  expect(result).toBeDefined();
  expect(result).toEqual({
    orgId: "<value>",
    email: "Darby_Considine37@gmail.com",
    hasLoggedIn: false,
    isDeleted: false,
  });
});

test("Users Update User", async () => {
  const testHttpClient = createTestHTTPClient("updateUser");

  const pipeshub = new Pipeshub({
    serverURL: process.env["TEST_SERVER_URL"] ?? "http://localhost:18080",
    httpClient: testHttpClient,
    security: {
      bearerAuth: "<YOUR_BEARER_TOKEN_HERE>",
    },
  });

  const result = await pipeshub.users.updateUser({
    id: "507f1f77bcf86cd799439011",
    body: {
      fullName: "John Smith",
      firstName: "John",
      lastName: "Smith",
      email: "john.smith@company.com",
      mobile: "+15551234567",
      designation: "Senior Software Engineer",
    },
  });
  expect(result).toBeDefined();
  expect(result).toEqual({
    success: true,
    message: "User updated successfully",
  });
});

test("Users Delete User", async () => {
  const testHttpClient = createTestHTTPClient("deleteUser");

  const pipeshub = new Pipeshub({
    serverURL: process.env["TEST_SERVER_URL"] ?? "http://localhost:18080",
    httpClient: testHttpClient,
    security: {
      bearerAuth: "<YOUR_BEARER_TOKEN_HERE>",
    },
  });

  const result = await pipeshub.users.deleteUser({
    id: "507f1f77bcf86cd799439011",
  });
  expect(result).toBeDefined();
  expect(result).toEqual({
    success: true,
    message: "User deleted successfully",
  });
});

test("Users Get User Email By Id", async () => {
  const testHttpClient = createTestHTTPClient("getUserEmailById");

  const pipeshub = new Pipeshub({
    serverURL: process.env["TEST_SERVER_URL"] ?? "http://localhost:18080",
    httpClient: testHttpClient,
    security: {
      bearerAuth: "<YOUR_BEARER_TOKEN_HERE>",
    },
  });

  const result = await pipeshub.users.getUserEmailById({
    id: "507f1f77bcf86cd799439011",
  });
  expect(result).toBeDefined();
  expect(result).toEqual({
    success: true,
    email: "john.smith@company.com",
  });
});

test("Users Upload User Display Picture", async () => {
  const testHttpClient = createTestHTTPClient("uploadUserDisplayPicture");

  const pipeshub = new Pipeshub({
    serverURL: process.env["TEST_SERVER_URL"] ?? "http://localhost:18080",
    httpClient: testHttpClient,
    security: {
      bearerAuth: "<YOUR_BEARER_TOKEN_HERE>",
    },
  });

  const result = await pipeshub.users.uploadUserDisplayPicture({
    file: {
      fileName: "example.file",
      content: filesToStream(".speakeasy/testfiles/example.file"),
    },
  });
  expect(result).toBeDefined();
  expect(new Uint8Array(await streamToByteArray(result))).toEqual(
    await filesToByteArray(".speakeasy/testfiles/example.file"),
  );
});

test("Users Get User Display Picture", async () => {
  const testHttpClient = createTestHTTPClient("getUserDisplayPicture");

  const pipeshub = new Pipeshub({
    serverURL: process.env["TEST_SERVER_URL"] ?? "http://localhost:18080",
    httpClient: testHttpClient,
    security: {
      bearerAuth: "<YOUR_BEARER_TOKEN_HERE>",
    },
  });

  const result = await pipeshub.users.getUserDisplayPicture();
  expect(result).toBeDefined();
  expect(
    new Uint8Array(
      await streamToByteArray(result as ReadableStream<Uint8Array>),
    ),
  ).toEqual(await filesToByteArray(".speakeasy/testfiles/example.file"));
});

test("Users Remove User Display Picture", async () => {
  const testHttpClient = createTestHTTPClient("removeUserDisplayPicture");

  const pipeshub = new Pipeshub({
    serverURL: process.env["TEST_SERVER_URL"] ?? "http://localhost:18080",
    httpClient: testHttpClient,
    security: {
      bearerAuth: "<YOUR_BEARER_TOKEN_HERE>",
    },
  });

  const result = await pipeshub.users.removeUserDisplayPicture();
  expect(result).toBeDefined();
  expect(result).toEqual({
    success: true,
    message: "Display picture removed successfully",
  });
});

test("Users Bulk Invite Users", async () => {
  const testHttpClient = createTestHTTPClient("bulkInviteUsers");

  const pipeshub = new Pipeshub({
    serverURL: process.env["TEST_SERVER_URL"] ?? "http://localhost:18080",
    httpClient: testHttpClient,
    security: {
      bearerAuth: "<YOUR_BEARER_TOKEN_HERE>",
    },
  });

  const result = await pipeshub.users.bulkInviteUsers({
    emails: [
      "user1@company.com",
      "user2@company.com",
    ],
    groupIds: [
      "507f1f77bcf86cd799439011",
    ],
  });
  expect(result).toBeDefined();
  expect(result).toEqual({
    success: true,
    message: "Bulk invitation completed",
    invited: 8,
    skipped: 1,
    failed: 1,
  });
});

test("Users Resend User Invite", async () => {
  const testHttpClient = createTestHTTPClient("resendUserInvite");

  const pipeshub = new Pipeshub({
    serverURL: process.env["TEST_SERVER_URL"] ?? "http://localhost:18080",
    httpClient: testHttpClient,
    security: {
      bearerAuth: "<YOUR_BEARER_TOKEN_HERE>",
    },
  });

  const result = await pipeshub.users.resendUserInvite({
    id: "507f1f77bcf86cd799439011",
  });
  expect(result).toBeDefined();
  expect(result).toEqual({
    success: true,
    message: "Invitation resent successfully",
  });
});

test("Users List Users Graph", async () => {
  const testHttpClient = createTestHTTPClient("listUsersGraph");

  const pipeshub = new Pipeshub({
    serverURL: process.env["TEST_SERVER_URL"] ?? "http://localhost:18080",
    httpClient: testHttpClient,
    security: {
      bearerAuth: "<YOUR_BEARER_TOKEN_HERE>",
    },
  });

  const result = await pipeshub.users.listUsersGraph({
    search: "john",
  });
  expect(result).toBeDefined();
  expect(result).toEqual({
    success: true,
    pagination: {
      page: 1,
      limit: 10,
      total: 156,
      totalPages: 16,
    },
  });
});

test("Users Unblock User", async () => {
  const testHttpClient = createTestHTTPClient("unblockUser");

  const pipeshub = new Pipeshub({
    serverURL: process.env["TEST_SERVER_URL"] ?? "http://localhost:18080",
    httpClient: testHttpClient,
    security: {
      bearerAuth: "<YOUR_BEARER_TOKEN_HERE>",
    },
  });

  const result = await pipeshub.users.unblockUser({
    id: "507f1f77bcf86cd799439011",
  });
  expect(result).toBeDefined();
  expect(result).toEqual({
    message: "User unblocked successfully",
  });
});
