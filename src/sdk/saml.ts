/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import { samlCallback } from "../funcs/saml-callback.js";
import { samlSignIn } from "../funcs/saml-sign-in.js";
import { samlUpdateAppConfig } from "../funcs/saml-update-app-config.js";
import { ClientSDK, RequestOptions } from "../lib/sdks.js";
import * as operations from "../models/operations/index.js";
import { unwrapAsync } from "../types/fp.js";

export class Saml extends ClientSDK {
  /**
   * Initiate SAML sign-in flow
   *
   * @remarks
   * Initiate SAML Single Sign-On authentication by redirecting to the Identity Provider (IDP).
   * <br><br>
   * <b>Usage:</b><br>
   * 1. Call <code>/userAccount/initAuth</code> to get a session token<br>
   * 2. If <code>samlSso</code> is in the allowed methods, redirect the user to this endpoint<br>
   * 3. User authenticates with their IDP<br>
   * 4. IDP redirects back to <code>/saml/signIn/callback</code> with SAML response<br>
   * 5. Callback completes authentication and returns tokens
   * <br><br>
   * <b>Note:</b> This is a browser redirect endpoint, not a typical API call.
   * The user's browser should be redirected to this URL.
   * <br><br>
   * <b>Prerequisites:</b><br>
   * - Organization must have SAML SSO configured via <code>/saml/updateAppConfig</code><br>
   * - User must belong to an organization with SAML enabled
   */
  async signIn(
    request: operations.SignInViaSAMLRequest,
    options?: RequestOptions,
  ): Promise<operations.SignInViaSAMLResponse | undefined> {
    return unwrapAsync(samlSignIn(
      this,
      request,
      options,
    ));
  }

  /**
   * SAML authentication callback
   *
   * @remarks
   * Handle the callback from SAML Identity Provider after user authentication.
   * This endpoint processes the SAML response and completes the authentication flow.
   * <br><br>
   * <b>Note:</b> This endpoint is called by the IDP, not directly by the client.
   * The IDP posts the SAML response to this URL after user authentication.
   * <br><br>
   * <b>Flow:</b><br>
   * 1. IDP posts SAMLResponse and RelayState<br>
   * 2. Server validates SAML assertion signature<br>
   * 3. Server extracts user identity from assertion<br>
   * 4. Server completes the authentication step<br>
   * 5. Redirects to frontend with success/error status
   * <br><br>
   * <b>RelayState:</b> Contains the session token to resume the authentication flow.
   */
  async callback(
    request?: operations.SamlCallbackRequest | undefined,
    options?: RequestOptions,
  ): Promise<operations.SamlCallbackResponse | undefined> {
    return unwrapAsync(samlCallback(
      this,
      request,
      options,
    ));
  }

  /**
   * Reload SAML application configuration (Internal)
   *
   * @remarks
   * Internal endpoint to reload SAML configuration from the configuration manager.
   * This is called by other services when SAML settings are updated.<br><br>
   * <b>Purpose:</b><br>
   * When SAML configuration is updated in the Configuration Manager, this endpoint
   * is called to reload the settings into the authentication service without restart.<br><br>
   * <b>Effects:</b><br>
   * <ul>
   * <li>Reloads AppConfig from configuration files</li>
   * <li>Rebinds authentication controllers with new config</li>
   * <li>Updates SAML passport strategy settings</li>
   * </ul>
   * <b>Note:</b> This is an internal service-to-service endpoint.
   */
  async updateAppConfig(
    security: operations.UpdateSamlAppConfigSecurity,
    options?: RequestOptions,
  ): Promise<operations.UpdateSamlAppConfigResponse> {
    return unwrapAsync(samlUpdateAppConfig(
      this,
      security,
      options,
    ));
  }
}
