/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import { connectorOAuthGetOAuthAuthorizationUrl } from "../funcs/connector-o-auth-get-o-auth-authorization-url.js";
import { connectorOAuthHandleOAuthCallback } from "../funcs/connector-o-auth-handle-o-auth-callback.js";
import { ClientSDK, RequestOptions } from "../lib/sdks.js";
import * as operations from "../models/operations/index.js";
import { unwrapAsync } from "../types/fp.js";

export class ConnectorOAuth extends ClientSDK {
  /**
   * Get OAuth authorization URL
   *
   * @remarks
   * Generate an OAuth authorization URL to start the OAuth flow.<br><br>
   * <b>Flow:</b><br>
   * <ol>
   * <li>Call this endpoint to get the authorization URL</li>
   * <li>Redirect user's browser to the URL</li>
   * <li>User authenticates with the provider</li>
   * <li>Provider redirects to callback with authorization code</li>
   * <li>Callback exchanges code for tokens automatically</li>
   * </ol>
   * <b>State Parameter:</b><br>
   * The response includes a <code>state</code> value that encodes the
   * connector ID. This is validated in the callback.
   */
  async getOAuthAuthorizationUrl(
    request: operations.GetOAuthAuthorizationUrlRequest,
    options?: RequestOptions,
  ): Promise<operations.GetOAuthAuthorizationUrlResponse> {
    return unwrapAsync(connectorOAuthGetOAuthAuthorizationUrl(
      this,
      request,
      options,
    ));
  }

  /**
   * OAuth callback handler
   *
   * @remarks
   * Handle the OAuth callback from the identity provider.<br><br>
   * <b>Note:</b><br>
   * This endpoint is called by the OAuth provider after user authentication.
   * The state parameter contains the encoded connector ID.<br><br>
   * <b>Success:</b><br>
   * On success, tokens are stored and the connector becomes authenticated.
   * User is redirected to the frontend success page.<br><br>
   * <b>Error:</b><br>
   * If the provider returns an error (e.g., user denied access),
   * user is redirected with error information.
   */
  async handleOAuthCallback(
    request?: operations.HandleOAuthCallbackRequest | undefined,
    options?: RequestOptions,
  ): Promise<operations.HandleOAuthCallbackResponse | undefined> {
    return unwrapAsync(connectorOAuthHandleOAuthCallback(
      this,
      request,
      options,
    ));
  }
}
