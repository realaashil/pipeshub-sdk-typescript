/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import { oAuthAppsActivateOAuthApp } from "../funcs/o-auth-apps-activate-o-auth-app.js";
import { oAuthAppsCreateOAuthApp } from "../funcs/o-auth-apps-create-o-auth-app.js";
import { oAuthAppsDeleteOAuthApp } from "../funcs/o-auth-apps-delete-o-auth-app.js";
import { oAuthAppsGetOAuthApp } from "../funcs/o-auth-apps-get-o-auth-app.js";
import { oAuthAppsListOAuthAppTokens } from "../funcs/o-auth-apps-list-o-auth-app-tokens.js";
import { oAuthAppsListOAuthApps } from "../funcs/o-auth-apps-list-o-auth-apps.js";
import { oAuthAppsListOAuthScopes } from "../funcs/o-auth-apps-list-o-auth-scopes.js";
import { oAuthAppsRegenerateOAuthAppSecret } from "../funcs/o-auth-apps-regenerate-o-auth-app-secret.js";
import { oAuthAppsRevokeAllOAuthAppTokens } from "../funcs/o-auth-apps-revoke-all-o-auth-app-tokens.js";
import { oAuthAppsSuspendOAuthApp } from "../funcs/o-auth-apps-suspend-o-auth-app.js";
import { oAuthAppsUpdateOAuthApp } from "../funcs/o-auth-apps-update-o-auth-app.js";
import { ClientSDK, RequestOptions } from "../lib/sdks.js";
import * as models from "../models/index.js";
import * as operations from "../models/operations/index.js";
import { unwrapAsync } from "../types/fp.js";

export class OAuthApps extends ClientSDK {
  /**
   * List OAuth apps
   *
   * @remarks
   * List all OAuth apps registered for the organization.
   * <br><br>
   * Returns a paginated list of apps with their configuration (excluding secrets).
   * <br><br>
   * <b>Filters:</b><br>
   * - `status` - Filter by app status (active, suspended, revoked)<br>
   * - `search` - Search by app name
   */
  async listOAuthApps(
    request?: operations.ListOAuthAppsRequest | undefined,
    options?: RequestOptions,
  ): Promise<models.OAuthAppListResponse> {
    return unwrapAsync(oAuthAppsListOAuthApps(
      this,
      request,
      options,
    ));
  }

  /**
   * Create OAuth app
   *
   * @remarks
   * Create a new OAuth app for the organization.
   * <br><br>
   * <b>Important:</b> The client secret is only returned once during creation.
   * Store it securely - it cannot be retrieved later. If lost, you'll need to
   * regenerate it.
   * <br><br>
   * <b>Admin Only:</b> Requires admin privileges.
   * <br><br>
   * <b>Rate Limited:</b> 10 requests per minute.
   */
  async createOAuthApp(
    request: models.CreateOAuthAppRequest,
    options?: RequestOptions,
  ): Promise<models.OAuthAppWithSecret> {
    return unwrapAsync(oAuthAppsCreateOAuthApp(
      this,
      request,
      options,
    ));
  }

  /**
   * List available scopes
   *
   * @remarks
   * List all available OAuth scopes that can be requested by apps.
   * <br><br>
   * Returns scope names, descriptions, and categories for display
   * in app configuration UI.
   */
  async listOAuthScopes(
    options?: RequestOptions,
  ): Promise<operations.ListOAuthScopesResponse> {
    return unwrapAsync(oAuthAppsListOAuthScopes(
      this,
      options,
    ));
  }

  /**
   * Get OAuth app details
   *
   * @remarks
   * Get details of a specific OAuth app.
   * <br><br>
   * Returns app configuration without the client secret.
   */
  async getOAuthApp(
    request: operations.GetOAuthAppRequest,
    options?: RequestOptions,
  ): Promise<models.OAuthAppResponse> {
    return unwrapAsync(oAuthAppsGetOAuthApp(
      this,
      request,
      options,
    ));
  }

  /**
   * Update OAuth app
   *
   * @remarks
   * Update an OAuth app's configuration.
   * <br><br>
   * <b>Admin Only:</b> Requires admin privileges.
   * <br><br>
   * <b>Rate Limited:</b> 10 requests per minute.
   * <br><br>
   * <b>Note:</b> To regenerate the client secret, use the
   * `/oauth-clients/{appId}/regenerate-secret` endpoint.
   */
  async updateOAuthApp(
    request: operations.UpdateOAuthAppRequest,
    options?: RequestOptions,
  ): Promise<models.OAuthAppResponse> {
    return unwrapAsync(oAuthAppsUpdateOAuthApp(
      this,
      request,
      options,
    ));
  }

  /**
   * Delete OAuth app
   *
   * @remarks
   * Delete (soft delete) an OAuth app.
   * <br><br>
   * This marks the app as deleted and revokes all its tokens.
   * The app cannot be restored after deletion.
   * <br><br>
   * <b>Admin Only:</b> Requires admin privileges.
   * <br><br>
   * <b>Rate Limited:</b> 10 requests per minute.
   */
  async deleteOAuthApp(
    request: operations.DeleteOAuthAppRequest,
    options?: RequestOptions,
  ): Promise<operations.DeleteOAuthAppResponse> {
    return unwrapAsync(oAuthAppsDeleteOAuthApp(
      this,
      request,
      options,
    ));
  }

  /**
   * Regenerate client secret
   *
   * @remarks
   * Regenerate the client secret for an OAuth app.
   * <br><br>
   * The old secret is immediately invalidated. Any clients using the old
   * secret will fail to authenticate until updated with the new secret.
   * <br><br>
   * <b>Important:</b> The new secret is only returned once. Store it securely.
   * <br><br>
   * <b>Admin Only:</b> Requires admin privileges.
   * <br><br>
   * <b>Rate Limited:</b> 10 requests per minute.
   */
  async regenerateOAuthAppSecret(
    request: operations.RegenerateOAuthAppSecretRequest,
    options?: RequestOptions,
  ): Promise<models.OAuthAppWithSecret> {
    return unwrapAsync(oAuthAppsRegenerateOAuthAppSecret(
      this,
      request,
      options,
    ));
  }

  /**
   * Suspend OAuth app
   *
   * @remarks
   * Suspend an OAuth app, preventing it from authenticating or issuing tokens.
   * <br><br>
   * Existing tokens remain valid until they expire, but no new tokens can
   * be obtained. Use this for temporary access suspension.
   * <br><br>
   * <b>Admin Only:</b> Requires admin privileges.
   * <br><br>
   * <b>Rate Limited:</b> 10 requests per minute.
   */
  async suspendOAuthApp(
    request: operations.SuspendOAuthAppRequest,
    options?: RequestOptions,
  ): Promise<models.OAuthAppResponse> {
    return unwrapAsync(oAuthAppsSuspendOAuthApp(
      this,
      request,
      options,
    ));
  }

  /**
   * Activate suspended OAuth app
   *
   * @remarks
   * Reactivate a suspended OAuth app, allowing it to authenticate and issue tokens again.
   * <br><br>
   * <b>Admin Only:</b> Requires admin privileges.
   * <br><br>
   * <b>Rate Limited:</b> 10 requests per minute.
   */
  async activateOAuthApp(
    request: operations.ActivateOAuthAppRequest,
    options?: RequestOptions,
  ): Promise<models.OAuthAppResponse> {
    return unwrapAsync(oAuthAppsActivateOAuthApp(
      this,
      request,
      options,
    ));
  }

  /**
   * List app tokens
   *
   * @remarks
   * List all active tokens issued to an OAuth app.
   * <br><br>
   * Useful for monitoring app usage and identifying tokens to revoke.
   * <br><br>
   * <b>Admin Only:</b> Requires admin privileges.
   */
  async listOAuthAppTokens(
    request: operations.ListOAuthAppTokensRequest,
    options?: RequestOptions,
  ): Promise<Array<models.OAuthTokenListItem>> {
    return unwrapAsync(oAuthAppsListOAuthAppTokens(
      this,
      request,
      options,
    ));
  }

  /**
   * Revoke all app tokens
   *
   * @remarks
   * Revoke all tokens (access and refresh) issued to an OAuth app.
   * <br><br>
   * Use this for emergency access removal or when rotating credentials.
   * <br><br>
   * <b>Admin Only:</b> Requires admin privileges.
   * <br><br>
   * <b>Rate Limited:</b> 10 requests per minute.
   */
  async revokeAllOAuthAppTokens(
    request: operations.RevokeAllOAuthAppTokensRequest,
    options?: RequestOptions,
  ): Promise<operations.RevokeAllOAuthAppTokensResponse> {
    return unwrapAsync(oAuthAppsRevokeAllOAuthAppTokens(
      this,
      request,
      options,
    ));
  }
}
